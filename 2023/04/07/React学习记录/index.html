<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color" content="#3367D6"/>
  <link rel="apple-touch-icon" href="/icons-192.png">
  <link rel="manifest" href="/manifest.json">
  


  <meta name="generator" content="Hexo 6.3.0">

  
    <meta name="description" content="å¯¹äºå¯æ§çš„äº‹æƒ…ä¿æŒè°¨æ…ï¼›å¯¹äºä¸å¯æ§çš„äº‹æƒ…ä¿æŒä¹è§‚">
  

  

  
    <meta name="author" content="airlatus">
  

  

  

  <title>Reactï¼ˆæ—§ç‰ˆå†…å®¹ä¸ºä¸»ï¼‰ | airlatus</title>

  

  
    <link rel="shortcut icon" href="/favicon.ico">
  

  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@1.1.3/index.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlightjs@9.16.2/styles/monokai.css">
  

  
<link rel="stylesheet" href="/css/style.css">

</head>
<body>
  <div class="root-container">
    
<!-- header container -->
<header class="header-container post">
  
    <div class="post-image" style="background-image: url(https://qiniu.sukoshi.xyz/src/images/68686407_p0.jpg)"></div>
  

  <!-- navbar -->
<nav class="navbar">
  <div class="navbar-content">
    <!-- logo -->
    <div class="navbar-logo">
      <a href="/">
        
          airlatus
        
      </a>
    </div>
    <!-- link -->
    <div class="navbar-link">
      <div class="navbar-btn">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <ul class="navbar-list">
        
          <li class="navbar-list-item"><a href="/">é¦–é¡µ</a></li>
        
      </ul>
    </div>
  </div>
</nav>

  
  

  
  

  
  

  
  

  
  
    <div class="header-content">
      <div class="post-text layout-block">
        <div class="layout-margin">
          <h1 class="title-wrap">Reactï¼ˆæ—§ç‰ˆå†…å®¹ä¸ºä¸»ï¼‰</h1>
          <h2 class="title-sub-wrap">
            <strong>airlatus</strong>
            <span>å‘å¸ƒäº</span>
            <time  class="article-date" datetime="2023-04-07T08:07:24.226Z" itemprop="datePublished">2023-04-07</time>
          </h2>
          
            <h2 class="title-sub-wrap new-date">
              <span>æœ€åæ›´æ–°äº</span>
              <time  class="article-updated" datetime="2023-05-22T05:45:45.096Z" itemprop="dateUpdated">2023-05-22</time>
            </h2>
          
          
            <h2 id="/2023/04/07/React%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" class="title-sub-wrap leancloud_visitors" data-flag-title="Reactï¼ˆæ—§ç‰ˆå†…å®¹ä¸ºä¸»ï¼‰">
              <em>æ–‡ç« è®¿é—®é‡</em>
              <i class="leancloud-visitors-count"></i>
            </h2>
          
          <ul class="wrap-list dark">
  
    <li><a href="/categories/React/">ğŸ“’ React</a></li>
  
    <li><a href="/categories/React/React-Hooks/">ğŸ“’ React Hooks</a></li>
  
</ul>
          <ul class="wrap-list dark">
  
    <li><a href="/tags/React/">ğŸ·ï¸ React</a></li>
  
    <li><a href="/tags/React-Hooks/">ğŸ·ï¸ React Hooks</a></li>
  
</ul>
        </div>
      </div>
    </div>
  

  
  
  
</header>

    <!-- æ–‡ç«  -->

<!-- æ–‡ç« å†…å®¹ -->
<div class="body-container">
  <article class="content-container layout-block post-container">
    <div class="article-info">
      
      
      
      
      <section class="article-entry markdown-body layout-margin content-padding--large soft-size--large soft-style--box">
        <h1 id="React"><a href="#React" class="headerlink" title="React"></a>React</h1><h2 id="åˆæ­¥äº†è§£"><a href="#åˆæ­¥äº†è§£" class="headerlink" title="åˆæ­¥äº†è§£"></a>åˆæ­¥äº†è§£</h2><blockquote>
<p><code>React</code>æ˜¯ä¸€ä¸ª<code>JS</code>åº“ï¼Œ<code>Vue</code>æ˜¯ä¸€ä¸ª<code>JS</code>æ¡†æ¶ï¼Œ<code>React</code>ç›®çš„å’Œå®šä½æ˜¯é’ˆå¯¹ç•Œé¢çš„æ‰“é€ ï¼Œ<code>React</code>å¯¹ä»£ç çš„å°è£…ç¨‹åº¦è¾ƒä½ï¼Œ<code>JS</code>ä½¿ç”¨çµæ´»ï¼Œå¯¹<code>JS</code>ä¾µå…¥å°ï¼›<code>Vue</code>å¯¹<code>JS</code>ä¾µå…¥æ€§å¾ˆé«˜ï¼Œå°†å„ç§å¤„ç†æ–¹æ³•å°è£…æˆ<code>Vue</code>ç‰¹æœ‰çš„æ‰§è¡Œæ–¹å¼ï¼Œç”¨èµ·æ¥æ–¹ä¾¿ä½†æ˜¯é’ˆå¯¹çµæ´»çš„éœ€æ±‚æ—¶ä¼šæœ‰æ‰€æ‰è¥Ÿè§è‚˜ã€‚</p>
</blockquote>
<h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h3><p>ç›´æ¥åœ¨<code>index.html</code>é¡µé¢ä¸Šä½¿ç”¨<code>React</code>ï¼Œå¼•ç”¨ä¸‹é¢çš„<code>JS</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// Reactæ ¸å¿ƒåº“ï¼Œä¸å®¿ä¸»ç¯å¢ƒæ— å…³</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">crossorigin</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react@16/umd/react.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">// ä¾èµ–æ ¸å¿ƒåº“ï¼Œå°†æ ¸å¿ƒçš„åŠŸèƒ½ä¸é¡µé¢ç»“åˆï¼Œå¦‚æœæ˜¯æ‰‹æœºç«¯çš„RNå°±ä¸éœ€è¦è¿™ä¸ªäº†ï¼Œåªéœ€è¦æ ¸å¿ƒåº“å°±è¡Œ</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">crossorigin</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react-dom@16/umd/react-dom.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">// å¯¹JSXè¯­æ³•çš„è½¬è¯‘</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/babel-standalone@6/babel.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¸åŠ <code>crossorigin</code>ï¼Œè·¨åŸŸæˆ–è€…ä»€ä¹ˆåŸå› æŠ¥é”™äº†ï¼Œä¸ä¼šè¿”å›è¯¦ç»†ä¿¡æ¯ã€‚</p>
<h3 id="React-createElement"><a href="#React-createElement" class="headerlink" title="React.createElement"></a>React.createElement</h3><p><code>React.createElement</code>æ˜¯æ ¸å¿ƒåº“é‡Œæä¾›çš„æ–¹æ³•ï¼Œä¸è¦ä½¿ç”¨<code>document.createElement</code></p>
<p>åˆ›å»ºä¸€ä¸ª<code>React</code>å…ƒç´ ï¼Œç§°ä½œè™šæ‹Ÿ<code>DOM</code>ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¯¹è±¡</p>
<ol>
<li>å‚æ•°1ï¼šå…ƒç´ ç±»å‹ï¼Œå¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œä¸€ä¸ªæ™®é€šçš„<code>HTML</code>å…ƒç´ </li>
<li>å‚æ•°2ï¼šå…ƒç´ çš„å±æ€§ï¼Œä¸€ä¸ªå¯¹è±¡</li>
<li>åç»­å‚æ•°ï¼šå…ƒç´ çš„å­èŠ‚ç‚¹</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> span = <span class="title class_">React</span>.<span class="title function_">createElement</span>(<span class="string">&quot;span&quot;</span>, &#123;&#125;, <span class="string">&quot;spanå…ƒç´ &quot;</span>);</span><br><span class="line"><span class="keyword">var</span> h1 = <span class="title class_">React</span>.<span class="title function_">createElement</span>(</span><br><span class="line">  <span class="string">&quot;h1&quot;</span>,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&quot;ç¬¬ä¸€ä¸ªReactå…ƒç´ &quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;HELLO&quot;</span>,</span><br><span class="line">  <span class="string">&quot;,&quot;</span>,</span><br><span class="line">  <span class="string">&quot;WORLD&quot;</span>,</span><br><span class="line">  span</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><code>React.createElement</code>åˆ›å»ºå®Œå…ƒç´ åï¼Œä½¿ç”¨<code>ReactDOM.render(h1,document.getElementById(&quot;root&quot;))</code>å®Œæˆè½¬æ¢æˆçœŸå®<code>DOM</code>å¯¹è±¡ï¼Œå¦‚ä¸‹</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"><span class="comment">// å°†æ™®é€šjså¯¹è±¡ï¼ˆè™šæ‹ŸDOMï¼‰è½¬æ¢æˆçœŸå®DOM</span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(h1, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„æƒ…å†µåœ¨<code>react-dom@18.2.0</code>ä¹‹ååšäº†å˜åŒ–ï¼Œæ”¹ä¸ºä»¥ä¸‹çš„æ–¹å¼åˆ›å»º<code>DOM</code>å¯¹è±¡</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRoot &#125; <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span>;</span><br><span class="line"><span class="comment">// å°†æ™®é€šjså¯¹è±¡ï¼ˆè™šæ‹ŸDOMï¼‰è½¬æ¢æˆçœŸå®DOM</span></span><br><span class="line"><span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>)).<span class="title function_">render</span>(h1); </span><br></pre></td></tr></table></figure>

<p>è™½ç„¶ç”¨ä¹‹å‰çš„æ–¹å¼ç°åœ¨ä¼šæŠ¥<code>Warning</code>ä¿¡æ¯ï¼Œä½†æ˜¯å†…å®¹è¿˜æ˜¯å¯ä»¥æ­£å¸¸å±•ç¤º</p>
<p>å…·ä½“å¯è§ï¼š<a target="_blank" rel="noopener" href="https://github.com/reactwg/react-18/discussions/5">https://github.com/reactwg/react-18/discussions/5</a></p>
<h3 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h3><p><code>JS</code>çš„æ‰©å±•è¯­æ³•ï¼Œéœ€è¦ä½¿ç”¨<code>babel</code>è¿›è¡Œè½¬ä¹‰ã€‚</p>
<p>åŠ ä¸Š<code>babel</code>è½¬è¯‘çš„åº“åï¼Œå¯ä»¥ç›´æ¥å†™ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// å¯¹JSXè¯­æ³•çš„è½¬è¯‘</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/babel-standalone@6/babel.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/babel&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// åˆ›å»ºä¸€ä¸ªh1 å…ƒç´ </span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> h1 = (</span></span><br><span class="line"><span class="language-javascript">  <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">title</span>=<span class="string">&quot;ä¸€ä¸ªh1å…ƒç´ &quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">    Helloï¼ŒWorld<span class="tag">&lt;<span class="name">span</span>&gt;</span>ä¸€ä¸ªspanå…ƒç´ <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">  <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span></span><br><span class="line"><span class="language-javascript">);</span></span><br><span class="line"><span class="language-javascript"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(h1, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>)); <span class="comment">// å°†æ™®é€šjså¯¹è±¡ï¼ˆè™šæ‹ŸDOMï¼‰è½¬æ¢æˆçœŸå®DOM</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„</strong>ï¼šè¿™é‡Œ<code>script</code>é‡Œéœ€è¦åŠ ä¸Š <code>type=&quot;text/babel&quot;</code>å‘Šè¯‰é‡Œé¢çš„å†…å®¹éœ€è¦è¢«<code>babel</code>è½¬è¯‘</p>
<h2 id="ä½¿ç”¨è„šæ‰‹æ¶æ­å»ºé…ç½®"><a href="#ä½¿ç”¨è„šæ‰‹æ¶æ­å»ºé…ç½®" class="headerlink" title="ä½¿ç”¨è„šæ‰‹æ¶æ­å»ºé…ç½®"></a>ä½¿ç”¨è„šæ‰‹æ¶æ­å»ºé…ç½®</h2><p>å®˜æ–¹ï¼š<code>create-react-app</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn create react-app å·¥ç¨‹åç§°</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸‰æ–¹ï¼š<code>next.js</code>ã€<code>umijs</code></p>
<p>å‡¡æ˜¯ä½¿ç”¨JSXçš„æ–‡ä»¶ï¼Œå¿…é¡»å¯¼å…¥<code>React</code></p>
<h3 id="VSCodeé…ç½®"><a href="#VSCodeé…ç½®" class="headerlink" title="VSCodeé…ç½®"></a>VSCodeé…ç½®</h3><p><code>emmet</code>é…ç½®ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;emmet.includeLanguages&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;javascript&quot;</span><span class="punctuation">:</span> <span class="string">&quot;javascriptreact&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="VSCodeæ’ä»¶å®‰è£…"><a href="#VSCodeæ’ä»¶å®‰è£…" class="headerlink" title="VSCodeæ’ä»¶å®‰è£…"></a>VSCodeæ’ä»¶å®‰è£…</h3><ul>
<li><code>ESLint</code>ï¼šä»£ç é£æ ¼æ£€æŸ¥</li>
<li><code>ES7 React/Redux/GraphQL/React-Native snippets</code>ï¼šå¿«é€Ÿä»£ç ç¼–å†™</li>
</ul>
<h3 id="Chromeæ’ä»¶å®‰è£…"><a href="#Chromeæ’ä»¶å®‰è£…" class="headerlink" title="Chromeæ’ä»¶å®‰è£…"></a>Chromeæ’ä»¶å®‰è£…</h3><p><code>React Developer Tools</code></p>
<h2 id="JSX-1"><a href="#JSX-1" class="headerlink" title="JSX"></a>JSX</h2><h3 id="ä»€ä¹ˆæ˜¯JSX"><a href="#ä»€ä¹ˆæ˜¯JSX" class="headerlink" title="ä»€ä¹ˆæ˜¯JSX"></a>ä»€ä¹ˆæ˜¯JSX</h3><ul>
<li><code>Facebook</code>èµ·è‰çš„<code>JS</code>æ‰©å±•è¯­æ³•</li>
<li>æœ¬è´¨æ˜¯ä¸€ä¸ª<code>JS</code>å¯¹è±¡ï¼Œä¼šè¢«<code>babel</code>ç¼–è¯‘ï¼Œæœ€ç»ˆä¼šè¢«è½¬æ¢ä¸º<code>React.createElement</code></li>
<li>æ¯ä¸ª<code>JSX</code>è¡¨è¾¾å¼ï¼Œæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹<ul>
<li>å¦‚æœéœ€è¦æœ‰ä¸¤ä¸ªæ ¹èŠ‚ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨<code>React.Fragment</code>(ä½¿ç”¨<code>&lt;&gt;&lt;/&gt;</code>åŒ…è£¹ï¼Œè¿™ä¸ªæ˜¯<code>&lt;React.Fragment&gt;&lt;/React.Fragment&gt;</code>è¯­æ³•ç³–)</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> h1 = (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">title</span>=<span class="string">&quot;ä¸€ä¸ªh1å…ƒç´ &quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      Helloï¼ŒWorld<span class="tag">&lt;<span class="name">span</span>&gt;</span>ä¸€ä¸ªspanå…ƒç´ <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>h2<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">);</span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(h1, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>)); <span class="comment">// å°†æ™®é€šjså¯¹è±¡ï¼ˆè™šæ‹ŸDOMï¼‰è½¬æ¢æˆçœŸå®DOM</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ¯ä¸ª<code>JSX</code>å…ƒç´ å¿…é¡»ç»“æŸï¼ˆ<code>XML</code>è§„èŒƒï¼‰</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;img&gt;&lt;/img&gt;</span><br><span class="line"><span class="comment">// æˆ–è€…è‡ªç»“æŸ</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> /&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="åœ¨JSXä¸­åµŒå…¥è¡¨è¾¾å¼"><a href="#åœ¨JSXä¸­åµŒå…¥è¡¨è¾¾å¼" class="headerlink" title="åœ¨JSXä¸­åµŒå…¥è¡¨è¾¾å¼"></a>åœ¨JSXä¸­åµŒå…¥è¡¨è¾¾å¼</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = <span class="number">1298</span>;</span><br><span class="line"><span class="keyword">const</span> b = <span class="number">284</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> h1 = (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;a&#125;*&#123;b&#125;=&#123;a * b&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(h1, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>)); <span class="comment">// å°†æ™®é€šjså¯¹è±¡ï¼ˆè™šæ‹ŸDOMï¼‰è½¬æ¢æˆçœŸå®DOM</span></span><br></pre></td></tr></table></figure>

<p>ç›¸å½“äºä¸‹é¢ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> h = <span class="title class_">React</span>.<span class="title function_">createElement</span>(<span class="string">&quot;h1&quot;</span>, &#123;&#125;, <span class="string">`<span class="subst">$&#123;a&#125;</span>*<span class="subst">$&#123;b&#125;</span>=<span class="subst">$&#123;a * b&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(h, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>)); <span class="comment">// å°†æ™®é€šjså¯¹è±¡ï¼ˆè™šæ‹ŸDOMï¼‰è½¬æ¢æˆçœŸå®DOM</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>åœ¨<code>JSX</code>ä¸­ä½¿ç”¨æ³¨é‡Š</p>
</li>
<li><p>å°†è¡¨è¾¾å¼ä½œä¸ºå†…å®¹çš„ä¸€éƒ¨åˆ†</p>
<ul>
<li><code>null</code>ã€<code>undefined</code>ã€<code>false</code>ä¸ä¼šæ˜¾ç¤º</li>
<li>æ™®é€šå¯¹è±¡ï¼Œä¸å¯ä»¥ä½œä¸ºå­å…ƒç´ </li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŠ¥é”™</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> h = <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;obj&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯ä»¥æ”¾ç½®<code>React</code>å…ƒç´ å¯¹è±¡</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = <span class="language-xml"><span class="tag">&lt;<span class="name">h</span>&gt;</span>hå…ƒç´ <span class="tag">&lt;/<span class="name">h</span>&gt;</span></span>;</span><br><span class="line"><span class="keyword">const</span> h = <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;obj&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯ä»¥æ”¾æ•°ç»„</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> numbers = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">20</span>);</span><br><span class="line">numbers.<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> list = numbers.<span class="title function_">map</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span>&#123;index&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>);</span><br><span class="line"><span class="keyword">const</span> h = <span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;list&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å°†è¡¨è¾¾å¼ä½œä¸ºå…ƒç´ å±æ€§</p>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> url = <span class="string">&quot;xxxx&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> cls = <span class="string">&quot;xxxx&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> div = (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;url&#125;</span> <span class="attr">className</span>=<span class="string">&#123;cls&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">width:</span> &quot;<span class="attr">100px</span>&quot;;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å±æ€§ä½¿ç”¨å°é©¼å³°å‘½åæ³•</p>
</li>
<li><p>é˜²æ­¢æ³¨å…¥æ”»å‡»</p>
<ul>
<li><p>è‡ªåŠ¨ç¼–ç </p>
</li>
<li><p><code>dangerouslySetInnerHTML</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> content = <span class="string">&quot;&lt;div&gt;haha&lt;/div&gt;&quot;</span></span><br><span class="line"><span class="keyword">const</span> div = (</span><br><span class="line">	<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">dangerouslySetInnerHTML</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">__html</span>=<span class="string">content</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">	&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>ç”¨æå…¶å¤æ‚çš„ä¼ å…¥æ–¹å¼å‘ŠçŸ¥ç”¨æˆ·ï¼Œé˜²æ­¢éœ€è¦å±•ç¤ºçš„å†…å®¹å…¶ä¸­æºæ‚å±é™©ä»£ç æ”¹å˜æ“ä½œ</p>
</li>
</ul>
</li>
</ul>
<h3 id="å…ƒç´ çš„ä¸å¯å˜æ€§"><a href="#å…ƒç´ çš„ä¸å¯å˜æ€§" class="headerlink" title="å…ƒç´ çš„ä¸å¯å˜æ€§"></a>å…ƒç´ çš„ä¸å¯å˜æ€§</h3><ul>
<li>è™½ç„¶<code>JSX</code>å…ƒç´ æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯è¯¥å¯¹è±¡ä¸­çš„æ‰€æœ‰å±æ€§ä¸å¯æ›´æ”¹ï¼ˆä½¿ç”¨äº†<code>object.freeze()</code>ï¼‰</li>
<li>å¦‚æœç¡®å®éœ€è¦æ›´æ”¹å…ƒç´ çš„å±æ€§ï¼Œéœ€è¦é‡æ–°åˆ›å»º<code>JSX</code>å…ƒç´ (å¹¶ä¸ä¼šæµªè´¹æ€§èƒ½ï¼Œå› ä¸ºé‡æ–°åˆ›å»º<code>JSX</code>å…ƒç´ æ—¶ï¼Œæ˜¯é‡æ–°åˆ›å»ºå¯¹è±¡ï¼Œå¹¶ä¸æ˜¯æ¯æ¬¡éƒ½é‡æ–°åˆ é™¤<code>DOM</code>é‡æ–°åˆ›å»ºï¼Œä»–åªä¼šæ”¹å˜<code>DOM</code>ä¸­æ”¹å˜çš„å†…å®¹)</li>
</ul>
<h2 id="ç»„ä»¶å’Œç»„ä»¶å±æ€§"><a href="#ç»„ä»¶å’Œç»„ä»¶å±æ€§" class="headerlink" title="ç»„ä»¶å’Œç»„ä»¶å±æ€§"></a>ç»„ä»¶å’Œç»„ä»¶å±æ€§</h2><p>ç»„ä»¶ï¼šåŒ…å«å†…å®¹ã€æ ·å¼å’ŒåŠŸèƒ½çš„UIå•å…ƒ</p>
<h3 id="åˆ›å»ºä¸€ä¸ªç»„ä»¶"><a href="#åˆ›å»ºä¸€ä¸ªç»„ä»¶" class="headerlink" title="åˆ›å»ºä¸€ä¸ªç»„ä»¶"></a>åˆ›å»ºä¸€ä¸ªç»„ä»¶</h3><p><strong>ç‰¹åˆ«æ³¨æ„ï¼šç»„ä»¶çš„åç§°é¦–å­—æ¯å¿…é¡»å¤§å†™</strong></p>
<ol>
<li>å‡½æ•°ç»„ä»¶</li>
</ol>
<p>è¿”å›ä¸€ä¸ªReactå…ƒç´ </p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createRoot &#125; <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> src1 <span class="keyword">from</span> <span class="string">&quot;./assets/1.jpg&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./index.css&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> container = <span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">MyComp</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;src1&#125;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> comp = <span class="language-xml"><span class="tag">&lt;<span class="name">MyComp</span> /&gt;</span></span>; <span class="comment">// ä½¿ç”¨ç»„ä»¶ç”Ÿæˆçš„ä»ç„¶æ˜¯ä¸€ä¸ªReactå…ƒç´ ï¼Œå˜åŒ–çš„åªæ˜¯typeå€¼</span></span><br><span class="line"></span><br><span class="line">container.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;comp&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>ç±»ç»„ä»¶</li>
</ol>
<p>å¿…é¡»ç»§æ‰¿React.Component</p>
<p>å¿…é¡»æä¾›renderå‡½æ•°ï¼Œç”¨äºæ¸²æŸ“ç»„ä»¶</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyClassComp.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> src2 <span class="keyword">from</span> <span class="string">&quot;./assets/2.jpg&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">MyClassComp</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ç±»ç»„ä»¶å†…å®¹ï¼š<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;src2&#125;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createRoot &#125; <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">MyComp</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./MyComp&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MyClassComp</span> <span class="keyword">from</span> <span class="string">&quot;./MyClassComp&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./index.css&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> container = <span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> comp = <span class="language-xml"><span class="tag">&lt;<span class="name">MyComp</span> /&gt;</span></span>; <span class="comment">// ä½¿ç”¨ç»„ä»¶ç”Ÿæˆçš„ä»ç„¶æ˜¯ä¸€ä¸ªReactå…ƒç´ ï¼Œå˜åŒ–çš„åªæ˜¯typeå€¼</span></span><br><span class="line"><span class="keyword">const</span> classComp = <span class="language-xml"><span class="tag">&lt;<span class="name">MyClassComp</span> /&gt;</span></span>;</span><br><span class="line"></span><br><span class="line">container.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;comp&#125;</span></span><br><span class="line"><span class="language-xml">    &#123;classComp&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<h3 id="ç»„ä»¶çš„å±æ€§"><a href="#ç»„ä»¶çš„å±æ€§" class="headerlink" title="ç»„ä»¶çš„å±æ€§"></a>ç»„ä»¶çš„å±æ€§</h3><ol>
<li>å¯¹äºå‡½æ•°ç»„ä»¶ï¼Œå±æ€§ä¼šä½œä¸ºä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œä¼ é€’ç»™å‡½æ•°çš„å‚æ•°</li>
<li>å¯¹äºç±»ç»„ä»¶ï¼Œå±æ€§ä¼šä½œä¸ºä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œä¼ é€’ç»™æ„é€ å‡½æ•°çš„å‚æ•°</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡½æ•°ç»„ä»¶</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> src1 <span class="keyword">from</span> <span class="string">&quot;./assets/1.jpg&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">MyFuncComp</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      å‡½æ•°ç»„ä»¶å†…å®¹ï¼š<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;src1&#125;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ä¼ å…¥çš„æ•°å­—æ˜¯ï¼š</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;props.number&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line">&lt;<span class="title class_">MyFuncComp</span> number=<span class="string">&quot;2&quot;</span> /&gt;;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç±»ç»„ä»¶</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> src2 <span class="keyword">from</span> <span class="string">&quot;./assets/2.jpg&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">MyClassComp</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(props);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ç±»ç»„ä»¶å†…å®¹ï¼š<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;src2&#125;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ä¼ å…¥çš„æ•°å­—æ˜¯ï¼š</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;this.props.number&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">const</span> classComp = <span class="language-xml"><span class="tag">&lt;<span class="name">MyClassComp</span> <span class="attr">number</span>=<span class="string">&quot;3&quot;</span> <span class="attr">enable</span> <span class="attr">obj</span>=<span class="string">&#123;&#123;</span> <span class="attr">name:</span> &quot;<span class="attr">yy</span>&quot;, <span class="attr">age:</span> <span class="attr">25</span> &#125;&#125; <span class="attr">ui</span>=<span class="string">&#123;</span>&lt;<span class="attr">div</span>&gt;</span>è¿™æ˜¯ä¼ é€’çš„å±æ€§<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;/&gt;</span>;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼šç»„ä»¶çš„å±æ€§ï¼Œåº”è¯¥ä½¿ç”¨å°é©¼å³°å‘½åæ³•</p>
<p><strong>ç»„ä»¶æ— æ³•æ”¹å˜è‡ªèº«çš„å±æ€§</strong>ã€‚</p>
<p>ä¹‹å‰å­¦ä¹ çš„Reactå…ƒç´ ï¼Œæœ¬è´¨ä¸Šï¼Œå°±æ˜¯ä¸€ä¸ªç»„ä»¶ï¼ˆå†…ç½®ç»„ä»¶ï¼‰</p>
<p>Reactä¸­çš„å“²å­¦ï¼šæ•°æ®å±äºè°ï¼Œè°æ‰æœ‰æƒåŠ›æ”¹åŠ¨</p>
<p><strong>Reactä¸­çš„æ•°æ®ï¼Œè‡ªé¡¶è€Œä¸‹æµåŠ¨</strong></p>
<h3 id="ç»„ä»¶çŠ¶æ€"><a href="#ç»„ä»¶çŠ¶æ€" class="headerlink" title="ç»„ä»¶çŠ¶æ€"></a>ç»„ä»¶çŠ¶æ€</h3><p>ç»„ä»¶çŠ¶æ€ï¼šç»„ä»¶å¯ä»¥è‡ªè¡Œç»´æŠ¤çš„æ•°æ®</p>
<p>ç»„ä»¶çŠ¶æ€ä»…åœ¨ç±»ç»„ä»¶ä¸­æœ‰æ•ˆ</p>
<p>çŠ¶æ€ï¼ˆstateï¼‰ï¼Œæœ¬è´¨ä¸Šæ˜¯ç±»ç»„ä»¶çš„ä¸€ä¸ªå±æ€§ï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡</p>
<p><strong>çŠ¶æ€åˆå§‹åŒ–</strong></p>
<p><strong>çŠ¶æ€çš„å˜åŒ–</strong></p>
<p>ä¸èƒ½ç›´æ¥æ”¹å˜çŠ¶æ€ï¼šå› ä¸ºReactæ— æ³•ç›‘æ§åˆ°çŠ¶æ€å‘ç”Ÿäº†å˜åŒ–</p>
<p>å¦‚ä¸‹ï¼Œåœ¨å­ç»„ä»¶ä¸­ç›´æ¥å¯¹æ•°æ®è¿›è¡Œæ“ä½œï¼Œå¹¶ä¸ä¼šé‡æ–°æ¸²æŸ“ç•Œé¢</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Tick</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–çŠ¶æ€</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">left</span>: <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">number</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">timer</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">left</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">timer</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">left</span>--; <span class="comment">// è¿™é‡Œç›´æ¥è‡ªå‡å¹¶ä¸ä¼šè§¦å‘ç•Œé¢é‡æ–°æ¸²æŸ“</span></span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>å€’è®¡æ—¶å‰©ä½™ï¼š&#123;this.state.left&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¿…é¡»ä½¿ç”¨this.setState({})æ”¹å˜çŠ¶æ€</p>
<p>ä¸€æ—¦è°ƒç”¨äº†this.setStateï¼Œä¼šå¯¼è‡´å½“å‰ç»„ä»¶é‡æ–°æ¸²æŸ“</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Tick.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Tick</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–çŠ¶æ€ï¼ŒJS Nextè¯­æ³•ï¼ŒBabelä¼šè¿›è¡Œç¼–è¯‘æˆæ­£å¸¸è¯­æ³•</span></span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">left</span>: <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">number</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–çŠ¶æ€</span></span><br><span class="line">    <span class="comment">// this.state = &#123;</span></span><br><span class="line">    <span class="comment">//   left: this.props.number</span></span><br><span class="line">    <span class="comment">// &#125;;</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">timer</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">left</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">timer</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">        <span class="attr">left</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">left</span> - <span class="number">1</span></span><br><span class="line">      &#125;); <span class="comment">// éœ€è¦ä½¿ç”¨setStateé‡æ–°è®¾ç½®çŠ¶æ€ï¼Œè§¦å‘è‡ªåŠ¨é‡æ–°æ¸²æŸ“</span></span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>å€’è®¡æ—¶å‰©ä½™ï¼š&#123;this.state.left&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.jsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRoot &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Tick</span> <span class="keyword">from</span> <span class="string">&#x27;./components/Tick.jsx&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> container = <span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myTick = <span class="language-xml"><span class="tag">&lt;<span class="name">Tick</span> <span class="attr">number</span>=<span class="string">&#123;3&#125;</span> /&gt;</span></span>;</span><br><span class="line"></span><br><span class="line">container.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;myTick&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br></pre></td></tr></table></figure>

<p><strong>ç»„ä»¶ä¸­çš„æ•°æ®</strong></p>
<ol>
<li>propsï¼šè¯¥æ•°æ®æ˜¯ç”±ç»„ä»¶çš„ä½¿ç”¨è€…ä¼ é€’çš„æ•°æ®ï¼Œæ‰€æœ‰æƒä¸å±äºç»„ä»¶è‡ªèº«ï¼Œå› æ­¤ç»„ä»¶æ— æ³•æ”¹å˜è¯¥æ•°ç»„</li>
<li>stateï¼šè¯¥æ•°ç»„æ˜¯ç”±ç»„ä»¶è‡ªèº«åˆ›å»ºçš„ï¼Œæ‰€æœ‰æƒå±äºç»„ä»¶è‡ªèº«ï¼Œå› æ­¤ç»„ä»¶æœ‰æƒæ”¹å˜è¯¥æ•°æ®</li>
</ol>
<h2 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h2><p>åœ¨Reactä¸­ï¼Œç»„ä»¶çš„äº‹ä»¶ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå±æ€§ã€å‡½æ•°</p>
<p>æŒ‰ç…§ä¹‹å‰Reactå¯¹ç»„ä»¶çš„çº¦å®šï¼Œç”±äºäº‹ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå±æ€§ï¼Œå› æ­¤ä¹Ÿéœ€è¦ä½¿ç”¨å°é©¼å³°å‘½åæ³•</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createRoot &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//function doClick() &#123;</span></span><br><span class="line"><span class="comment">//  alert(&#x27;ç‚¹å‡»äº†æŒ‰é’®&#x27;);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//const btn = (</span></span><br><span class="line"><span class="comment">//    &lt;button</span></span><br><span class="line"><span class="comment">//      onClick=&#123;doClick&#125;</span></span><br><span class="line"><span class="comment">//    &gt;</span></span><br><span class="line"><span class="comment">//      æŒ‰é’®</span></span><br><span class="line"><span class="comment">//    &lt;/button&gt;</span></span><br><span class="line"><span class="comment">//);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> btn = (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">onMouseEnter</span>=<span class="string">&#123;(e)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        console.log(&#x27;é¼ æ ‡ç§»å…¥äº†æŒ‰é’®ï¼Œå‚æ•°eæ˜¯:&#x27;, e);</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;</span></span><br><span class="line"><span class="language-xml">    &gt;</span></span><br><span class="line"><span class="language-xml">      æŒ‰é’®</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> container = <span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line"></span><br><span class="line">container.<span class="title function_">render</span>(btn);</span><br></pre></td></tr></table></figure>

<p>ç»„ä»¶å†…ä¼šåœ¨é€‚å½“æ—¶æœºæ‰§è¡Œä¸€äº›å¤„ç†å‡½æ•°ï¼Œä½¿ç”¨ç»„ä»¶æ—¶å¯ä»¥å®šä¹‰è¿™äº›å‡½æ•°æ‰§è¡Œå†…å®¹ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Tick.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Tick</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">number</span>: <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">number</span> || <span class="number">0</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">number</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">        <span class="comment">// å€’è®¡æ—¶å®Œæˆéœ€è¦å¤„ç†çš„äº‹ä»¶</span></span><br><span class="line">        props.<span class="property">onOver</span> &amp;&amp; props.<span class="title function_">onOver</span>();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">        <span class="attr">number</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">number</span> - <span class="number">1</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>å€’è®¡æ—¶ï¼š&#123;this.state.number&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TickControl.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Tick</span> <span class="keyword">from</span> <span class="string">&#x27;./Tick&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">TickControl</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">isOver</span>: <span class="literal">false</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å€’è®¡æ—¶ç»“æŸæ‰§è¡Œäº‹ä»¶</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  doOver = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">isOver</span>: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> initNumber = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title class_">Ticks</span> = <span class="language-xml"><span class="tag">&lt;<span class="name">Tick</span> <span class="attr">onOver</span>=<span class="string">&#123;this.doOver&#125;</span> <span class="attr">number</span>=<span class="string">&#123;initNumber&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Tick</span>&gt;</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> countDownState = <span class="string">&#x27;æ­£åœ¨å€’è®¡æ—¶...&#x27;</span>; <span class="comment">// è®°å½•å€’è®¡æ—¶çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">isOver</span>) &#123;</span><br><span class="line">      countDownState = <span class="string">&#x27;å€’è®¡æ—¶ç»“æŸï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;Ticks&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;countDownState&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šç®€å•å®ç°äº†å€’è®¡æ—¶ç»“æŸï¼Œç•Œé¢ä¿¡æ¯æ”¹å˜ã€‚</p>
<p><strong>å¦‚æœæ²¡æœ‰ç‰¹æ®Šå¤„ç†ï¼Œåœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­ï¼ŒthisæŒ‡å‘undefined</strong></p>
<ol>
<li>ä½¿ç”¨bindå‡½æ•°ï¼Œç»‘å®šthis</li>
<li>ä½¿ç”¨ç®­å¤´å‡½æ•°</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨bind</span></span><br><span class="line"><span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="variable language_">super</span>(props);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">doOver</span> = <span class="variable language_">this</span>.<span class="property">doOver</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å€’è®¡æ—¶ç»“æŸæ‰§è¡Œäº‹ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title function_">doOver</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">    <span class="attr">isOver</span>: <span class="literal">true</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// ä½¿ç”¨ç®­å¤´å‡½æ•°</span></span><br><span class="line">doOver = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">    <span class="attr">isOver</span>: <span class="literal">true</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h2 id="æ·±å…¥è®¤è¯†setState"><a href="#æ·±å…¥è®¤è¯†setState" class="headerlink" title="æ·±å…¥è®¤è¯†setState"></a>æ·±å…¥è®¤è¯†setState</h2><p>setStateï¼Œå®ƒå¯¹çŠ¶æ€çš„æ”¹å˜ï¼Œ<strong>å¯èƒ½</strong>æ˜¯å¼‚æ­¥çš„</p>
<blockquote>
<p>å¦‚æœæ”¹å˜çŠ¶æ€çš„ä»£ç å¤„äºæŸä¸ªHTMLå…ƒç´ çš„äº‹ä»¶ä¸­ï¼Œåˆ™å…¶æ˜¯å¼‚æ­¥çš„ï¼Œå¦åˆ™æ˜¯åŒæ­¥</p>
</blockquote>
<p>å¦‚æœé‡åˆ°æŸä¸ªäº‹ä»¶ä¸­ï¼Œéœ€è¦åŒæ­¥è°ƒç”¨å¤šæ¬¡ï¼Œéœ€è¦ä½¿ç”¨å‡½æ•°çš„æ–¹å¼å¾—åˆ°æœ€æ–°çŠ¶æ€ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function"><span class="params">cur</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// å‚æ•°curè¡¨ç¤ºå½“å‰çŠ¶æ€</span></span><br><span class="line">	<span class="keyword">return</span>  &#123;<span class="attr">n</span>: cur.<span class="property">n</span> + <span class="number">1</span>&#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function"><span class="params">cur</span> =&gt;</span> &#123;<span class="attr">n</span>: cur.<span class="property">n</span> + <span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°åœ¨ç®­å¤´å‡½æ•°ä¸­å®ç°åŒæ­¥</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="title function_">setState</span>(</span><br><span class="line">   &#123;</span><br><span class="line">     <span class="attr">number</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">number</span> - <span class="number">1</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="function">() =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">number</span> &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">       <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">       <span class="comment">// å€’è®¡æ—¶å®Œæˆéœ€è¦å¤„ç†çš„äº‹ä»¶</span></span><br><span class="line">       props.<span class="property">onOver</span> &amp;&amp; props.<span class="title function_">onOver</span>();</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"> );</span><br></pre></td></tr></table></figure>

<p>æœ€ä½³å®è·µï¼š</p>
<ol>
<li>æŠŠæ‰€æœ‰çš„setStateå½“ä½œæ˜¯å¼‚æ­¥çš„</li>
<li>æ°¸è¿œä¸è¦ä¿¡ä»»setStateè°ƒç”¨ä¹‹åçš„çŠ¶æ€</li>
<li>å¦‚æœè¦ä½¿ç”¨æ”¹å˜ä¹‹åçš„çŠ¶æ€ï¼Œéœ€è¦ä½¿ç”¨å›è°ƒå‡½æ•°ï¼ˆsetStateçš„ç¬¬äºŒä¸ªå‚æ•°ï¼‰</li>
<li>å¦‚æœæ–°çš„çŠ¶æ€è¦æ ¹æ®ä¹‹å‰çš„çŠ¶æ€è¿›è¡Œè¿ç®—ï¼Œä½¿ç”¨å‡½æ•°çš„æ–¹å¼æ”¹å˜çŠ¶æ€ï¼ˆsetStateçš„ç¬¬ä¸€ä¸ªå‡½æ•°ï¼‰</li>
</ol>
<p>React18å‰ï¼ŒReactä¼šå¯¹<strong>å¼‚æ­¥</strong>çš„setStateè¿›è¡Œä¼˜åŒ–ï¼Œå°†å¤šæ¬¡setStateè¿›è¡Œåˆå¹¶ï¼ˆå°†å¤šæ¬¡çŠ¶æ€æ”¹å˜å®Œæˆåï¼Œå†ç»Ÿä¸€å¯¹stateè¿›è¡Œæ”¹å˜ï¼Œç„¶åè§¦å‘renderï¼‰</p>
<p><strong>React18åï¼Œé»˜è®¤ä¸ºå¼‚æ­¥çš„ï¼Œæ‰€ä»¥ï¼Œå¦‚æœä¸€ä¸ªå€’è®¡æ—¶æ–¹æ³•å†…ï¼Œä¸€ç§’å†…å¤šæ¬¡ä½¿ç”¨setStateä½¿æ•°å­—-1ï¼Œå®é™…ä¸Šä¸ç®¡æœ‰å¤šå°‘æ¬¡ä½¿ç”¨ï¼Œåªæœ‰ä¸€æ¬¡-1ï¼Œç„¶åè§¦å‘render</strong>ï¼Œè¿™æ˜¯å°±éœ€è¦ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å®ç°ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">number</span> === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">    <span class="comment">// å€’è®¡æ—¶å®Œæˆéœ€è¦å¤„ç†çš„äº‹ä»¶</span></span><br><span class="line">    props.<span class="property">onOver</span> &amp;&amp; props.<span class="title function_">onOver</span>();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setState</span>(</span><br><span class="line">    <span class="function">(<span class="params">cur</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">number</span>: cur.<span class="property">number</span> - <span class="number">1</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setState</span>(</span><br><span class="line">    <span class="function">(<span class="params">cur</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">number</span>: cur.<span class="property">number</span> - <span class="number">1</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setState</span>(</span><br><span class="line">    <span class="function">(<span class="params">cur</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">number</span>: cur.<span class="property">number</span> - <span class="number">1</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·åŒæ­¥è°ƒç”¨å¤šæ¬¡å°±èƒ½å®ç°-3äº†</p>
<h2 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h2><p>ç”Ÿå‘½å‘¨æœŸï¼šç»„ä»¶ä»è¯ç”Ÿåˆ°é”€æ¯ä¼šç»å†ä¸€ç³»åˆ—çš„è¿‡ç¨‹ï¼Œè¯¥è¿‡ç¨‹å°±å«åšç”Ÿå‘½å‘¨æœŸã€‚Reactåœ¨ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¸­æä¾›äº†ä¸€ç³»åˆ—çš„é’©å­å‡½æ•°ï¼ˆç±»ä¼¼äºäº‹ä»¶ï¼‰ï¼Œå¯ä»¥è®©å¼€å‘è€…åœ¨å‡½æ•°ä¸­æ³¨å…¥ä»£ç ï¼Œè¿™äº›ä»£ç ä¼šåœ¨é€‚å½“çš„æ—¶å€™è¿è¡Œã€‚</p>
<p><strong>ç”Ÿå‘½å‘¨æœŸä»…å­˜åœ¨äºç±»ç»„ä»¶ä¸­ï¼Œå‡½æ•°ç»„ä»¶æ¯æ¬¡è°ƒç”¨éƒ½æ˜¯é‡æ–°è¿è¡Œå‡½æ•°ï¼Œæ—§çš„ç»„ä»¶å³åˆ»è¢«é”€æ¯</strong></p>
<p><strong>å‡½æ•°ç»„ä»¶ä½¿ç”¨HOOKå¦è¯´</strong></p>
<h3 id="æ—§ç‰ˆç”Ÿå‘½å‘¨æœŸ"><a href="#æ—§ç‰ˆç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="æ—§ç‰ˆç”Ÿå‘½å‘¨æœŸ"></a>æ—§ç‰ˆç”Ÿå‘½å‘¨æœŸ</h3><p>React &lt; 16.0.0</p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">OldLife</span> <span class="keyword">from</span> <span class="string">&#x27;./OldLife&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">number</span>: <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">10</span> + <span class="number">1</span>),</span><br><span class="line">      <span class="attr">isShowComp</span>: <span class="literal">true</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å½“æ•°æ®åŠ åˆ°11æ—¶ï¼Œåœæ­¢å¢åŠ ï¼Œåœ¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸshouldComponentUpdateå‡½æ•°ä¸­ï¼Œ</span></span><br><span class="line"><span class="comment">   * åšäº†åˆ¤æ–­ï¼Œå¦‚æœå±æ€§ã€çŠ¶æ€æ²¡æœ‰å˜åŒ–ï¼Œåˆ™ä¸ä¼šé‡æ–°è°ƒç”¨ç»„ä»¶çš„renderå‡½æ•°</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  doNumIncrease = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(</span><br><span class="line">      <span class="function">(<span class="params">cur</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">number</span> === <span class="number">11</span></span><br><span class="line">          ? &#123; <span class="attr">number</span>: <span class="number">11</span> &#125;</span><br><span class="line">          : &#123; <span class="attr">number</span>: cur.<span class="property">number</span> + <span class="number">1</span> &#125;;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;---------&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title class_">OldDom</span> = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">isShowComp</span> ? (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">OldLife</span> <span class="attr">number</span>=<span class="string">&#123;this.state.number&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">OldLife</span>&gt;</span></span></span><br><span class="line">    ) : <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;OldDom&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.doNumIncrease&#125;</span>&gt;</span>å¢åŠ number<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            this.setState(</span></span><br><span class="line"><span class="language-xml">              (cur) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                return &#123;</span></span><br><span class="line"><span class="language-xml">                  isShowComp: !cur.isShowComp</span></span><br><span class="line"><span class="language-xml">                &#125;;</span></span><br><span class="line"><span class="language-xml">              &#125;,</span></span><br><span class="line"><span class="language-xml">              () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                console.log(&#x27;---------&#x27;);</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            );</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;</span></span><br><span class="line"><span class="language-xml">          ç»„ä»¶æ˜¾ç¤ºéšè—</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// OldLife.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">OldLife</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">number</span>: <span class="number">0</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;constructor-æ–°ç»„ä»¶OldLifeè¯ç”Ÿ&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;componentDidMount-è™šæ‹ŸDOMå·²è¢«æŒ‚è½½åˆ°é¡µé¢ï¼Œæˆä¸ºçœŸå®DOM&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * åœ¨çˆ¶ç»„ä»¶ä¸­å¢åŠ äº†ä¸€ä¸ªæ¡ä»¶ï¼Œä½¿props.numberåŠ åˆ°11å°±ä¸å†å¢åŠ ï¼Œ</span></span><br><span class="line"><span class="comment">   * æ‰€ä»¥å½“åˆ°è¾¾11æ—¶ï¼Œè¿™é‡Œä¼šreturn falseï¼Œåˆ™ä¸ä¼šæ‰ç”¨ä¸‹é¢çš„renderå‡½æ•°</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; nextProps æ›´æ–°çš„prop</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; nextState æ›´æ–°çš„state</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">shouldComponentUpdate</span>(<span class="params">nextProps, nextState</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;shouldComponentUpdate-nextProps&#x27;</span>, nextProps);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;shouldComponentUpdate-nextState&#x27;</span>, nextState);</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">number</span> === nextProps.<span class="property">number</span> &amp;&amp;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">number</span> === nextState.<span class="property">number</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidUpdate</span>(<span class="params">prevProps, prevState</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;componentDidUpdate-prevProps&#x27;</span>, prevProps);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;componentDidUpdate-prevState&#x27;</span>, prevState);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;componentWillUnmount-ç»„ä»¶è¢«é”€æ¯&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;renderï¼Œæ¸²æŸ“ï¼Œè¿”å›çš„Reactå…ƒç´ ä¼šè¢«æŒ‚è½½åˆ°è™šæ‹ŸDOMæ ‘ä¸­&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>ä¼ å…¥çš„props.number:&#123;this.props.number&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>è‡ªèº«çš„state.number:&#123;this.state.number&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>constructor</p>
<ol>
<li><strong>åŒä¸€ä¸ªç»„ä»¶å¯¹è±¡åªä¼šåˆ›å»ºä¸€æ¬¡</strong></li>
<li>ä¸èƒ½åœ¨ç¬¬ä¸€æ¬¡æŒ‚è½½åˆ°é¡µé¢ä¹‹å‰ï¼Œè°ƒç”¨setStateï¼Œä¸ºäº†é¿å…é—®é¢˜ï¼Œæ„é€ å‡½æ•°ä¸­ä¸¥ç¦ä½¿ç”¨setState</li>
</ol>
</li>
<li><p>componentWillMountï¼ˆReact 16.9.0åæ²¡æœ‰äº†ï¼‰</p>
<ol>
<li>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå’Œæ„é€ å‡½æ•°ä¸€æ ·ï¼Œå®ƒåªä¼šè¿è¡Œä¸€æ¬¡</li>
<li>å¯ä»¥ä½¿ç”¨setStateï¼Œä½†æ˜¯ä¸ºäº†é¿å…bugï¼Œä¸å…è®¸ä½¿ç”¨ï¼Œå› ä¸ºåœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œè¯¥å‡½æ•°å¯èƒ½è¢«è°ƒç”¨å¤šæ¬¡</li>
</ol>
</li>
<li><p><strong>render</strong></p>
<ol>
<li>è¿”å›ä¸€ä¸ªè™šæ‹ŸDOMï¼Œä¼šè¢«æŒ‚è½½åˆ°è™šæ‹ŸDOMæ ‘ä¸­ï¼Œæœ€ç»ˆæ¸²æŸ“åˆ°é¡µé¢çš„çœŸå®DOMä¸­</li>
<li>renderå¯èƒ½ä¸åªè¿è¡Œä¸€æ¬¡ï¼Œåªè¦éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œå°±ä¼šé‡æ–°è¿è¡Œ</li>
<li><strong>ä¸¥ç¦ä½¿ç”¨setState</strong>ï¼Œå› ä¸ºå¯èƒ½ä¼šå¯¼è‡´æ— é™é€’å½’æ¸²æŸ“</li>
</ol>
</li>
<li><p><strong>componentDidMount</strong></p>
<ol>
<li><strong>åªä¼šæ‰§è¡Œä¸€æ¬¡</strong></li>
<li>å¯ä»¥ä½¿ç”¨setState</li>
<li>é€šå¸¸æƒ…å†µä¸‹ï¼Œä¼šå°†<strong>ç½‘ç»œè¯·æ±‚</strong>ã€<strong>å¯åŠ¨è®¡æ—¶å™¨</strong>ç­‰ä¸€å¼€å§‹éœ€è¦çš„æ“ä½œï¼Œä¹¦å†™åˆ°è¯¥å‡½æ•°ä¸­</li>
</ol>
</li>
<li><p>ç»„ä»¶è¿›å…¥æ´»è·ƒçŠ¶æ€</p>
</li>
<li><p>componentWillReceivePropsï¼ˆReact 16.9.0åæ²¡æœ‰äº†ï¼‰</p>
<ol>
<li>å³å°†æ¥æ”¶æ–°çš„å±æ€§å€¼</li>
<li>å‚æ•°ä¸ºæ–°çš„å±æ€§å¯¹è±¡</li>
<li>è¯¥å‡½æ•°å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›bugï¼Œæ‰€ä»¥ä¸æ¨èä½¿ç”¨</li>
</ol>
</li>
<li><p><strong>shouldComponentUpdate</strong>ï¼ˆæ˜¯ä¸ªæ€§èƒ½ä¼˜åŒ–ç‚¹ï¼‰</p>
<ol>
<li>æŒ‡ç¤ºReactæ˜¯å¦è¦é‡æ–°æ¸²æŸ“è¯¥ç»„ä»¶ï¼Œé€šè¿‡è¿”å›trueå’Œfalseæ¥æŒ‡å®š</li>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šç›´æ¥è¿”å›true</li>
</ol>
<p>æ‰€ä»¥ä¸ç®¡å±æ€§å˜åŒ–ã€çŠ¶æ€å˜åŒ–éƒ½ä¼šé‡æ–°æ¸²æŸ“</p>
</li>
<li><p>componentWillUpdateï¼ˆReact 16.9.0åæ²¡æœ‰äº†ï¼‰</p>
<ol>
<li>ç»„ä»¶å³å°†è¢«é‡æ–°æ¸²æŸ“</li>
</ol>
</li>
<li><p>componentDidUpdate</p>
<ol>
<li>å¾€å¾€åœ¨è¯¥å‡½æ•°ä¸­ä½¿ç”¨domæ“ä½œï¼Œæ”¹å˜å…ƒç´ </li>
</ol>
</li>
<li><p><strong>componentWillUnmount</strong></p>
<p>ç»„ä»¶åœ¨DOMæ ‘ä¸­è¢«é”€æ¯</p>
<ol>
<li>é€šå¸¸åœ¨è¯¥å‡½æ•°ä¸­é”€æ¯ä¸€äº›ç»„ä»¶ä¾èµ–çš„èµ„æºï¼Œæ¯”å¦‚è®¡æ—¶å™¨</li>
</ol>
</li>
</ol>
<h3 id="æ–°ç‰ˆç”Ÿå‘½å‘¨æœŸ"><a href="#æ–°ç‰ˆç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="æ–°ç‰ˆç”Ÿå‘½å‘¨æœŸ"></a>æ–°ç‰ˆç”Ÿå‘½å‘¨æœŸ</h3><p>React &gt;&#x3D; 16.0.0</p>
<p>Reactå®˜æ–¹è®¤ä¸ºï¼ŒæŸä¸ªæ•°æ®çš„æ¥æºå¿…é¡»æ˜¯å•ä¸€çš„ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªå±æ€§ä¸èƒ½å³å—propså½±å“ä¹Ÿå—è‡ªèº«stateå½±å“</p>
<ol>
<li>getDerivedStateFromProps<ol>
<li>é€šè¿‡å‚æ•°å¯ä»¥è·å–æ–°çš„å±æ€§å’ŒçŠ¶æ€</li>
<li>è¯¥å‡½æ•°æ˜¯é™æ€çš„ï¼Œä¸èƒ½ä½¿ç”¨this.setState</li>
<li>è¯¥å‡½æ•°çš„è¿”å›å€¼ä¼šè¦†ç›–æ‰ç»„ä»¶çŠ¶æ€</li>
<li>è¯¥å‡½æ•°å‡ ä¹æ˜¯æ²¡æœ‰ä»€ä¹ˆç”¨</li>
</ol>
</li>
<li>getSnapshotBeforeUpdate<ol>
<li>çœŸå®çš„DOMæ„å»ºå®Œæˆï¼Œä½†è¿˜æœªå®é™…æ¸²æŸ“åˆ°é¡µé¢ä¸­ã€‚</li>
<li>åœ¨è¯¥å‡½æ•°ä¸­ï¼Œé€šå¸¸ç”¨äºå®ç°ä¸€äº›é™„åŠ çš„domæ“ä½œ</li>
<li>è¯¥å‡½æ•°çš„è¿”å›å€¼ï¼Œä¼šä½œä¸ºcomponentDidUpdateçš„ç¬¬ä¸‰ä¸ªå‚æ•°</li>
</ol>
</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">OldLife</span> <span class="keyword">from</span> <span class="string">&#x27;./OldLife&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NewLife</span> <span class="keyword">from</span> <span class="string">&#x27;./NewLife&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">number</span>: <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">10</span> + <span class="number">1</span>),</span><br><span class="line">      <span class="attr">isShowComp</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">isShowOld</span>: <span class="literal">false</span> <span class="comment">// æ˜¯å¦æ˜¾ç¤ºæ—§ç”Ÿå‘½å‘¨æœŸç»„ä»¶ï¼Œè°ƒè¯•æ–°ç”Ÿå‘½å‘¨æœŸç»„ä»¶æ—¶å°†æ—§çš„éšè—</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å½“æ•°æ®åŠ åˆ°11æ—¶ï¼Œåœæ­¢å¢åŠ ï¼Œåœ¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸshouldComponentUpdateå‡½æ•°ä¸­ï¼Œ</span></span><br><span class="line"><span class="comment">   * åšäº†åˆ¤æ–­ï¼Œå¦‚æœå±æ€§ã€çŠ¶æ€æ²¡æœ‰å˜åŒ–ï¼Œåˆ™ä¸ä¼šé‡æ–°è°ƒç”¨ç»„ä»¶çš„renderå‡½æ•°</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  doNumIncrease = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(</span><br><span class="line">      <span class="function">(<span class="params">cur</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">number</span> === <span class="number">11</span></span><br><span class="line">          ? &#123; <span class="attr">number</span>: <span class="number">11</span> &#125;</span><br><span class="line">          : &#123; <span class="attr">number</span>: cur.<span class="property">number</span> + <span class="number">1</span> &#125;;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;---------&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title class_">OldDom</span> =</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">isShowComp</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">isShowOld</span> ? (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">OldLife</span> <span class="attr">number</span>=<span class="string">&#123;this.state.number&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">OldLife</span>&gt;</span></span></span><br><span class="line">      ) : <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title class_">NewDom</span> = <span class="language-xml"><span class="tag">&lt;<span class="name">NewLife</span> <span class="attr">number</span>=<span class="string">&#123;this.state.number&#125;</span> /&gt;</span></span>;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>æ—§ç”Ÿå‘½å‘¨æœŸå±•ç¤º<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;OldDom&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.doNumIncrease&#125;</span>&gt;</span>å¢åŠ number<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            this.setState(</span></span><br><span class="line"><span class="language-xml">              (cur) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                return &#123;</span></span><br><span class="line"><span class="language-xml">                  isShowComp: !cur.isShowComp</span></span><br><span class="line"><span class="language-xml">                &#125;;</span></span><br><span class="line"><span class="language-xml">              &#125;,</span></span><br><span class="line"><span class="language-xml">              () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                console.log(&#x27;---------&#x27;);</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            );</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;</span></span><br><span class="line"><span class="language-xml">          ç»„ä»¶æ˜¾ç¤ºéšè—</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>æ–°ç”Ÿå‘½å‘¨æœŸå±•ç¤º<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;NewDom&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.doNumIncrease&#125;</span>&gt;</span>çˆ¶ç»„ä»¶å¢åŠ NewLifeçš„number<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//NewLife.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">NewLife</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">number</span>: <span class="number">0</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;NewLife-constructor-æ–°ç»„ä»¶NewLifeè¯ç”Ÿ&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">getDerivedStateFromProps</span>(<span class="params">props, state</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;NewLife-getDerivedStateFromProps&#x27;</span>); <span class="comment">// æ— æ³•ä½¿ç”¨this.setState</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;NewLife-componentDidMount-è™šæ‹ŸDOMå·²è¢«æŒ‚è½½åˆ°é¡µé¢ï¼Œæˆä¸ºçœŸå®DOM&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * åœ¨çˆ¶ç»„ä»¶ä¸­å¢åŠ äº†ä¸€ä¸ªæ¡ä»¶ï¼Œä½¿props.numberåŠ åˆ°11å°±ä¸å†å¢åŠ ï¼Œ</span></span><br><span class="line"><span class="comment">   * æ‰€ä»¥å½“åˆ°è¾¾11æ—¶ï¼Œè¿™é‡Œä¼šreturn falseï¼Œåˆ™ä¸ä¼šæ‰ç”¨ä¸‹é¢çš„renderå‡½æ•°</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; nextProps æ›´æ–°çš„prop</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; nextState æ›´æ–°çš„state</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">shouldComponentUpdate</span>(<span class="params">nextProps, nextState</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;NewLife-shouldComponentUpdate-nextProps&#x27;</span>, nextProps);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;NewLife-shouldComponentUpdate-nextState&#x27;</span>, nextState);</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">number</span> === nextProps.<span class="property">number</span> &amp;&amp;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">number</span> === nextState.<span class="property">number</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getSnapshotBeforeUpdate</span>(<span class="params">prevProps, prevState</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">      <span class="string">&#x27;NewLife-getSnapshotBeforeUpdate-çœŸå®çš„DOMæ„å»ºå®Œæˆï¼Œä½†è¿˜æœªå®é™…æ¸²æŸ“åˆ°é¡µé¢ä¸­ã€‚&#x27;</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> <span class="number">123</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidUpdate</span>(<span class="params">prevProps, prevState, snapVal</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;NewLife-componentDidUpdate-prevProps&#x27;</span>, prevProps);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;NewLife-componentDidUpdate-prevState&#x27;</span>, prevState);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;NewLife-componentDidUpdate-snapVal&#x27;</span>, snapVal);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;NewLife-componentWillUnmount-ç»„ä»¶è¢«é”€æ¯&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;NewLife-renderï¼Œæ¸²æŸ“ï¼Œè¿”å›çš„Reactå…ƒç´ ä¼šè¢«æŒ‚è½½åˆ°è™šæ‹ŸDOMæ ‘ä¸­&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>ä¼ å…¥çš„props.number:&#123;this.props.number&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>è‡ªèº«çš„state.number:&#123;this.state.number&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            this.setState((cur) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return &#123; number: cur.number + 1 &#125;;</span></span><br><span class="line"><span class="language-xml">            &#125;);</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;</span></span><br><span class="line"><span class="language-xml">          æ–°ç”Ÿå‘½å‘¨æœŸç»„ä»¶å†…state.number+1</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ä¼ é€’å…ƒç´ å†…å®¹"><a href="#ä¼ é€’å…ƒç´ å†…å®¹" class="headerlink" title="ä¼ é€’å…ƒç´ å†…å®¹"></a>ä¼ é€’å…ƒç´ å†…å®¹</h2><p>å†…ç½®ç»„ä»¶ï¼šdivã€h1ã€p</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">asdfafasfafasdfasdf</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœç»™è‡ªå®šä¹‰ç»„ä»¶ä¼ é€’å…ƒç´ å†…å®¹ï¼Œåˆ™Reactä¼šå°†å…ƒç´ å†…å®¹ä½œä¸ºchildrenå±æ€§ä¼ é€’è¿‡å»ã€‚</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createRoot &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Comp</span> <span class="keyword">from</span> <span class="string">&#x27;./Comp&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// const Dom = &lt;Comp html=&#123;&lt;h1&gt;è¿™æ˜¯ä¼ é€’çš„h1å…ƒç´ å†…å®¹&lt;/h1&gt;&#125; /&gt;;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Dom</span> = (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Comp</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">html</span>=<span class="string">&#123;</span>&lt;<span class="attr">h1</span>&gt;</span>è¿™æ˜¯ä¼ é€’å…ƒç´ ç¬¬ä¸€ç§å†™æ³•props.html<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">      content=&#123;<span class="tag">&lt;<span class="name">h2</span>&gt;</span>è¿™æ˜¯ä¼ é€’çš„h2å…ƒç´ <span class="tag">&lt;/<span class="name">h2</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">      container=&#123;<span class="tag">&lt;<span class="name">h3</span>&gt;</span>è¿™æ˜¯ä¼ é€’çš„h3å…ƒç´ <span class="tag">&lt;/<span class="name">h3</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">    &gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>è¿™æ˜¯ä¼ é€’å…ƒç´ ç¬¬äºŒç§å†™æ³•props.childrençš„h1å…ƒç´ <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>è¿™æ˜¯ä¼ é€’å…ƒç´ ç¬¬äºŒç§å†™æ³•props.childrençš„h2å…ƒç´ <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Comp</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Comp</span>&gt;</span><span class="tag">&lt;/<span class="name">Comp</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> container = <span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line"></span><br><span class="line">container.<span class="title function_">render</span>(<span class="title class_">Dom</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Comp.jsx</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// import React, &#123; Component &#125; from &#x27;react&#x27;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// export default class Comp extends Component &#123;</span></span><br><span class="line"><span class="comment">//   constructor(props) &#123;</span></span><br><span class="line"><span class="comment">//     super(props);</span></span><br><span class="line"><span class="comment">//     console.log(props);</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//   render() &#123;</span></span><br><span class="line"><span class="comment">//     return &lt;div&gt;&#123;this.props.html&#125;&lt;/div&gt;;</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ç»„ä»¶å†™æ³•</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Comp</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="comment">// è¿™æ˜¯ç¬¬ä¸€ç§å†™æ³•ï¼Œå¯ä»¥ç›´æ¥å±•ç¤º</span></span><br><span class="line">  <span class="comment">//   return &lt;div&gt;&#123;props.html&#125;&lt;/div&gt;;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç¬¬äºŒç§å†™æ³•ï¼Œéœ€è¦ä½¿ç”¨props.children</span></span><br><span class="line">  <span class="comment">//   return &lt;div&gt;&#123;props.children&#125;&lt;/div&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * propså¯¹è±¡ä¸­å¯èƒ½æ˜¯ç©ºï¼Œå¯èƒ½æ˜¯æœ‰childrenæˆ–è€…å…¶ä»–è‡ªå®šä¹‰å…ƒç´ </span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> å¦‚æœä¸€ä¸ªç»„ä»¶åŒæ—¶ç”¨äº†å¤šç§æ–¹å¼ä¼ é€’ï¼Œè¿™é‡Œè¿”å›ä¸åŒæ–¹æ³•å¯¹åº”çš„å…ƒç´ </span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">DoHandleEle</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> propsValAry = <span class="title class_">Object</span>.<span class="title function_">values</span>(props).<span class="title function_">flat</span>();</span><br><span class="line">    <span class="keyword">if</span> (propsValAry &amp;&amp; propsValAry.<span class="property">length</span>) &#123;</span><br><span class="line">      <span class="comment">// å¦‚æœå­˜åœ¨å¤šä¸ªpropså¯¹è±¡ï¼Œå¾ªç¯å±•ç¤ºå†…å®¹</span></span><br><span class="line">      <span class="keyword">const</span> tempEleAry = propsValAry.<span class="title function_">map</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;item.props.children&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">return</span> tempEleAry;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ä¸¤ç§å†™æ³•éƒ½æ²¡æœ‰ä¼ é€’æ•°æ®æ˜¾ç¤ºçš„é»˜è®¤å€¼<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">DoHandleEle</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="è¡¨å•"><a href="#è¡¨å•" class="headerlink" title="è¡¨å•"></a>è¡¨å•</h2><p>å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶</p>
<h3 id="å—æ§ç»„ä»¶"><a href="#å—æ§ç»„ä»¶" class="headerlink" title="å—æ§ç»„ä»¶"></a>å—æ§ç»„ä»¶</h3><p>ç»„ä»¶çš„ä½¿ç”¨è€…ï¼Œæœ‰èƒ½åŠ›å®Œå…¨æ§åˆ¶è¯¥ç»„ä»¶çš„è¡Œä¸ºå’Œå†…å®¹ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå—æ§ç»„ä»¶å¾€å¾€æ²¡æœ‰è‡ªèº«çš„çŠ¶æ€ï¼Œå…¶å†…å®¹å®Œå…¨å—åˆ°å±æ€§çš„æ§åˆ¶ã€‚</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å—æ§ç»„ä»¶</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> <span class="attr">value</span>=<span class="string">&#123;123&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚ä¸Šé¢çš„inputç»„ä»¶ï¼Œä»–çš„å†…å®¹å—valueæ§åˆ¶</p>
<h3 id="éå—æ§ç»„ä»¶"><a href="#éå—æ§ç»„ä»¶" class="headerlink" title="éå—æ§ç»„ä»¶"></a>éå—æ§ç»„ä»¶</h3><p>ç»„ä»¶çš„ä½¿ç”¨è€…ï¼Œæ²¡æœ‰èƒ½åŠ›æ§åˆ¶è¯¥ç»„ä»¶çš„è¡Œä¸ºå’Œå†…å®¹ï¼Œç»„ä»¶çš„è¡Œä¸ºå’Œå†…å®¹å®Œå…¨è‡ªè¡Œæ§åˆ¶ã€‚</p>
<p><strong>è¡¨å•ç»„ä»¶ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯éå—æ§ç»„ä»¶ï¼Œä¸€æ—¦è®¾ç½®äº†è¡¨å•ç»„ä»¶çš„valueå±æ€§ï¼Œåˆ™å…¶å˜ä¸ºå—æ§ç»„ä»¶(å•é€‰å’Œå¤šé€‰æ¡†éœ€è¦è®¾ç½®checked)</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éå—æ§ç»„ä»¶</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç®€å•çš„è¡¨å•åº”ç”¨ï¼š"><a href="#ç®€å•çš„è¡¨å•åº”ç”¨ï¼š" class="headerlink" title="ç®€å•çš„è¡¨å•åº”ç”¨ï¼š"></a>ç®€å•çš„è¡¨å•åº”ç”¨ï¼š</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// FormItem.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">FormItem</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">loginId</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">loginPwd</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">sex</span>: <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">    <span class="attr">chooseLoves</span>: [],</span><br><span class="line">    <span class="attr">loves</span>: [</span><br><span class="line">      &#123; <span class="attr">value</span>: <span class="string">&#x27;football&#x27;</span>, <span class="attr">text</span>: <span class="string">&#x27;è¶³çƒ&#x27;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">value</span>: <span class="string">&#x27;basetball&#x27;</span>, <span class="attr">text</span>: <span class="string">&#x27;ç¯®çƒ&#x27;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">value</span>: <span class="string">&#x27;movie&#x27;</span>, <span class="attr">text</span>: <span class="string">&#x27;ç”µå½±&#x27;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">value</span>: <span class="string">&#x27;music&#x27;</span>, <span class="attr">text</span>: <span class="string">&#x27;éŸ³ä¹&#x27;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">value</span>: <span class="string">&#x27;other&#x27;</span>, <span class="attr">text</span>: <span class="string">&#x27;å…¶ä»–&#x27;</span> &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">city</span>: <span class="string">&#x27;shanghai&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * ä¿®æ”¹è¡¨å•çš„ç»Ÿä¸€å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; e è¾“å…¥äº‹ä»¶å‚æ•°</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  doHandleChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> val = e.<span class="property">target</span>.<span class="property">value</span>;</span><br><span class="line">    <span class="keyword">const</span> name = e.<span class="property">target</span>.<span class="property">name</span>;</span><br><span class="line">    <span class="keyword">if</span> (e.<span class="property">target</span>.<span class="property">type</span> === <span class="string">&#x27;checkbox&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">// å¯¹valè¿›è¡Œç‰¹æ®Šå¤šé€‰å¤„ç†</span></span><br><span class="line">      <span class="keyword">if</span> (e.<span class="property">target</span>.<span class="property">checked</span>) &#123;</span><br><span class="line">        val = [...<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">chooseLoves</span>, val];</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        val = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">chooseLoves</span>.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item !== val);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      [name]: val</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * è·å–çˆ±å¥½å¤šé€‰æ¡†</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  doGetLoveCheckbox = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> lvBox = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">loves</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">key</span>=<span class="string">&#123;item.value&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">type</span>=<span class="string">&#x27;checkbox&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">name</span>=<span class="string">&#x27;chooseLoves&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">value</span>=<span class="string">&#123;item.value&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checked</span>=<span class="string">&#123;this.state.chooseLoves.includes(item.value)&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onChange</span>=<span class="string">&#123;this.doHandleChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          /&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;item.text&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> lvBox;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> loveBox = <span class="variable language_">this</span>.<span class="title function_">doGetLoveCheckbox</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">name</span>=<span class="string">&#x27;loginId&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">value</span>=<span class="string">&#123;this.state.loginId&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onChange</span>=<span class="string">&#123;this.doHandleChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">name</span>=<span class="string">&#x27;loginPwd&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">value</span>=<span class="string">&#123;this.state.loginPwd&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onChange</span>=<span class="string">&#123;this.doHandleChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">&#x27;&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">type</span>=<span class="string">&#x27;radio&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">name</span>=<span class="string">&#x27;sex&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">value</span>=<span class="string">&#x27;male&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">checked</span>=<span class="string">&#123;this.state.sex</span> === <span class="string">&#x27;male&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">onChange</span>=<span class="string">&#123;this.doHandleChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            /&gt;</span></span></span><br><span class="line"><span class="language-xml">            ç”·</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">&#x27;&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">type</span>=<span class="string">&#x27;radio&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">name</span>=<span class="string">&#x27;sex&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">value</span>=<span class="string">&#x27;female&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">checked</span>=<span class="string">&#123;this.state.sex</span> === <span class="string">&#x27;female&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">onChange</span>=<span class="string">&#123;this.doHandleChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            /&gt;</span></span></span><br><span class="line"><span class="language-xml">            å¥³</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">select</span> <span class="attr">value</span>=<span class="string">&#123;this.state.city&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.doHandleChange&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&#x27;beijing&#x27;</span>&gt;</span>åŒ—äº¬<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&#x27;shanghai&#x27;</span>&gt;</span>ä¸Šæµ·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&#x27;nanjing&#x27;</span>&gt;</span>å—äº¬<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&#x27;suzhou&#x27;</span>&gt;</span>è‹å·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;loveBox&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              console.log(this.state);</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          &gt;</span></span><br><span class="line"><span class="language-xml">            è·å–è¡¨å•æ•°æ®</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å±æ€§é»˜è®¤å€¼å’Œç±»å‹éªŒè¯"><a href="#å±æ€§é»˜è®¤å€¼å’Œç±»å‹éªŒè¯" class="headerlink" title="å±æ€§é»˜è®¤å€¼å’Œç±»å‹éªŒè¯"></a>å±æ€§é»˜è®¤å€¼å’Œç±»å‹éªŒè¯</h2><h3 id="å±æ€§é»˜è®¤å€¼"><a href="#å±æ€§é»˜è®¤å€¼" class="headerlink" title="å±æ€§é»˜è®¤å€¼"></a>å±æ€§é»˜è®¤å€¼</h3><p>é€šè¿‡ä¸€ä¸ªé™æ€å±æ€§<code>defaultProps</code>å‘ŠçŸ¥reactå±æ€§é»˜è®¤å€¼</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">FuncDefault</span> <span class="keyword">from</span> <span class="string">&#x27;./FuncDefault&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ClassDefault</span> <span class="keyword">from</span> <span class="string">&#x27;./ClassDefault&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        å‡½æ•°ç»„ä»¶çš„å±æ€§é»˜è®¤å€¼ï¼š</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">FuncDefault</span> <span class="attr">a</span>=<span class="string">&#123;20&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        ç±»ç»„ä»¶çš„å±æ€§é»˜è®¤å€¼ï¼š</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ClassDefault</span> <span class="attr">b</span>=<span class="string">&#123;21&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ClassDefault.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">ClassDefault</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">c</span>: <span class="number">3</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(props); <span class="comment">// å·²ç»å®Œæˆæ··åˆ</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>a:&#123;this.props.a&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>b:&#123;this.props.b&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>c:&#123;this.props.c&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å±æ€§é»˜è®¤å€¼é€šç”¨å†™æ³•</span></span><br><span class="line"><span class="comment">// ClassDefault.defaultProps = &#123;</span></span><br><span class="line"><span class="comment">//   a: 1,</span></span><br><span class="line"><span class="comment">//   b: 2,</span></span><br><span class="line"><span class="comment">//   c: 3</span></span><br><span class="line"><span class="comment">// &#125;;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// FuncDefault.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">FuncDefault</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(props); <span class="comment">// å·²ç»å®Œæˆäº†æ··åˆ</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>a:&#123;props.a&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>b:&#123;props.b&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>c:&#123;props.c&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å±æ€§é»˜è®¤å€¼</span></span><br><span class="line"><span class="title class_">FuncDefault</span>.<span class="property">defaultProps</span> = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">c</span>: <span class="number">3</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h3 id="å±æ€§ç±»å‹æ£€æŸ¥"><a href="#å±æ€§ç±»å‹æ£€æŸ¥" class="headerlink" title="å±æ€§ç±»å‹æ£€æŸ¥"></a>å±æ€§ç±»å‹æ£€æŸ¥</h3><p>ä½¿ç”¨åº“ï¼š<code>prop-types</code></p>
<p>å¯¹ç»„ä»¶ä½¿ç”¨é™æ€å±æ€§<code>propTypes</code>å‘ŠçŸ¥reactå¦‚ä½•æ£€æŸ¥å±æ€§</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">PropTypes.anyï¼š//ä»»æ„ç±»å‹</span><br><span class="line">PropTypes.arrayï¼š//æ•°ç»„ç±»å‹</span><br><span class="line">PropTypes.boolï¼š//å¸ƒå°”ç±»å‹</span><br><span class="line">PropTypes.funcï¼š//å‡½æ•°ç±»å‹</span><br><span class="line">PropTypes.numberï¼š//æ•°å­—ç±»å‹</span><br><span class="line">PropTypes.objectï¼š//å¯¹è±¡ç±»å‹</span><br><span class="line">PropTypes.stringï¼š//å­—ç¬¦ä¸²ç±»å‹</span><br><span class="line">PropTypes.symbolï¼š//ç¬¦å·ç±»å‹</span><br><span class="line"></span><br><span class="line">PropTypes.nodeï¼š//ä»»ä½•å¯ä»¥è¢«æ¸²æŸ“çš„å†…å®¹ï¼Œå­—ç¬¦ä¸²ã€æ•°å­—ã€Reactå…ƒç´ </span><br><span class="line">PropTypes.elementï¼š//reactå…ƒç´ </span><br><span class="line">PropTypes.elementTypeï¼š//reactå…ƒç´ ç±»å‹</span><br><span class="line">PropTypes.instanceOf(æ„é€ å‡½æ•°)ï¼š//å¿…é¡»æ˜¯æŒ‡å®šæ„é€ å‡½æ•°çš„å®ä¾‹</span><br><span class="line">PropTypes.oneOf([xxx, xxx])ï¼š//æšä¸¾</span><br><span class="line">PropTypes.oneOfType([xxx, xxx]);  //å±æ€§ç±»å‹å¿…é¡»æ˜¯æ•°ç»„ä¸­çš„å…¶ä¸­ä¸€ä¸ª</span><br><span class="line">PropTypes.arrayOf(PropTypes.XXX)ï¼š//å¿…é¡»æ˜¯æŸä¸€ç±»å‹ç»„æˆçš„æ•°ç»„</span><br><span class="line">PropTypes.objectOf(PropTypes.XXX)ï¼š//å¯¹è±¡ç”±æŸä¸€ç±»å‹çš„å€¼ç»„æˆ</span><br><span class="line">PropTypes.shape(å¯¹è±¡): //å±æ€§å¿…é¡»æ˜¯å¯¹è±¡ï¼Œå¹¶ä¸”æ»¡è¶³æŒ‡å®šçš„å¯¹è±¡è¦æ±‚</span><br><span class="line">PropTypes.exact(&#123;...&#125;)ï¼š//å¯¹è±¡å¿…é¡»ç²¾ç¡®åŒ¹é…ä¼ é€’çš„æ•°æ®</span><br><span class="line"></span><br><span class="line">//è‡ªå®šä¹‰å±æ€§æ£€æŸ¥ï¼Œå¦‚æœæœ‰é”™è¯¯ï¼Œè¿”å›é”™è¯¯å¯¹è±¡å³å¯</span><br><span class="line">å±æ€§: function(props, propName, componentName) &#123;</span><br><span class="line">   //...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">FuncDefault</span> <span class="keyword">from</span> <span class="string">&#x27;./FuncDefault&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ClassDefault</span> <span class="keyword">from</span> <span class="string">&#x27;./ClassDefault&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ValidationComp</span>, &#123; A &#125; <span class="keyword">from</span> <span class="string">&#x27;./ValidationComp&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        å‡½æ•°ç»„ä»¶çš„å±æ€§é»˜è®¤å€¼ï¼š</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">FuncDefault</span> <span class="attr">a</span>=<span class="string">&#123;20&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        ç±»ç»„ä»¶çš„å±æ€§é»˜è®¤å€¼ï¼š</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ClassDefault</span> <span class="attr">b</span>=<span class="string">&#123;21&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        ç±»å‹æ£€æŸ¥ï¼š</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ValidationComp</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">a</span>=<span class="string">&#123;2&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">b</span>=<span class="string">&#123;false&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">c</span>=<span class="string">&#123;99&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">d</span>=<span class="string">&#123;</span>&lt;<span class="attr">input</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">          e=&#123;ClassDefault&#125;</span></span><br><span class="line"><span class="language-xml">          f=&#123;new A()&#125;</span></span><br><span class="line"><span class="language-xml">          g=&#123;&#x27;ç”·&#x27;&#125;</span></span><br><span class="line"><span class="language-xml">          h=&#123;[2]&#125;</span></span><br><span class="line"><span class="language-xml">          i=&#123;&#123;</span></span><br><span class="line"><span class="language-xml">            name: &#x27;yy&#x27;,</span></span><br><span class="line"><span class="language-xml">            age: 25,</span></span><br><span class="line"><span class="language-xml">            address: &#123;</span></span><br><span class="line"><span class="language-xml">              province: &#x27;12&#x27;</span></span><br><span class="line"><span class="language-xml">            &#125;</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          j=&#123;1&#125;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ValidationComp.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">PropTypes</span> <span class="keyword">from</span> <span class="string">&#x27;prop-types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">ValidationComp</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="comment">//   console.log(props, &#x27;validation&#x27;);</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> E = props.<span class="property">e</span>;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>a:&#123;props.a&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>b:&#123;props.b.toString()&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>c:&#123;props.c&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>d:&#123;props.d&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        e:</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">E</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>g:&#123;props.g&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>h:&#123;props.h&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>i:&#123;JSON.stringify(props.i)&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>j:&#123;props.j&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å±æ€§çš„é»˜è®¤å€¼</span></span><br><span class="line"><span class="title class_">ValidationComp</span>.<span class="property">defaultProps</span> = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">c</span>: <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å±æ€§çš„ç±»å‹æ£€éªŒ</span></span><br><span class="line"><span class="title class_">ValidationComp</span>.<span class="property">propTypes</span> = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>.<span class="property">isRequired</span>, <span class="comment">// aå¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ç±»å‹</span></span><br><span class="line">  <span class="attr">b</span>: <span class="title class_">PropTypes</span>.<span class="property">bool</span>.<span class="property">isRequired</span>, <span class="comment">// bå¿…é¡»æ˜¯ä¸€ä¸ªå¸ƒå°”ç±»å‹</span></span><br><span class="line">  <span class="attr">c</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>.<span class="property">isRequired</span>, <span class="comment">// cå¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ç±»å‹</span></span><br><span class="line">  <span class="attr">d</span>: <span class="title class_">PropTypes</span>.<span class="property">element</span>.<span class="property">isRequired</span>, <span class="comment">// då¿…é¡»æ˜¯ä¸€ä¸ªreactå…ƒç´ </span></span><br><span class="line">  <span class="attr">e</span>: <span class="title class_">PropTypes</span>.<span class="property">elementType</span>.<span class="property">isRequired</span>, <span class="comment">// eå¿…é¡»æ˜¯ä¸€ä¸ªç»„ä»¶ç±»å‹</span></span><br><span class="line">  <span class="attr">f</span>: <span class="title class_">PropTypes</span>.<span class="title function_">instanceOf</span>(A).<span class="property">isRequired</span>, <span class="comment">// få¿…é¡»æ˜¯æŒ‡å®šæ„é€ å‡½æ•°çš„å®ä¾‹</span></span><br><span class="line">  <span class="attr">g</span>: <span class="title class_">PropTypes</span>.<span class="title function_">oneOf</span>([<span class="string">&#x27;ç”·&#x27;</span>, <span class="string">&#x27;å¥³&#x27;</span>]).<span class="property">isRequired</span>, <span class="comment">// gå¿…é¡»æ˜¯å…¶ä¸­ä¹‹ä¸€</span></span><br><span class="line">  <span class="attr">h</span>: <span class="title class_">PropTypes</span>.<span class="title function_">arrayOf</span>(<span class="title class_">PropTypes</span>.<span class="property">number</span>).<span class="property">isRequired</span>, <span class="comment">// æ•°ç»„æ¯ä¸€é¡¹éœ€è¦æ»¡è¶³ç±»å‹è¦æ±‚</span></span><br><span class="line">  <span class="attr">i</span>: <span class="title class_">PropTypes</span>.<span class="title function_">shape</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>,</span><br><span class="line">    <span class="attr">address</span>: <span class="title class_">PropTypes</span>.<span class="title function_">shape</span>(&#123;</span><br><span class="line">      <span class="attr">province</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;).<span class="property">isRequired</span>, <span class="comment">// å¯¹è±¡æ¯ä¸€é¡¹éœ€è¦æ»¡è¶³ç±»å‹è¦æ±‚</span></span><br><span class="line">  <span class="attr">j</span>: <span class="keyword">function</span> (<span class="params">props, propName, componentName</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;props&#x27;</span>, props);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;propName&#x27;</span>, propName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;componentName&#x27;</span>, componentName);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> val = props[propName];</span><br><span class="line">    <span class="comment">// éªŒè¯å†…å®¹æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">    <span class="keyword">if</span> (val === <span class="literal">null</span> || val === <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Error</span>(</span><br><span class="line">        <span class="string">`invalid prop <span class="subst">$&#123;propName&#125;</span> in <span class="subst">$&#123;componentName&#125;</span>, <span class="subst">$&#123;propName&#125;</span> is required!`</span></span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éªŒè¯æ˜¯å¦æ˜¯æ•°å­—</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> val !== <span class="string">&#x27;number&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Error</span>(</span><br><span class="line">        <span class="string">`invalid prop <span class="subst">$&#123;propName&#125;</span> in <span class="subst">$&#123;componentName&#125;</span>, <span class="subst">$&#123;propName&#125;</span> is NaN!`</span></span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="HOC-é«˜é˜¶ç»„ä»¶"><a href="#HOC-é«˜é˜¶ç»„ä»¶" class="headerlink" title="HOC é«˜é˜¶ç»„ä»¶"></a>HOC é«˜é˜¶ç»„ä»¶</h2><p>HOFï¼šHigher-Order Function, é«˜é˜¶å‡½æ•°ï¼Œä»¥å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå‡½æ•°<br>HOC: Higher-Order Component, é«˜é˜¶ç»„ä»¶ï¼Œä»¥ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªç»„ä»¶</p>
<p>é€šå¸¸ï¼Œå¯ä»¥åˆ©ç”¨HOCå®ç°æ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚</p>
<blockquote>
<p>ä¸¾ä¾‹ï¼š20ä¸ªç»„ä»¶ï¼Œæ¯ä¸ªç»„ä»¶åœ¨åˆ›å»ºç»„ä»¶å’Œé”€æ¯ç»„ä»¶æ—¶ï¼Œéœ€è¦ä½œæ—¥å¿—è®°å½•<br>20ä¸ªç»„ä»¶ï¼Œå®ƒä»¬éœ€è¦æ˜¾ç¤ºä¸€äº›å†…å®¹ï¼Œå¾—åˆ°çš„æ•°æ®ç»“æ„å®Œå…¨ä¸€è‡´</p>
</blockquote>
<h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a><strong>æ³¨æ„</strong></h3><ol>
<li>ä¸è¦åœ¨renderä¸­ä½¿ç”¨é«˜é˜¶ç»„ä»¶</li>
<li>ä¸è¦åœ¨é«˜é˜¶ç»„ä»¶å†…éƒ¨æ›´æ”¹ä¼ å…¥çš„ç»„ä»¶</li>
</ol>
<h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><h4 id="è®°å½•æ—¥å¿—çš„é«˜é˜¶ç»„ä»¶withLog"><a href="#è®°å½•æ—¥å¿—çš„é«˜é˜¶ç»„ä»¶withLog" class="headerlink" title="è®°å½•æ—¥å¿—çš„é«˜é˜¶ç»„ä»¶withLog"></a>è®°å½•æ—¥å¿—çš„é«˜é˜¶ç»„ä»¶withLog</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// withLog.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¢åŠ ç»„ä»¶åˆ›å»ºé”€æ¯çš„æ—¥å¿—è®°å½•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">withLog</span>(<span class="params">Comp, str</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">class</span> <span class="title class_">LogWrapper</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`æ—¥å¿—ï¼šç»„ä»¶<span class="subst">$&#123;Comp.name&#125;</span>è¢«åˆ›å»ºäº†ï¼ <span class="subst">$&#123;<span class="built_in">Date</span>.now()&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`æ—¥å¿—ï¼šç»„ä»¶<span class="subst">$&#123;Comp.name&#125;</span>è¢«é”€æ¯äº†ï¼ <span class="subst">$&#123;<span class="built_in">Date</span>.now()&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;str&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Comp</span> &#123;<span class="attr">...this.props</span>&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ§åˆ¶ç»„ä»¶æ˜¾ç¤ºéšè—çš„é«˜é˜¶ç»„ä»¶"><a href="#æ§åˆ¶ç»„ä»¶æ˜¾ç¤ºéšè—çš„é«˜é˜¶ç»„ä»¶" class="headerlink" title="æ§åˆ¶ç»„ä»¶æ˜¾ç¤ºéšè—çš„é«˜é˜¶ç»„ä»¶"></a>æ§åˆ¶ç»„ä»¶æ˜¾ç¤ºéšè—çš„é«˜é˜¶ç»„ä»¶</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// withLogin.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ§åˆ¶ç»„ä»¶çš„æ˜¾ç¤ºéšè—</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">withLogin</span>(<span class="params">Comp</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">LoginWrapper</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœisLoginä¸ºtrueæ‰æ˜¾ç¤ºç»„ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (props.<span class="property">isLogin</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Comp</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åŠ ä¸€ä¸ªä¸‹åˆ’çº¿çš„é«˜é˜¶ç»„ä»¶"><a href="#åŠ ä¸€ä¸ªä¸‹åˆ’çº¿çš„é«˜é˜¶ç»„ä»¶" class="headerlink" title="åŠ ä¸€ä¸ªä¸‹åˆ’çº¿çš„é«˜é˜¶ç»„ä»¶"></a>åŠ ä¸€ä¸ªä¸‹åˆ’çº¿çš„é«˜é˜¶ç»„ä»¶</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// withHr.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»™ç»„ä»¶åŠ ä¸€ä¸ªä¸‹åˆ’çº¿</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">withHr</span>(<span class="params">Comp</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">HrWrapper</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Comp</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨é«˜é˜¶ç»„ä»¶åŒ…è£¹"><a href="#ä½¿ç”¨é«˜é˜¶ç»„ä»¶åŒ…è£¹" class="headerlink" title="ä½¿ç”¨é«˜é˜¶ç»„ä»¶åŒ…è£¹"></a>ä½¿ç”¨é«˜é˜¶ç»„ä»¶åŒ…è£¹</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; A, B &#125; <span class="keyword">from</span> <span class="string">&#x27;./Comps&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> withLog <span class="keyword">from</span> <span class="string">&#x27;./HOC/withLog&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> withLogin <span class="keyword">from</span> <span class="string">&#x27;./HOC/withLogin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> withHr <span class="keyword">from</span> <span class="string">&#x27;./HOC/withHr&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AComp</span> = <span class="title function_">withHr</span>(<span class="title function_">withLogin</span>(<span class="title function_">withLog</span>(A, <span class="string">&#x27;123123&#x27;</span>)));</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">BComp</span> = <span class="title function_">withHr</span>(<span class="title function_">withLogin</span>(<span class="title function_">withLog</span>(B, <span class="string">&#x27;å“¦å“¦å“¦å“¦&#x27;</span>)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">AComp</span> <span class="attr">isLogin</span> <span class="attr">a</span>=<span class="string">&#123;123&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">BComp</span> <span class="attr">isLogin</span> <span class="attr">b</span>=<span class="string">&#123;999&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Comp.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">A</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        A<span class="tag">&lt;<span class="name">p</span>&gt;</span>a:&#123;this.props.a&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        B<span class="tag">&lt;<span class="name">p</span>&gt;</span>b:&#123;this.props.b&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h2><p>reference: å¼•ç”¨ï¼Œ<strong>ä¸è¦æ»¥ç”¨</strong>ï¼Œrefç›´æ¥æ“ä½œç»„ä»¶å¯¹è±¡æˆ–çœŸå®DOMçš„ç†å¿µæ˜¯ä¸ç¬¦åˆReactç†å¿µçš„</p>
<p>å¸Œæœ›ç›´æ¥ä½¿ç”¨domå…ƒç´ ä¸­çš„æŸä¸ªæ–¹æ³•ï¼Œæˆ–è€…å¸Œæœ›ç›´æ¥ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶ä¸­çš„æŸä¸ªæ–¹æ³•</p>
<h3 id="ç±»ç»„ä»¶ä½¿ç”¨ref"><a href="#ç±»ç»„ä»¶ä½¿ç”¨ref" class="headerlink" title="ç±»ç»„ä»¶ä½¿ç”¨ref"></a>ç±»ç»„ä»¶ä½¿ç”¨ref</h3><ol>
<li>refä½œç”¨äºå†…ç½®çš„htmlç»„ä»¶ï¼Œå¾—åˆ°çš„å°†æ˜¯çœŸå®çš„domå¯¹è±¡</li>
<li>refä½œç”¨äº<strong>ç±»ç»„ä»¶</strong>ï¼Œå¾—åˆ°çš„å°†æ˜¯<strong>ç±»çš„å®ä¾‹</strong></li>
<li>ref<strong>ä¸èƒ½ä½œç”¨äºå‡½æ•°ç»„ä»¶</strong></li>
</ol>
<p>å­—ç¬¦ä¸²èµ‹å€¼çš„æ–¹å¼è¢«ç§»å‡º</p>
<p>refæ¨èä½¿ç”¨å¯¹è±¡æˆ–è€…æ˜¯å‡½æ•°</p>
<p><strong>å¯¹è±¡</strong></p>
<p>é€šè¿‡ React.createRef å‡½æ•°åˆ›å»º</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Comp</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="comment">// this.myInputRef = React.createRef();</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">myInputRef</span> = &#123;</span><br><span class="line">      <span class="attr">current</span>: <span class="literal">null</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  doHandleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">myInputRef</span>.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;this.myInputRef&#125;</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.doHandleClick&#125;</span>&gt;</span>èšç„¦<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å‡½æ•°</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Comp</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  doHandleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">myInputRef</span>.<span class="title function_">focus</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">ref</span>=<span class="string">&#123;(el)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            this.myInputRef = el;</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          type=&#x27;text&#x27;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.doHandleClick&#125;</span>&gt;</span>èšç„¦<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°å°±æ˜¯refä¸­çš„</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(el) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">myInputRef</span> = el;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°çš„è°ƒç”¨æ—¶é—´ï¼š</p>
<ol>
<li><p>componentDidMountçš„æ—¶å€™ä¼šè°ƒç”¨è¯¥å‡½æ•°</p>
<ol>
<li>åœ¨componentDidMountäº‹ä»¶ä¸­å¯ä»¥ä½¿ç”¨ref</li>
</ol>
</li>
<li><p>å¦‚æœrefçš„å€¼å‘ç”Ÿäº†å˜åŠ¨ï¼ˆæ—§çš„å‡½æ•°è¢«æ–°çš„å‡½æ•°æ›¿ä»£ï¼‰ï¼Œåˆ†åˆ«è°ƒç”¨æ—§çš„å‡½æ•°ä»¥åŠæ–°çš„å‡½æ•°ï¼Œæ—¶é—´ç‚¹å‡ºç°åœ¨componentDidUpdateä¹‹å‰</p>
<ol>
<li>æ—§çš„å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¼ é€’null</li>
<li>æ–°çš„å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¼ é€’å¯¹è±¡</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Comp</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  doHandleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">myInputRef</span>.<span class="title function_">focus</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;&#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  getInputRef = <span class="function">(<span class="params">el</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å‡½æ•°è¢«è°ƒç”¨äº†&#x27;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">myInputRef</span> = el;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;this.getInputRef&#125;</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.doHandleClick&#125;</span>&gt;</span>èšç„¦<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæå‡ºæ¥å†™ï¼Œåˆ™ä¸ä¼šå¤šæ¬¡è°ƒç”¨å‡½æ•°é‡Œé¢çš„å†…å®¹</p>
</li>
<li><p>å¦‚æœrefæ‰€åœ¨çš„ç»„ä»¶è¢«å¸è½½ï¼Œä¼šè°ƒç”¨å‡½æ•°ï¼Œelæ˜¯null</p>
</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Comp</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">isShow</span>: <span class="literal">true</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  doHandleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">myInputRef</span>.<span class="title function_">focus</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;&#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  getInputRef = <span class="function">(<span class="params">el</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å‡½æ•°è¢«è°ƒç”¨äº†&#x27;</span>, el);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">myInputRef</span> = el;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  doChangeShow = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">cur</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">isShow</span>: !cur.<span class="property">isShow</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;this.state.isShow &amp;&amp; <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;this.getInputRef&#125;</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.doHandleClick&#125;</span>&gt;</span>èšç„¦<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.doChangeShow&#125;</span>&gt;</span>æ˜¾ç¤º/éšè—<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>è°¨æ…ä½¿ç”¨ref</strong></p>
<p>èƒ½å¤Ÿä½¿ç”¨å±æ€§å’ŒçŠ¶æ€è¿›è¡Œæ§åˆ¶ï¼Œå°±ä¸è¦ä½¿ç”¨refã€‚</p>
<ol>
<li>è°ƒç”¨çœŸå®çš„DOMå¯¹è±¡ä¸­çš„æ–¹æ³•</li>
<li>æŸä¸ªæ—¶å€™éœ€è¦è°ƒç”¨ç±»ç»„ä»¶çš„æ–¹æ³•</li>
</ol>
<h3 id="å‡½æ•°ç»„ä»¶ä½¿ç”¨ref"><a href="#å‡½æ•°ç»„ä»¶ä½¿ç”¨ref" class="headerlink" title="å‡½æ•°ç»„ä»¶ä½¿ç”¨ref"></a>å‡½æ•°ç»„ä»¶ä½¿ç”¨ref</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Comp</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">doHandleClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    myInputRef.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> myInputRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;myInputRef&#125;</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;doHandleClick&#125;</span>&gt;</span>èšç„¦<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="refè½¬å‘ï¼ˆforwardRefï¼‰"><a href="#refè½¬å‘ï¼ˆforwardRefï¼‰" class="headerlink" title="refè½¬å‘ï¼ˆforwardRefï¼‰"></a>refè½¬å‘ï¼ˆforwardRefï¼‰</h2><p>forwardRefå¯ä»¥ç”¨åœ¨é«˜é˜¶ç»„ä»¶çš„refå±‚å±‚è½¬å‘ï¼Œä½¿ç»„ä»¶<strong>æœ€å¤–å±‚</strong>ä½¿ç”¨è€…å¯ä»¥é€šè¿‡æœ€å¤–å±‚çš„refè·å–åˆ°æœ€åº•å±‚çš„å…ƒç´ ï¼Œå¦‚æœä¸è½¬å‘ï¼Œæœ€å¤–å±‚çš„refåªèƒ½è·å–åˆ°ä¸‹ä¸€å±‚çš„é«˜é˜¶ç»„ä»¶çš„å…ƒç´ </p>
<p>forwardRefæ–¹æ³•ï¼š</p>
<ol>
<li>å‚æ•°ï¼Œä¼ é€’çš„æ˜¯å‡½æ•°ç»„ä»¶ï¼Œä¸èƒ½æ˜¯ç±»ç»„ä»¶ï¼Œå¹¶ä¸”ï¼Œå‡½æ•°ç»„ä»¶éœ€è¦æœ‰ç¬¬äºŒä¸ªå‚æ•°æ¥å¾—åˆ°refï¼ˆå¦‚ï¼š<code>function A(props, ref)</code>ï¼‰</li>
<li>è¿”å›å€¼ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼š<code>const NewA = React.forwardRef(A)</code></li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡½æ•°ç»„ä»¶çš„refè½¬å‘</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼ é€’çš„æ˜¯å‡½æ•°ç»„ä»¶ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°ç»„ä»¶NewA</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">NewA</span> = <span class="title class_">React</span>.<span class="title function_">forwardRef</span>(A);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params">props, ref</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span> <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span>&gt;</span>è¿™æ˜¯Aå‡½æ•°ç»„ä»¶é‡Œçš„h1å…ƒç´ <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;props.text&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Comp</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="title class_">ARef</span> = <span class="title class_">React</span>.<span class="title function_">createRef</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;componentDidMount&#x27;</span>, <span class="variable language_">this</span>.<span class="property">ARef</span>);  <span class="comment">// componentDidMount &#123;current: h1&#125;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">NewA</span> <span class="attr">ref</span>=<span class="string">&#123;this.ARef&#125;</span> <span class="attr">text</span>=<span class="string">&#123;</span>&#x27;<span class="attr">yayaya</span>&#x27;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç±»ç»„ä»¶çš„refè½¬å‘æ–¹å¼</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Comp</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="title class_">BRef</span> = <span class="title class_">React</span>.<span class="title function_">createRef</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;componentDidMount-BRef&#x27;</span>, <span class="variable language_">this</span>.<span class="property">BRef</span>);  <span class="comment">// componentDidMount &#123;current: div&#125;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">NewB</span> <span class="attr">ref</span>=<span class="string">&#123;this.BRef&#125;</span> <span class="attr">name</span>=<span class="string">&#123;</span>&#x27;<span class="attr">aiaiai</span>&#x27;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">NewB</span> = <span class="title class_">React</span>.<span class="title function_">forwardRef</span>(<span class="keyword">function</span> <span class="title function_">trans</span>(<span class="params">props, ref</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">B</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">abc</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;this.props.abc&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ç»„ä»¶B</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡è¿™ç§refè½¬å‘æ–¹æ³•ï¼Œåœ¨å¤–å±‚ç»„ä»¶å°±èƒ½é€šè¿‡refè·å–åˆ°å‡½æ•°ç»„ä»¶å†…çš„å…ƒç´ </p>
<h3 id="é«˜é˜¶ç»„ä»¶é…åˆforwardRefè½¬å‘refçš„ä½¿ç”¨"><a href="#é«˜é˜¶ç»„ä»¶é…åˆforwardRefè½¬å‘refçš„ä½¿ç”¨" class="headerlink" title="é«˜é˜¶ç»„ä»¶é…åˆforwardRefè½¬å‘refçš„ä½¿ç”¨"></a>é«˜é˜¶ç»„ä»¶é…åˆforwardRefè½¬å‘refçš„ä½¿ç”¨</h3><p>é¦–å…ˆåœ¨æœ€å¤–å±‚è°ƒç”¨çš„åœ°æ–¹åˆ›å»ºä¸€ä¸ªrefï¼š<code>const ACompRef = React.createRef();</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; A &#125; <span class="keyword">from</span> <span class="string">&#x27;./Comps&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> withLog <span class="keyword">from</span> <span class="string">&#x27;./HOC/withLog&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> withLogin <span class="keyword">from</span> <span class="string">&#x27;./HOC/withLogin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> withHr <span class="keyword">from</span> <span class="string">&#x27;./HOC/withHr&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AComp</span> = <span class="title function_">withHr</span>(<span class="title function_">withLogin</span>(<span class="title function_">withLog</span>(A, <span class="string">&#x27;123123&#x27;</span>)));</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ç»„ä»¶å†™æ³•</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title class_">ACompRef</span> = <span class="title class_">React</span>.<span class="title function_">createRef</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">doGetACompEle</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;-----App----&gt;&#x27;</span>, <span class="title class_">ACompRef</span>.<span class="property">current</span>);</span><br><span class="line">    <span class="comment">// ACompRef.current.firstChild.focus(); // å¦‚æœåœ¨æœ€åº•å±‚å°†refæ¥æ”¶äº†å¹¶æ”¾ç½®åœ¨å…ƒç´ ä¸Šï¼Œå³å¯è·å–å…ƒç´ åšé’ˆå¯¹å…ƒç´ çš„æ“ä½œ</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">AComp</span> <span class="attr">ref</span>=<span class="string">&#123;ACompRef&#125;</span> <span class="attr">isLogin</span> <span class="attr">a</span>=<span class="string">&#123;123&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;doGetACompEle&#125;</span>&gt;</span>ç‚¹å‡»è·å–ACompçš„å…ƒç´ <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç±»ç»„ä»¶å†™æ³•</span></span><br><span class="line"><span class="comment">// export default class App extends Component &#123;</span></span><br><span class="line"><span class="comment">//   componentDidMount() &#123;</span></span><br><span class="line"><span class="comment">//     console.log(&#x27;-----App----&gt;&#x27;, this.ACompRef);</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//   ACompRef = React.createRef();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//   render() &#123;</span></span><br><span class="line"><span class="comment">//     return (</span></span><br><span class="line"><span class="comment">//       &lt;div&gt;</span></span><br><span class="line"><span class="comment">//         &lt;AComp ref=&#123;this.ACompRef&#125; isLogin a=&#123;123&#125; /&gt;</span></span><br><span class="line"><span class="comment">//       &lt;/div&gt;</span></span><br><span class="line"><span class="comment">//     );</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>

<p>å› ä¸ºä¸Šé¢çš„æ ¹ç»„ä»¶æ˜¯è¢«å¤šä¸ªé«˜é˜¶ç»„ä»¶å±‚å±‚åŒ…è£¹ï¼ˆ<code>const AComp = withHr(withLogin(withLog(A, &#39;123123&#39;)));</code>ï¼‰ï¼Œæ‰€ä»¥éœ€è¦å¯¹é«˜é˜¶ç»„ä»¶é‡Œé¢è¿›è¡Œå¤„ç†ï¼Œå¯¹refè¿›è¡Œè½¬å‘</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// withLog.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¢åŠ ç»„ä»¶åˆ›å»ºé”€æ¯çš„æ—¥å¿—è®°å½•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">withLog</span>(<span class="params">Comp, str</span>) &#123;</span><br><span class="line">  <span class="keyword">class</span> <span class="title class_">LogWrapper</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`æ—¥å¿—ï¼šç»„ä»¶<span class="subst">$&#123;Comp.name&#125;</span>è¢«åˆ›å»ºäº†ï¼ <span class="subst">$&#123;<span class="built_in">Date</span>.now()&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`æ—¥å¿—ï¼šç»„ä»¶<span class="subst">$&#123;Comp.name&#125;</span>è¢«é”€æ¯äº†ï¼ <span class="subst">$&#123;<span class="built_in">Date</span>.now()&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; forwardRef, ...rest &#125; = <span class="variable language_">this</span>.<span class="property">props</span>;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;str&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Comp</span> &#123;<span class="attr">...rest</span>&#125; <span class="attr">ref</span>=<span class="string">&#123;forwardRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title class_">NewLogWrapper</span> = <span class="title class_">React</span>.<span class="title function_">forwardRef</span>(<span class="keyword">function</span> <span class="title function_">transformRef</span>(<span class="params">props, ref</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">LogWrapper</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">forwardRef</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span>;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">NewLogWrapper</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// withLogin.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ§åˆ¶ç»„ä»¶çš„æ˜¾ç¤ºéšè—</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">withLogin</span>(<span class="params">Comp</span>) &#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">LoginWrapper</span>(<span class="params">props, ref</span>) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœisLoginä¸ºtrueæ‰æ˜¾ç¤ºç»„ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (props.<span class="property">isLogin</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Comp</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title class_">NewLoginWrapper</span> = <span class="title class_">React</span>.<span class="title function_">forwardRef</span>(<span class="title class_">LoginWrapper</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">NewLoginWrapper</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// withHr.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»™ç»„ä»¶åŠ ä¸€ä¸ªä¸‹åˆ’çº¿</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">withHr</span>(<span class="params">Comp</span>) &#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">HrWrapper</span>(<span class="params">props, ref</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Comp</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title class_">NewHrWrapper</span> = <span class="title class_">React</span>.<span class="title function_">forwardRef</span>(<span class="title class_">HrWrapper</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">NewHrWrapper</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æ˜¯åˆ†åˆ«æ˜¯å¯¹å‡½æ•°ç»„ä»¶å’Œç±»ç»„ä»¶ä¸åŒå†™æ³•çš„å¤„ç†</p>
<p>åˆ°è¿™é‡Œï¼Œåœ¨App.jsxé‡Œçš„<code>ACompRef</code>å·²ç»å¯ä»¥è·å–åˆ°å±‚å±‚è½¬å‘åˆ°æ ¹ç»„ä»¶çš„Aï¼›(<code>ACompRef: &#123;current: A&#125;</code>)</p>
<p>æ­¤æ—¶çš„æ ¹ç»„ä»¶æ˜¯å¦‚ä¸‹çš„ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Comp.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™ç§å†™æ³•æ²¡æœ‰å†å°†åº•å±‚ç»„ä»¶é…ç½®refäº†ï¼Œåœ¨æœ€å¤–å±‚è°ƒç”¨çš„æ—¶å€™åªä¼šè·å–åˆ°è¿™ä¸ªAè¿™ä¸ªç±»çš„å„ä¸ªå±æ€§</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">A</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> /&gt;</span>A<span class="tag">&lt;<span class="name">p</span>&gt;</span>a:&#123;this.props.a&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœŸæœ›è¿˜èƒ½è·å–åˆ°Aç»„ä»¶é‡Œé¢çš„å…ƒç´ ï¼Œå¹¶å¯¹æ ¹ç»„ä»¶å†…éƒ¨çš„å…ƒç´ è¿›è¡Œæ“ä½œï¼Œé‚£ä¹ˆåœ¨æ ¹ç»„ä»¶å†…è¿˜éœ€è¦è¿›è¡Œrefçš„æŒ‚è½½ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Comp.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™ç§å†™æ³•ï¼Œåœ¨æœ€åº•å±‚çš„è¿™é‡Œï¼Œè¿˜å°†refæ”¾åˆ°æ ¹çˆ¶å…ƒç´ ä¸Šï¼Œæœ€å¤–å±‚è°ƒç”¨çš„æ—¶å€™ï¼Œå¯ä»¥ç»§ç»­æ“ä½œè¿™é‡Œé¢çš„DOM</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OriginA</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;this.props.forwardRef&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> /&gt;</span>A<span class="tag">&lt;<span class="name">p</span>&gt;</span>a:&#123;this.props.a&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">NewA</span> = <span class="title class_">React</span>.<span class="title function_">forwardRef</span>(<span class="keyword">function</span> <span class="title function_">transformARef</span>(<span class="params">props, ref</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">OriginA</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">forwardRef</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> &#123; <span class="title class_">NewA</span> <span class="keyword">as</span> A &#125;;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·çš„è¯åœ¨æœ€å¤–å±‚ç»„ä»¶ï¼ˆApp.jsxï¼‰ï¼Œå¯ä»¥æ“ä½œ<code>ACompRef.current</code>è·å–åˆ°divåŠå…¶å­å…ƒç´ ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ“ä½œï¼Œå¦‚<code>ACompRef.current.firstChild.focus()</code>ç‚¹å‡»åè¾“å…¥æ¡†å®ç°èšç„¦ç­‰æ“ä½œã€‚</p>
<p>è¯¦ç»†æ“ä½œï¼Œå¦‚éœ€å›å¿†ï¼Œä»£ç åœ¨<a target="_blank" rel="noopener" href="https://github.com/airLatus/react-learn.git">github</a>çš„â€œforwardRefåœ¨é«˜é˜¶ç»„ä»¶ä¸Šçš„åº”ç”¨â€åˆ†æ”¯ä¸Š</p>
<h2 id="Contextä¸Šä¸‹æ–‡"><a href="#Contextä¸Šä¸‹æ–‡" class="headerlink" title="Contextä¸Šä¸‹æ–‡"></a>Contextä¸Šä¸‹æ–‡</h2><p>ä¸Šä¸‹æ–‡ï¼šContextï¼Œè¡¨ç¤ºåšæŸä¸€äº›äº‹æƒ…çš„ç¯å¢ƒ</p>
<p>Reactä¸­çš„ä¸Šä¸‹æ–‡ç‰¹ç‚¹ï¼š</p>
<ol>
<li>å½“æŸä¸ªç»„ä»¶åˆ›å»ºäº†ä¸Šä¸‹æ–‡åï¼Œä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®ï¼Œä¼šè¢«æ‰€æœ‰åä»£ç»„ä»¶å…±äº«</li>
<li>å¦‚æœæŸä¸ªç»„ä»¶ä¾èµ–äº†ä¸Šä¸‹æ–‡ï¼Œä¼šå¯¼è‡´è¯¥ç»„ä»¶ä¸å†çº¯ç²¹ï¼ˆå¤–éƒ¨æ•°æ®ä»…æ¥æºäºå±æ€§propsï¼‰</li>
<li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç”¨äºç¬¬ä¸‰æ–¹ç»„ä»¶ï¼ˆé€šç”¨ç»„ä»¶ï¼‰</li>
</ol>
<h3 id="æ—§çš„APIï¼ˆReact16å‰-ï¼‰"><a href="#æ—§çš„APIï¼ˆReact16å‰-ï¼‰" class="headerlink" title="æ—§çš„APIï¼ˆReact16å‰  ï¼‰"></a>æ—§çš„APIï¼ˆReact16å‰  ï¼‰</h3><p><strong>åˆ›å»ºä¸Šä¸‹æ–‡</strong></p>
<p>åªæœ‰ç±»ç»„ä»¶æ‰å¯ä»¥åˆ›å»ºä¸Šä¸‹æ–‡</p>
<ol>
<li>ç»™ç±»ç»„ä»¶ä¹¦å†™é™æ€å±æ€§ childContextTypesï¼Œä½¿ç”¨è¯¥å±æ€§å¯¹ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®ç±»å‹è¿›è¡Œçº¦æŸ</li>
<li>æ·»åŠ å®ä¾‹æ–¹æ³• getChildContextï¼Œè¯¥æ–¹æ³•è¿”å›çš„å¯¹è±¡ï¼Œå³ä¸ºä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®ï¼Œè¯¥æ•°æ®å¿…é¡»æ»¡è¶³ç±»å‹çº¦æŸï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ¯æ¬¡renderä¹‹åè¿è¡Œã€‚</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">PropTypes</span> <span class="keyword">from</span> <span class="string">&#x27;prop-types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">OldContext</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * çº¦æŸä¸Šä¸‹æ–‡ä¸­æ•°æ®çš„ç±»å‹</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> childContextTypes = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>,</span><br><span class="line">    <span class="attr">b</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å¾—åˆ°ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">getChildContext</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è·å–ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">a</span>: <span class="number">123</span>,</span><br><span class="line">      <span class="attr">b</span>: <span class="string">&#x27;mikasa&#x27;</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®</strong></p>
<p>è¦æ±‚ï¼šå¦‚æœè¦ä½¿ç”¨ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®ï¼Œç»„ä»¶å¿…é¡»æœ‰ä¸€ä¸ªé™æ€å±æ€§ contextTypesï¼Œè¯¥å±æ€§æè¿°äº†éœ€è¦è·å–çš„ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®ç±»å‹</p>
<ol>
<li>å¯ä»¥åœ¨ç»„ä»¶çš„æ„é€ å‡½æ•°ä¸­ï¼Œé€šè¿‡ç¬¬äºŒä¸ªå‚æ•°ï¼Œè·å–ä¸Šä¸‹æ–‡æ•°æ®</li>
<li><strong>ä»ç»„ä»¶çš„contextå±æ€§ä¸­è·å–</strong>(18å·²ç»å¼ƒç”¨)</li>
<li>åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œé€šè¿‡ç¬¬äºŒä¸ªå‚æ•°ï¼Œè·å–ä¸Šä¸‹æ–‡æ•°æ®</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">PropTypes</span> <span class="keyword">from</span> <span class="string">&#x27;prop-types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> types = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ChildA</span>(<span class="params">props, context</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ChildA</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>a:&#123;context.a&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>b:&#123;context.b&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>c:&#123;context.c&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ChildB</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">ChildA</span>.<span class="property">contextTypes</span> = &#123; ...types, <span class="attr">c</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ChildB</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; props ä¼ å…¥çš„å±æ€§</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; context ä½¿ç”¨çš„ä¸Šä¸‹æ–‡</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props, context</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;context&#x27;</span>, context);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å£°æ˜éœ€è¦ä½¿ç”¨å“ªäº›ä¸Šä¸‹æ–‡æ•°æ®</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> contextTypes = types;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ChildB</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸Šä¸‹æ–‡çš„a:&#123;this.context.a&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸Šä¸‹æ–‡çš„b:&#123;this.context.b&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">OldContext</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * çº¦æŸä¸Šä¸‹æ–‡ä¸­æ•°æ®çš„ç±»å‹</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> childContextTypes = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>,</span><br><span class="line">    <span class="attr">b</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span>,</span><br><span class="line">    <span class="attr">c</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å¾—åˆ°ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">getChildContext</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">a</span>: <span class="number">123</span>,</span><br><span class="line">      <span class="attr">b</span>: <span class="string">&#x27;mikasa&#x27;</span>,</span><br><span class="line">      <span class="attr">c</span>: <span class="string">&#x27;yaeger&#x27;</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ChildA</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸Šä¸‹æ–‡çš„æ•°æ®å˜åŒ–</strong></p>
<p>ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®ä¸å¯ä»¥ç›´æ¥å˜åŒ–ï¼Œæœ€ç»ˆéƒ½æ˜¯é€šè¿‡çŠ¶æ€æ”¹å˜</p>
<p>åœ¨ä¸Šä¸‹æ–‡ä¸­åŠ å…¥ä¸€ä¸ªå¤„ç†å‡½æ•°ï¼Œå¯ä»¥ç”¨äºåä»£ç»„ä»¶æ›´æ”¹ä¸Šä¸‹æ–‡çš„æ•°æ®</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">PropTypes</span> <span class="keyword">from</span> <span class="string">&#x27;prop-types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> types = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span>,</span><br><span class="line">  <span class="attr">changeFunc</span>: <span class="title class_">PropTypes</span>.<span class="property">func</span>.<span class="property">isRequired</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ChildA</span>(<span class="params">props, context</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ChildA</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>a:&#123;context.a&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>b:&#123;context.b&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>c:&#123;context.c&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ChildB</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">ChildA</span>.<span class="property">contextTypes</span> = &#123; ...types, <span class="attr">c</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ChildB</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; props ä¼ å…¥çš„å±æ€§</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; context ä½¿ç”¨çš„ä¸Šä¸‹æ–‡</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props, context</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;context&#x27;</span>, context);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å£°æ˜éœ€è¦ä½¿ç”¨å“ªäº›ä¸Šä¸‹æ–‡æ•°æ®</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> contextTypes = types;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ChildB</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸Šä¸‹æ–‡çš„a:&#123;this.context.a&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸Šä¸‹æ–‡çš„b:&#123;this.context.b&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              this.context.changeFunc(this.context.a - 2);</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          &gt;</span></span><br><span class="line"><span class="language-xml">            a-2</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">OldContext</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * çº¦æŸä¸Šä¸‹æ–‡ä¸­æ•°æ®çš„ç±»å‹</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> childContextTypes = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>,</span><br><span class="line">    <span class="attr">b</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span>,</span><br><span class="line">    <span class="attr">c</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span>,</span><br><span class="line">    <span class="attr">changeFunc</span>: <span class="title class_">PropTypes</span>.<span class="property">func</span>.<span class="property">isRequired</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">122</span>,</span><br><span class="line">    <span class="attr">b</span>: <span class="string">&#x27;mikasa&#x27;</span>,</span><br><span class="line">    <span class="attr">c</span>: <span class="string">&#x27;yaeger&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å¾—åˆ°ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">getChildContext</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å±æ€§æˆ–è€…çŠ¶æ€å˜åŒ–ï¼Œé‡æ–°è·å–æ–°çš„ä¸Šä¸‹æ–‡æ•°æ®&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">a</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">a</span>,</span><br><span class="line">      <span class="attr">b</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">b</span>,</span><br><span class="line">      <span class="attr">c</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">c</span>,</span><br><span class="line">      <span class="attr">changeFunc</span>: <span class="variable language_">this</span>.<span class="property">doSolveA</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æä¾›ä¸€ä¸ªæ–¹æ³•ä¾›å­ç»„ä»¶å»æ“ä½œ</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  doSolveA = <span class="function">(<span class="params">numebr</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">cur</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">a</span>: numebr</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æä¾›ä¸Šä¸‹æ–‡çš„ç»„ä»¶è‡ªèº«çš„æ•°æ®å¤„ç†æ–¹æ³•</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  doHandleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">cur</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">a</span>: cur.<span class="property">a</span> + <span class="number">1</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ChildA</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.doHandleClick&#125;</span>&gt;</span>a+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ–°ç‰ˆAPI"><a href="#æ–°ç‰ˆAPI" class="headerlink" title="æ–°ç‰ˆAPI"></a>æ–°ç‰ˆAPI</h3><p>æ—§ç‰ˆAPIå­˜åœ¨ä¸¥é‡çš„æ•ˆç‡é—®é¢˜ï¼Œå¹¶ä¸”å®¹æ˜“å¯¼è‡´æ»¥ç”¨</p>
<p><strong>åˆ›å»ºä¸Šä¸‹æ–‡</strong></p>
<p>ä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ªç‹¬ç«‹äºç»„ä»¶çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡é€šè¿‡React.createContext(é»˜è®¤å€¼)åˆ›å»º</p>
<p>è¿”å›çš„æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡</p>
<ol>
<li>Providerå±æ€§ï¼šç”Ÿäº§è€…ã€‚ä¸€ä¸ªç»„ä»¶ï¼Œè¯¥ç»„ä»¶ä¼šåˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œè¯¥ç»„ä»¶æœ‰ä¸€ä¸ªvalueå±æ€§ï¼Œé€šè¿‡è¯¥å±æ€§ï¼Œå¯ä»¥ä¸ºå…¶æ•°æ®èµ‹å€¼<ol>
<li><strong>åŒä¸€ä¸ªProviderï¼Œä¸è¦ç”¨åˆ°å¤šä¸ªç»„ä»¶ä¸­ï¼Œå¦‚æœéœ€è¦åœ¨å…¶ä»–ç»„ä»¶ä¸­ä½¿ç”¨è¯¥æ•°æ®ï¼Œåº”è¯¥è€ƒè™‘å°†æ•°æ®æå‡åˆ°æ›´é«˜çš„å±‚æ¬¡</strong></li>
</ol>
</li>
<li>Consumerå±æ€§</li>
</ol>
<p><strong>ä½¿ç”¨ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®</strong></p>
<ol>
<li><p>åœ¨ç±»ç»„ä»¶ä¸­ï¼Œç›´æ¥ä½¿ç”¨this.contextè·å–ä¸Šä¸‹æ–‡æ•°æ®</p>
<ol>
<li>è¦æ±‚ï¼šå¿…é¡»æ‹¥æœ‰é™æ€å±æ€§ <code>contextType</code> , åº”èµ‹å€¼ä¸ºåˆ›å»ºçš„ä¸Šä¸‹æ–‡å¯¹è±¡</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ChildB</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> contextType = ctx;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ChildB</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸Šä¸‹æ–‡çš„name:&#123;this.context.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸Šä¸‹æ–‡çš„age:&#123;this.context.age&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              this.context.changeFunc(this.context.a - 2);</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          &gt;</span></span><br><span class="line"><span class="language-xml">            a-2</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œéœ€è¦ä½¿ç”¨Consumeræ¥è·å–ä¸Šä¸‹æ–‡æ•°æ®</p>
<ol>
<li>Consumeræ˜¯ä¸€ä¸ªç»„ä»¶</li>
<li>å®ƒçš„å­èŠ‚ç‚¹ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°ï¼ˆå®ƒçš„props.childrenéœ€è¦ä¼ é€’ä¸€ä¸ªå‡½æ•°ï¼‰</li>
</ol>
</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ctx = <span class="title class_">React</span>.<span class="title function_">createContext</span>();</span><br><span class="line"><span class="keyword">const</span> ctx2 = <span class="title class_">React</span>.<span class="title function_">createContext</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ChildA</span>(<span class="params">props, context</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ctx2.Provider</span> <span class="attr">value</span>=<span class="string">&#123;&#123;</span> <span class="attr">newWorld:</span> &#x27;<span class="attr">outer</span>&#x27;, <span class="attr">countryNum:</span> <span class="attr">99</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ChildA</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">ctx.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              &#123;(value) =&gt; (</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>name:&#123;value.name&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>age:&#123;value.age&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                      value.changeAge(value.age * 2);</span></span><br><span class="line"><span class="language-xml">                    &#125;&#125;</span></span><br><span class="line"><span class="language-xml">                  &gt;</span></span><br><span class="line"><span class="language-xml">                    åä»£ç»„ä»¶æŒ‰é’®age*2</span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/&gt;</span></span></span><br><span class="line"><span class="language-xml">              )&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">ctx.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">ChildB</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ctx2.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ChildB</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> contextType = ctx; <span class="comment">// å¤šä¸ªä¸Šä¸‹æ–‡ä¸èƒ½ç”¨è¿™ä¸ªå†™ï¼Œéœ€è¦ç”¨ctx.Consumer</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ctx2.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;(value) =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                ChildB</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸Šä¸‹æ–‡çš„name:&#123;this.context.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸Šä¸‹æ–‡çš„age:&#123;this.context.age&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                  <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                    this.context.changeAge(this.context.age - 2);</span></span><br><span class="line"><span class="language-xml">                  &#125;&#125;</span></span><br><span class="line"><span class="language-xml">                &gt;</span></span><br><span class="line"><span class="language-xml">                  åä»£ç»„ä»¶æŒ‰é’®age-2</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">div</span>&gt;</span>ChildA-NewWorld:&#123;value.newWorld&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">div</span>&gt;</span>ChildA-countryNum:&#123;value.countryNum&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/&gt;</span></span></span><br><span class="line"><span class="language-xml">          )&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ctx2.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">NewContext</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;yaeger&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">19</span>,</span><br><span class="line">    <span class="attr">changeAge</span>: <span class="function">(<span class="params">numebr</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">cur</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">age</span>: numebr</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æä¾›ä¸Šä¸‹æ–‡çš„ç»„ä»¶è‡ªèº«çš„æ•°æ®å¤„ç†æ–¹æ³•</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  doHandleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">cur</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">age</span>: cur.<span class="property">age</span> + <span class="number">1</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">ctx.Provider</span> <span class="attr">value</span>=<span class="string">&#123;this.state&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ChildA</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.doHandleClick&#125;</span>&gt;</span>çˆ¶ç»„ä»¶æŒ‰é’®age+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ctx.Provider</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><strong>æ³¨æ„ç»†èŠ‚</strong></p>
<p>å¦‚æœï¼Œä¸Šä¸‹æ–‡æä¾›è€…ï¼ˆContext.Providerï¼‰ä¸­çš„valueå±æ€§å‘ç”Ÿå˜åŒ–(Object.isæ¯”è¾ƒ)ï¼Œä¼šå¯¼è‡´è¯¥ä¸Šä¸‹æ–‡æä¾›çš„æ‰€æœ‰åä»£å…ƒç´ å…¨éƒ¨é‡æ–°æ¸²æŸ“ï¼Œæ— è®ºè¯¥å­å…ƒç´ æ˜¯å¦æœ‰ä¼˜åŒ–ï¼ˆæ— è®ºshouldComponentUpdateå‡½æ•°è¿”å›ä»€ä¹ˆç»“æœï¼‰</p>
<h2 id="PureComponent"><a href="#PureComponent" class="headerlink" title="PureComponent"></a>PureComponent</h2><p>çº¯ç»„ä»¶ï¼Œé¿å…ä¸å¿…è¦æ¸²æŸ“ï¼ˆrenderå‡½æ•°çš„è¿è¡Œï¼‰ï¼Œä»è€Œæé«˜æ•ˆç‡</p>
<p>æ¯”å¦‚ï¼Œæœ‰ä¸€ä¸ªä»»åŠ¡åˆ—è¡¨ï¼Œé‡Œé¢æœ‰åæ¡ä»»åŠ¡ï¼Œç‚¹å‡»æŒ‰é’®æ·»åŠ ä¸€æ¡æ–°çš„ä»»åŠ¡ï¼Œç‚¹å‡»æŒ‰é’®æ·»åŠ æ–°çš„ä»»åŠ¡æ—¶ï¼Œæ•´ä½“é¡µé¢å…³è”çš„ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“ï¼Œå…¶å®åªéœ€è¦æ¸²æŸ“æ–°æ·»åŠ çš„å°±å¯ä»¥äº†</p>
<p>ä¼˜åŒ–ï¼šå¦‚æœä¸€ä¸ªç»„ä»¶çš„å±æ€§å’ŒçŠ¶æ€éƒ½æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¸è¿›è¡Œé‡æ–°æ¸²æŸ“</p>
<p>æ¯”å¦‚å¯ä»¥åœ¨<code>shouldComponentUpdate</code>ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­ï¼Œå¯¹å±æ€§å’ŒçŠ¶æ€åšåˆ¤æ–­æ¥å†³å®šæ˜¯å¦é‡æ–°æ¸²æŸ“</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æµ…æ¯”è¾ƒ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ObjEqual</span>(<span class="params">obj1, obj2</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> prop <span class="keyword">in</span> obj1) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">Object</span>.<span class="title function_">is</span>(obj1[prop], obj2[prop])) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">shouldComponentUpdate</span>(<span class="params">nextProps, nextState</span>) &#123;</span><br><span class="line">  <span class="comment">// åˆ¤æ–­å±æ€§å’ŒçŠ¶æ€æ˜¯å¦å’Œå˜åŒ–å‰ä¸€æ ·ï¼Œä¸€æ ·åˆ™ä¸é‡æ–°æ¸²æŸ“</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">ObjEqual</span>(<span class="variable language_">this</span>.<span class="property">props</span>, nextProps) &amp;&amp; <span class="title class_">ObjEqual</span>(<span class="variable language_">this</span>.<span class="property">state</span>, nextState)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é™¤æ­¤ä¹‹å¤–ï¼Œå¯ä»¥ä½¿ç”¨<code>PureComponent</code></p>
<p><code>PureComponent</code>æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œå¦‚æœæŸä¸ªç»„ä»¶ç»§æ‰¿è‡ªè¯¥ç»„ä»¶ï¼Œåˆ™è¯¥ç»„ä»¶çš„<code>shouldComponentUpdate</code>ä¼šè¿›è¡Œä¼˜åŒ–ï¼Œå¯¹å±æ€§å’ŒçŠ¶æ€è¿›è¡Œæµ…æ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰åˆ™ä¸ä¼šé‡æ–°æ¸²æŸ“ã€‚</p>
<h3 id="ä½¿ç”¨PureComponentæ³¨æ„"><a href="#ä½¿ç”¨PureComponentæ³¨æ„" class="headerlink" title="ä½¿ç”¨PureComponentæ³¨æ„"></a>ä½¿ç”¨PureComponentæ³¨æ„</h3><p>1ã€<code>PureComponent</code>åªæ˜¯è¿›è¡Œçš„æ˜¯æµ…æ¯”è¾ƒï¼Œå¯èƒ½å‡ºç°æ”¹åŠ¨ä¹‹å‰çš„æ•°ç»„ï¼Œå¹¶æ²¡æœ‰å‘ç”Ÿé‡æ–°æ¸²æŸ“ï¼Œå› ä¸ºï¼Œæ”¹åŠ¨ä¹‹å‰çš„æ•°ç»„ï¼Œä»–çš„åœ°å€æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œæµ…æ¯”è¾ƒæ— æ³•è¯†åˆ«ï¼Œæ¯”å¦‚ä½¿ç”¨ary.push({â€¦})ï¼Œè¿™ç§å¯èƒ½å°±æ— æ³•è¯†åˆ«å˜åŒ–ï¼Œå¯ä»¥æ”¹ä¸ºä½¿ç”¨ary.concat({â€¦})ï¼Œæˆ–è€…åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„</p>
<p>1-1ã€ä¸ºäº†æ•ˆç‡ï¼Œåº”è¯¥å°½é‡ä½¿ç”¨<code>PrueComponent</code></p>
<p>1-2ã€è¦æ±‚ä¸è¦æ”¹åŠ¨ä¹‹å‰çš„çŠ¶æ€ï¼Œæ°¸è¿œæ˜¯åˆ›å»ºæ–°çš„çŠ¶æ€è¦†ç›–ä¹‹å‰çš„çŠ¶æ€</p>
<p>1-3ã€æœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹JSåº“ï¼Œ<code>Immutable.js</code>ï¼Œå®ƒä¸“é—¨ç”¨äºåˆ¶ä½œä¸å¯å˜å¯¹è±¡</p>
<p>2ã€å‡½æ•°ç»„ä»¶ä½¿ç”¨<code>React.memo</code>åˆ›å»ºå‡½æ•°</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡½æ•°ç»„ä»¶å†™æ³•</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Task</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Task Render - lv3&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">className</span>=<span class="string">&#123;props.isFinish</span> ? &#x27;<span class="attr">finish</span>&#x27; <span class="attr">:</span> &#x27;&#x27;&#125;&gt;</span>&#123;props.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Task</span>.<span class="property">propTypes</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span>,</span><br><span class="line">  <span class="attr">isFinish</span>: <span class="title class_">PropTypes</span>.<span class="property">bool</span>.<span class="property">isRequired</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">React</span>.<span class="title function_">memo</span>(<span class="title class_">Task</span>);</span><br></pre></td></tr></table></figure>



<h2 id="render-props"><a href="#render-props" class="headerlink" title="render props"></a>render props</h2><p>æœ‰æ—¶å€™ï¼ŒæŸäº›ç»„ä»¶çš„å„ç§åŠŸèƒ½åŠå…¶å¤„ç†é€»è¾‘å‡ ä¹å®Œå…¨ç›¸åŒï¼Œåªæ˜¯æ˜¾ç¤ºçš„ç•Œé¢ä¸ä¸€æ ·ï¼Œå»ºè®®ä¸‹é¢çš„æ–¹å¼è®¤é€‰å…¶ä¸€æ¥è§£å†³é‡å¤ä»£ç çš„é—®é¢˜ï¼ˆæ¨ªåˆ‡å…³æ³¨ç‚¹ï¼‰</p>
<ol>
<li>render props<ol>
<li>æŸä¸ªç»„ä»¶ï¼Œéœ€è¦æŸä¸ªå±æ€§</li>
<li>è¯¥å±æ€§æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°çš„è¿”å›å€¼ç”¨äºæ¸²æŸ“</li>
<li>å‡½æ•°çš„å‚æ•°ä¼šä¼ é€’ä¸ºéœ€è¦çš„æ•°æ®</li>
<li>æ³¨æ„çº¯ç»„ä»¶çš„å±æ€§ï¼ˆå°½é‡é¿å…æ¯æ¬¡ä¼ é€’çš„render propsçš„åœ°å€ä¸ä¸€è‡´ï¼‰</li>
<li>é€šå¸¸è¯¥å±æ€§çš„åå­—å«åšrender</li>
</ol>
</li>
<li>HOCé«˜é˜¶ç»„ä»¶</li>
</ol>
<h2 id="Portals"><a href="#Portals" class="headerlink" title="Portals"></a>Portals</h2><p>æ’æ§½ï¼šå°†ä¸€ä¸ªReactå…ƒç´ æ¸²æŸ“åˆ°æŒ‡å®šçš„DOMå®¹å™¨ä¸­</p>
<p>ReactDOM.createPortal(Reactå…ƒç´ , çœŸå®çš„DOMå®¹å™¨)ï¼Œè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªReactå…ƒç´ </p>
<p><strong>æ³¨æ„äº‹ä»¶å†’æ³¡</strong></p>
<ol>
<li>Reactä¸­çš„äº‹ä»¶æ˜¯åŒ…è£…è¿‡çš„</li>
<li>å®ƒçš„äº‹ä»¶å†’æ³¡æ˜¯æ ¹æ®è™šæ‹ŸDOMæ ‘æ¥å†’æ³¡çš„ï¼Œä¸çœŸå®çš„DOMæ ‘æ— å…³ã€‚<ol>
<li>é€šè¿‡æµè§ˆå™¨ReactDevToolè°ƒè¯•å¯ä»¥çœ‹åˆ°è™šæ‹ŸDOMä»ç„¶è¿˜æ˜¯å‘ˆæ ‘ç»“æ„ï¼Œå°½ç®¡åœ¨æ§åˆ¶å°Elementsä¸­çœ‹çœŸå®DOMå¯èƒ½åœ¨ä¸åŒæ ‘ç»“æ„ä¸Šäº†ï¼Œä½†æ˜¯äº‹ä»¶å†’æ³¡ä»ç„¶è¿˜æ˜¯æ ¹æ®è™šæ‹ŸDOMçš„ç»“æ„ã€‚</li>
</ol>
</li>
</ol>
<h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ChildA</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">ReactDOM</span>.<span class="title function_">createPortal</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;child-a&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> &#x27;<span class="attr">margin-top</span>&#x27;<span class="attr">:</span> &#x27;<span class="attr">200px</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>ChildA <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ChildB</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>,</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.modal&#x27;</span>)</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ChildB</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;child-b&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>ChildB <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;app&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>App<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ChildA</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ReactDOM.createPortalå°†ChildAæ’åˆ°.modalå…ƒç´ ä¸‹ï¼ŒçœŸå®DOMå’Œè™šæ‹ŸDOMç»“æ„ä¸åŒï¼Œå‘ˆç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Elementsä¸­çš„çœŸå®DOMç»“æ„å¦‚ä¸‹</span></span><br><span class="line">&lt;div id=<span class="string">&quot;root&quot;</span>&gt;</span><br><span class="line">	<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">h1</span>&gt;</span>App<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child-a&quot;</span> <span class="attr">style</span>=<span class="string">&quot;margin-top: 200px;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>ChildA <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child-b&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>ChildB <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ReactDevToolçš„è™šæ‹ŸDOMç»“æ„å¦‚ä¸‹</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">h1</span>&gt;</span>App<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child-a&quot;</span> <span class="attr">style</span>=<span class="string">&quot;margin-top: 200px;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>ChildA <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child-b&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>ChildB <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>



<h2 id="é”™è¯¯è¾¹ç•Œ"><a href="#é”™è¯¯è¾¹ç•Œ" class="headerlink" title="é”™è¯¯è¾¹ç•Œ"></a>é”™è¯¯è¾¹ç•Œ</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè‹¥ä¸€ä¸ªç»„ä»¶åœ¨<strong>æ¸²æŸ“æœŸé—´</strong>ï¼ˆrenderï¼‰å‘ç”Ÿé”™è¯¯ï¼Œä¼šå¯¼è‡´æ•´ä¸ªç»„ä»¶æ ‘å…¨éƒ¨è¢«å¸è½½</p>
<p>é”™è¯¯è¾¹ç•Œï¼šæ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œè¯¥ç»„ä»¶ä¼šæ•è·åˆ°<strong>æ¸²æŸ“æœŸé—´ï¼ˆrenderï¼‰</strong>å­ç»„ä»¶å‘ç”Ÿçš„é”™è¯¯ï¼Œå¹¶æœ‰èƒ½åŠ›é˜»æ­¢é”™è¯¯ç»§ç»­ä¼ æ’­</p>
<h3 id="è®©æŸä¸ªç»„ä»¶æ•è·é”™è¯¯"><a href="#è®©æŸä¸ªç»„ä»¶æ•è·é”™è¯¯" class="headerlink" title="è®©æŸä¸ªç»„ä»¶æ•è·é”™è¯¯"></a><strong>è®©æŸä¸ªç»„ä»¶æ•è·é”™è¯¯</strong></h3><ol>
<li><p>ç¼–å†™ç”Ÿå‘½å‘¨æœŸå‡½æ•° getDerivedStateFromError</p>
<ol>
<li>é™æ€å‡½æ•°</li>
<li>è¿è¡Œæ—¶é—´ç‚¹ï¼šæ¸²æŸ“å­ç»„ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç”Ÿé”™è¯¯ä¹‹åï¼Œåœ¨æ›´æ–°é¡µé¢ä¹‹å‰</li>
<li><strong>æ³¨æ„ï¼šåªæœ‰å­ç»„ä»¶å‘ç”Ÿé”™è¯¯ï¼Œæ‰ä¼šè¿è¡Œè¯¥å‡½æ•°</strong>ï¼Œè‡ªèº«ç»„ä»¶å‘ç”Ÿé”™è¯¯ä¸ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°</li>
<li>è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒReactä¼šå°†è¯¥å¯¹è±¡çš„å±æ€§è¦†ç›–æ‰å½“å‰ç»„ä»¶çš„state</li>
<li>å‚æ•°ï¼šé”™è¯¯å¯¹è±¡</li>
<li>é€šå¸¸ï¼Œè¯¥å‡½æ•°ç”¨äºæ”¹å˜çŠ¶æ€</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ErrorBound.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">ErrorBound</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">hasError</span>: <span class="literal">false</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * åªæœ‰å­ç»„ä»¶å‘ç”Ÿé”™è¯¯æ‰ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; error é”™è¯¯å¯¹è±¡</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒReactä¼šå°†è¯¥å¯¹è±¡çš„å±æ€§è¦†ç›–æ‰å½“å‰ç»„ä»¶çš„state</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">getDerivedStateFromError</span>(<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å‘ç”Ÿé”™è¯¯äº†&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">hasError</span>: <span class="literal">true</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">hasError</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>å‘ç”Ÿé”™è¯¯äº†ï¼<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">children</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¼–å†™ç”Ÿå‘½å‘¨æœŸå‡½æ•° componentDidCatch</p>
<ol>
<li>å®ä¾‹æ–¹æ³•</li>
<li>è¿è¡Œæ—¶é—´ç‚¹ï¼šæ¸²æŸ“å­ç»„ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç”Ÿé”™è¯¯ï¼Œ<strong>æ›´æ–°é¡µé¢ä¹‹å</strong>ï¼Œç”±äºå…¶è¿è¡Œæ—¶é—´ç‚¹æ¯”è¾ƒé åï¼Œå› æ­¤ä¸å¤ªä¼šåœ¨è¯¥å‡½æ•°ä¸­æ”¹å˜çŠ¶æ€</li>
<li>é€šå¸¸ï¼Œè¯¥å‡½æ•°ç”¨äºè®°å½•é”™è¯¯æ¶ˆæ¯</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">componentDidCatch</span>(<span class="params">error, info</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;error&#x27;</span>, error);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;info&#x27;</span>, info);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">cur</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">hasError</span>: <span class="literal">true</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="ç»†èŠ‚"><a href="#ç»†èŠ‚" class="headerlink" title="ç»†èŠ‚"></a><strong>ç»†èŠ‚</strong></h3><p>æŸäº›é”™è¯¯ï¼Œé”™è¯¯è¾¹ç•Œç»„ä»¶æ— æ³•æ•è·</p>
<ol>
<li>é”™è¯¯è¾¹ç•Œç»„ä»¶è‡ªèº«çš„é”™è¯¯</li>
<li>å¼‚æ­¥çš„é”™è¯¯ï¼Œæ¯”å¦‚setTimeOutä¸­çš„é”™è¯¯</li>
<li>äº‹ä»¶ä¸­çš„é”™è¯¯ï¼Œæ¯”å¦‚ç‚¹å‡»äº‹ä»¶è§¦å‘çš„é”™è¯¯</li>
</ol>
<p>æ€»ç»“ï¼šä»…å¤„ç†<strong>æ¸²æŸ“å­ç»„ä»¶æœŸé—´çš„åŒæ­¥é”™è¯¯</strong>ï¼Œä¸Šè¿°å¤„ç†ä¸äº†çš„é”™è¯¯å¯ä»¥ä½¿ç”¨try,catchå»å¤„ç†</p>
<h2 id="æ¸²æŸ“åŸç†"><a href="#æ¸²æŸ“åŸç†" class="headerlink" title="æ¸²æŸ“åŸç†"></a>æ¸²æŸ“åŸç†</h2><p>æ¸²æŸ“ï¼šç”Ÿæˆç”¨äºæ˜¾ç¤ºçš„å¯¹è±¡ï¼Œä»¥åŠå°†è¿™äº›å¯¹è±¡å½¢æˆçœŸå®çš„DOMå¯¹è±¡</p>
<ul>
<li>Reactå…ƒç´ ï¼šReact Elementï¼Œé€šè¿‡React.createElementåˆ›å»ºï¼ˆè¯­æ³•ç³–ï¼šJSXï¼‰<ul>
<li>ä¾‹å¦‚ï¼š</li>
<li><code>&lt;div&gt;&lt;h1&gt;æ ‡é¢˜&lt;/h1&gt;&lt;/div&gt;</code></li>
<li><code>&lt;App /&gt;</code></li>
</ul>
</li>
<li>ReactèŠ‚ç‚¹ï¼šä¸“é—¨ç”¨äºæ¸²æŸ“åˆ°UIç•Œé¢çš„å¯¹è±¡ï¼ŒReactä¼šé€šè¿‡Reactå…ƒç´ ï¼Œåˆ›å»ºReactèŠ‚ç‚¹ï¼ŒReactDOMä¸€å®šæ˜¯é€šè¿‡ReactèŠ‚ç‚¹æ¥è¿›è¡Œæ¸²æŸ“çš„</li>
<li>èŠ‚ç‚¹ç±»å‹ï¼š<ul>
<li>React DOMèŠ‚ç‚¹ï¼šåˆ›å»ºè¯¥èŠ‚ç‚¹çš„Reactå…ƒç´ ç±»å‹æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</li>
<li>React ç»„ä»¶èŠ‚ç‚¹ï¼šåˆ›å»ºè¯¥èŠ‚ç‚¹çš„Reactå…ƒç´ ç±»å‹æ˜¯ä¸€ä¸ªå‡½æ•°æˆ–æ˜¯ä¸€ä¸ªç±»</li>
<li>React æ–‡æœ¬èŠ‚ç‚¹ï¼šç”±å­—ç¬¦ä¸²ã€æ•°å­—åˆ›å»ºçš„</li>
<li>React ç©ºèŠ‚ç‚¹ï¼šç”±nullã€undefinedã€falseã€true</li>
<li>React æ•°ç»„èŠ‚ç‚¹ï¼šè¯¥èŠ‚ç‚¹ç”±ä¸€ä¸ªæ•°ç»„åˆ›å»º</li>
</ul>
</li>
<li>çœŸå®DOMï¼šé€šè¿‡document.createElementåˆ›å»ºçš„domå…ƒç´ </li>
</ul>
<p><img src="/2023/04/07/React%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2019-07-25-13-51-08.png"></p>
<h3 id="é¦–æ¬¡æ¸²æŸ“-æ–°èŠ‚ç‚¹æ¸²æŸ“"><a href="#é¦–æ¬¡æ¸²æŸ“-æ–°èŠ‚ç‚¹æ¸²æŸ“" class="headerlink" title="é¦–æ¬¡æ¸²æŸ“(æ–°èŠ‚ç‚¹æ¸²æŸ“)"></a>é¦–æ¬¡æ¸²æŸ“(æ–°èŠ‚ç‚¹æ¸²æŸ“)</h3><ol>
<li>é€šè¿‡å‚æ•°çš„å€¼åˆ›å»ºèŠ‚ç‚¹</li>
<li>æ ¹æ®ä¸åŒçš„èŠ‚ç‚¹ï¼Œåšä¸åŒçš„äº‹æƒ…<ol>
<li>æ–‡æœ¬èŠ‚ç‚¹ï¼šé€šè¿‡document.createTextNodeåˆ›å»ºçœŸå®çš„æ–‡æœ¬èŠ‚ç‚¹</li>
<li>ç©ºèŠ‚ç‚¹ï¼šä»€ä¹ˆéƒ½ä¸åš</li>
<li>æ•°ç»„èŠ‚ç‚¹ï¼šéå†æ•°ç»„ï¼Œå°†æ•°ç»„æ¯ä¸€é¡¹é€’å½’åˆ›å»ºèŠ‚ç‚¹ï¼ˆå›åˆ°ç¬¬1æ­¥è¿›è¡Œåå¤æ“ä½œï¼Œç›´åˆ°éå†ç»“æŸï¼‰</li>
<li>DOMèŠ‚ç‚¹ï¼šé€šè¿‡document.createElementåˆ›å»ºçœŸå®çš„DOMå¯¹è±¡ï¼Œç„¶åç«‹å³è®¾ç½®è¯¥çœŸå®DOMå…ƒç´ çš„å„ç§å±æ€§ï¼Œç„¶åéå†å¯¹åº”Reactå…ƒç´ çš„childrenå±æ€§ï¼Œé€’å½’æ“ä½œï¼ˆå›åˆ°ç¬¬1æ­¥è¿›è¡Œåå¤æ“ä½œï¼Œç›´åˆ°éå†ç»“æŸï¼‰</li>
<li>ç»„ä»¶èŠ‚ç‚¹<ol>
<li>å‡½æ•°ç»„ä»¶ï¼šè°ƒç”¨å‡½æ•°(è¯¥å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå¯ä»¥ç”ŸæˆèŠ‚ç‚¹çš„å†…å®¹)ï¼Œå°†è¯¥å‡½æ•°çš„è¿”å›ç»“æœé€’å½’ç”ŸæˆèŠ‚ç‚¹ï¼ˆå›åˆ°ç¬¬1æ­¥è¿›è¡Œåå¤æ“ä½œï¼Œç›´åˆ°éå†ç»“æŸï¼‰</li>
<li>ç±»ç»„ä»¶ï¼š<ol>
<li>åˆ›å»ºè¯¥ç±»çš„å®ä¾‹</li>
<li>ç«‹å³è°ƒç”¨å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼šstatic getDerivedStateFromProps</li>
<li>è¿è¡Œè¯¥å¯¹è±¡çš„renderæ–¹æ³•ï¼Œæ‹¿åˆ°èŠ‚ç‚¹å¯¹è±¡ï¼ˆå°†è¯¥èŠ‚ç‚¹é€’å½’æ“ä½œï¼Œå›åˆ°ç¬¬1æ­¥è¿›è¡Œåå¤æ“ä½œï¼‰</li>
<li>å°†è¯¥ç»„ä»¶çš„componentDidMountåŠ å…¥åˆ°æ‰§è¡Œé˜Ÿåˆ—ï¼ˆå…ˆè¿›å…ˆå‡ºï¼Œå…ˆè¿›å…ˆæ‰§è¡Œï¼‰ï¼Œå½“æ•´ä¸ªè™šæ‹ŸDOMæ ‘å…¨éƒ¨æ„å»ºå®Œæ¯•ï¼Œå¹¶ä¸”å°†çœŸå®çš„DOMå¯¹è±¡åŠ å…¥åˆ°å®¹å™¨ä¸­åï¼Œæ‰§è¡Œè¯¥é˜Ÿåˆ—</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>ç”Ÿæˆå‡ºè™šæ‹ŸDOMæ ‘ä¹‹åï¼Œå°†è¯¥æ ‘ä¿å­˜èµ·æ¥ï¼Œä»¥ä¾¿åç»­ä½¿ç”¨</li>
<li>å°†ä¹‹å‰ç”Ÿæˆçš„çœŸå®çš„DOMå¯¹è±¡ï¼ŒåŠ å…¥åˆ°å®¹å™¨ä¸­ã€‚</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;assaf&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        æ ‡é¢˜</span></span><br><span class="line"><span class="language-xml">        &#123;[&quot;abc&quot;, null, <span class="tag">&lt;<span class="name">p</span>&gt;</span>æ®µè½<span class="tag">&lt;/<span class="name">p</span>&gt;</span>]&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;undefined&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(app, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä»£ç ç”Ÿæˆçš„è™šæ‹ŸDOMæ ‘ï¼š</p>
<p><img src="/2023/04/07/React%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2019-07-25-14-17-04.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Comp1</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Comp1 &#123;props.n&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Comp1</span> <span class="attr">n</span>=<span class="string">&#123;5&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>;</span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(app, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä»£ç ç”Ÿæˆçš„è™šæ‹ŸDOMæ ‘ï¼š</p>
<p><img src="/2023/04/07/React%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2019-07-25-14-49-53.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Comp1</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Comp1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Comp1</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>;</span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(app, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä»£ç ç”Ÿæˆçš„è™šæ‹ŸDOMæ ‘ï¼š</p>
<p><img src="/2023/04/07/React%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2019-07-25-14-56-35.png"></p>
<h3 id="æ›´æ–°èŠ‚ç‚¹"><a href="#æ›´æ–°èŠ‚ç‚¹" class="headerlink" title="æ›´æ–°èŠ‚ç‚¹"></a>æ›´æ–°èŠ‚ç‚¹</h3><p>æ›´æ–°çš„åœºæ™¯ï¼š</p>
<ol>
<li><p>é‡æ–°è°ƒç”¨ReactDOM.renderï¼Œå®Œå…¨é‡æ–°ç”ŸæˆèŠ‚ç‚¹æ ‘ï¼Œè§¦å‘æ ¹èŠ‚ç‚¹æ›´æ–°</p>
<ol>
<li>è§¦å‘æ ¹èŠ‚ç‚¹æ›´æ–°</li>
</ol>
</li>
<li><p>åœ¨ç±»ç»„ä»¶çš„å®ä¾‹å¯¹è±¡ä¸­è°ƒç”¨setStateï¼Œä¼šå¯¼è‡´è¯¥å®ä¾‹æ‰€åœ¨çš„èŠ‚ç‚¹æ›´æ–°</p>
</li>
</ol>
<p><strong>èŠ‚ç‚¹çš„æ›´æ–°</strong></p>
<ul>
<li>å¦‚æœè°ƒç”¨çš„æ˜¯ReactDOM.renderï¼Œè¿›å…¥æ ¹èŠ‚ç‚¹çš„<strong>å¯¹æ¯”ï¼ˆdiffï¼‰æ›´æ–°</strong></li>
<li>å¦‚æœè°ƒç”¨çš„æ˜¯setState<ul>
<li><ol>
<li>è¿è¡Œç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œstatic getDerivedStateFromProps</li>
</ol>
</li>
<li><ol start="2">
<li>è¿è¡ŒshouldComponentUpdateï¼Œå¦‚æœè¯¥å‡½æ•°è¿”å›falseï¼Œç»ˆæ­¢å½“å‰æµç¨‹</li>
</ol>
</li>
<li><ol start="3">
<li>è¿è¡Œrenderï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œè¿›å…¥è¯¥æ–°çš„èŠ‚ç‚¹çš„<strong>å¯¹æ¯”æ›´æ–°</strong></li>
</ol>
</li>
<li><ol start="4">
<li>å°†ç”Ÿå‘½å‘¨æœŸå‡½æ•°getSnapshotBeforeUpdateåŠ å…¥æ‰§è¡Œé˜Ÿåˆ—ï¼Œä»¥å¾…å°†æ¥æ‰§è¡Œ</li>
</ol>
</li>
<li><ol start="5">
<li>å°†ç”Ÿå‘½å‘¨æœŸå‡½æ•°componentDidUpdateåŠ å…¥æ‰§è¡Œé˜Ÿåˆ—ï¼Œä»¥å¾…å°†æ¥æ‰§è¡Œ</li>
</ol>
</li>
</ul>
</li>
</ul>
<p>åç»­æ­¥éª¤ï¼š</p>
<ol>
<li>æ›´æ–°è™šæ‹ŸDOMæ ‘</li>
<li>å®ŒæˆçœŸå®çš„DOMæ›´æ–°</li>
<li>ä¾æ¬¡è°ƒç”¨æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„componentDidMount</li>
<li>ä¾æ¬¡è°ƒç”¨æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„getSnapshotBeforeUpdate</li>
<li>ä¾æ¬¡è°ƒç”¨æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„componentDidUpdate</li>
</ol>
<h4 id="å¯¹æ¯”æ›´æ–°"><a href="#å¯¹æ¯”æ›´æ–°" class="headerlink" title="å¯¹æ¯”æ›´æ–°"></a>å¯¹æ¯”æ›´æ–°</h4><p>å°†æ–°äº§ç”Ÿçš„èŠ‚ç‚¹ï¼Œå¯¹æ¯”ä¹‹å‰è™šæ‹ŸDOMä¸­çš„èŠ‚ç‚¹ï¼Œå‘ç°å·®å¼‚ï¼Œå®Œæˆæ›´æ–°</p>
<p>é—®é¢˜ï¼šå¯¹æ¯”ä¹‹å‰DOMæ ‘ä¸­å“ªä¸ªèŠ‚ç‚¹</p>
<p>Reactä¸ºäº†æé«˜å¯¹æ¯”æ•ˆç‡ï¼Œåšå‡ºä»¥ä¸‹å‡è®¾</p>
<ol>
<li>å‡è®¾èŠ‚ç‚¹ä¸ä¼šå‡ºç°å±‚æ¬¡çš„ç§»åŠ¨ï¼ˆå¯¹æ¯”æ—¶ï¼Œç›´æ¥æ‰¾åˆ°æ—§æ ‘ä¸­å¯¹åº”ä½ç½®çš„èŠ‚ç‚¹è¿›è¡Œå¯¹æ¯”ï¼‰</li>
<li>ä¸åŒçš„èŠ‚ç‚¹ç±»å‹ä¼šç”Ÿæˆä¸åŒçš„ç»“æ„<ol>
<li>ç›¸åŒçš„èŠ‚ç‚¹ç±»å‹ï¼šèŠ‚ç‚¹æœ¬èº«ç±»å‹ç›¸åŒï¼Œå¦‚æœæ˜¯ç”±Reactå…ƒç´ ç”Ÿæˆï¼Œtypeå€¼è¿˜å¿…é¡»ä¸€è‡´</li>
<li>å…¶ä»–çš„ï¼Œéƒ½å±äºä¸ç›¸åŒçš„èŠ‚ç‚¹ç±»å‹</li>
</ol>
</li>
<li>å¤šä¸ªå…„å¼Ÿé€šè¿‡å”¯ä¸€æ ‡è¯†ï¼ˆkeyï¼‰æ¥ç¡®å®šå¯¹æ¯”çš„æ–°èŠ‚ç‚¹</li>
</ol>
<p>keyå€¼çš„ä½œç”¨ï¼šç”¨äºé€šè¿‡æ—§èŠ‚ç‚¹ï¼Œå¯»æ‰¾å¯¹åº”çš„æ–°èŠ‚ç‚¹ï¼Œå¦‚æœæŸä¸ªæ—§èŠ‚ç‚¹æœ‰keyå€¼ï¼Œåˆ™å…¶æ›´æ–°æ—¶ï¼Œä¼šå¯»æ‰¾ç›¸åŒå±‚çº§ä¸­çš„ç›¸åŒkeyå€¼çš„èŠ‚ç‚¹ï¼Œè¿›è¡Œå¯¹æ¯”ã€‚</p>
<p><strong>keyå€¼åº”è¯¥åœ¨ä¸€ä¸ªèŒƒå›´å†…å”¯ä¸€ï¼ˆå…„å¼ŸèŠ‚ç‚¹ä¸­ï¼‰ï¼Œå¹¶ä¸”åº”è¯¥ä¿æŒç¨³å®š</strong></p>
<h5 id="æ‰¾åˆ°äº†å¯¹æ¯”çš„ç›®æ ‡"><a href="#æ‰¾åˆ°äº†å¯¹æ¯”çš„ç›®æ ‡" class="headerlink" title="æ‰¾åˆ°äº†å¯¹æ¯”çš„ç›®æ ‡"></a>æ‰¾åˆ°äº†å¯¹æ¯”çš„ç›®æ ‡</h5><p>åˆ¤æ–­èŠ‚ç‚¹ç±»å‹æ˜¯å¦ä¸€è‡´</p>
<ul>
<li><strong>ä¸€è‡´</strong></li>
</ul>
<p>æ ¹æ®ä¸åŒçš„èŠ‚ç‚¹ç±»å‹ï¼Œåšä¸åŒçš„äº‹æƒ…</p>
<p><strong>ç©ºèŠ‚ç‚¹</strong>ï¼šä¸åšä»»ä½•äº‹æƒ…</p>
<p><strong>DOMèŠ‚ç‚¹</strong>ï¼š</p>
<ol>
<li>ç›´æ¥é‡ç”¨ä¹‹å‰çš„çœŸå®DOMå¯¹è±¡</li>
<li>å°†å…¶å±æ€§çš„å˜åŒ–è®°å½•ä¸‹æ¥ï¼Œä»¥å¾…å°†æ¥ç»Ÿä¸€å®Œæˆæ›´æ–°ï¼ˆç°åœ¨ä¸ä¼šçœŸæ­£çš„å˜åŒ–ï¼‰</li>
<li>éå†è¯¥æ–°çš„Reactå…ƒç´ çš„å­å…ƒç´ ï¼Œ<strong>é€’å½’å¯¹æ¯”æ›´æ–°</strong></li>
</ol>
<p><strong>æ–‡æœ¬èŠ‚ç‚¹</strong>ï¼š</p>
<ol>
<li>ç›´æ¥é‡ç”¨ä¹‹å‰çš„çœŸå®DOMå¯¹è±¡</li>
<li>å°†æ–°çš„æ–‡æœ¬å˜åŒ–è®°å½•ä¸‹æ¥ï¼Œå°†æ¥ç»Ÿä¸€å®Œæˆæ›´æ–°</li>
</ol>
<p><strong>ç»„ä»¶èŠ‚ç‚¹</strong>ï¼š</p>
<p><strong>å‡½æ•°ç»„ä»¶</strong>ï¼šé‡æ–°è°ƒç”¨å‡½æ•°ï¼Œå¾—åˆ°ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡ï¼Œè¿›å…¥<strong>é€’å½’å¯¹æ¯”æ›´æ–°</strong></p>
<p><strong>ç±»ç»„ä»¶</strong>ï¼š</p>
<ol>
<li>é‡ç”¨ä¹‹å‰çš„å®ä¾‹</li>
<li>è°ƒç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•getDerivedStateFromProps</li>
<li>è°ƒç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•shouldComponentUpdateï¼Œè‹¥è¯¥æ–¹æ³•è¿”å›falseï¼Œç»ˆæ­¢</li>
<li>è¿è¡Œrenderï¼Œå¾—åˆ°æ–°çš„èŠ‚ç‚¹å¯¹è±¡ï¼Œè¿›å…¥<strong>é€’å½’å¯¹æ¯”æ›´æ–°</strong></li>
<li>å°†è¯¥å¯¹è±¡çš„getSnapshotBeforeUpdateåŠ å…¥é˜Ÿåˆ—</li>
<li>å°†è¯¥å¯¹è±¡çš„componentDidUpdateåŠ å…¥é˜Ÿåˆ—</li>
</ol>
<p><strong>æ•°ç»„èŠ‚ç‚¹</strong>ï¼šéå†æ•°ç»„è¿›è¡Œ<strong>é€’å½’å¯¹æ¯”æ›´æ–°</strong></p>
<ul>
<li><strong>ä¸ä¸€è‡´</strong></li>
</ul>
<p>æ•´ä½“ä¸Šï¼Œå¸è½½æ—§çš„èŠ‚ç‚¹ï¼Œå…¨æ–°åˆ›å»ºæ–°çš„èŠ‚ç‚¹</p>
<p><strong>åˆ›å»ºæ–°èŠ‚ç‚¹</strong></p>
<p>è¿›å…¥æ–°èŠ‚ç‚¹çš„æŒ‚è½½æµç¨‹</p>
<p><strong>å¸è½½æ—§èŠ‚ç‚¹</strong></p>
<ol>
<li><strong>æ–‡æœ¬èŠ‚ç‚¹ã€DOMèŠ‚ç‚¹ã€æ•°ç»„èŠ‚ç‚¹ã€ç©ºèŠ‚ç‚¹ã€å‡½æ•°ç»„ä»¶èŠ‚ç‚¹</strong>ï¼šç›´æ¥æ”¾å¼ƒè¯¥èŠ‚ç‚¹ï¼Œå¦‚æœèŠ‚ç‚¹æœ‰å­èŠ‚ç‚¹ï¼Œé€’å½’å¸è½½èŠ‚ç‚¹</li>
<li><strong>ç±»ç»„ä»¶èŠ‚ç‚¹</strong>ï¼š<ol>
<li>ç›´æ¥æ”¾å¼ƒè¯¥èŠ‚ç‚¹</li>
<li>è°ƒç”¨è¯¥èŠ‚ç‚¹çš„componentWillUnMountå‡½æ•°</li>
<li>é€’å½’å¸è½½å­èŠ‚ç‚¹</li>
</ol>
</li>
</ol>
<h5 id="æ²¡æœ‰æ‰¾åˆ°å¯¹æ¯”çš„ç›®æ ‡"><a href="#æ²¡æœ‰æ‰¾åˆ°å¯¹æ¯”çš„ç›®æ ‡" class="headerlink" title="æ²¡æœ‰æ‰¾åˆ°å¯¹æ¯”çš„ç›®æ ‡"></a>æ²¡æœ‰æ‰¾åˆ°å¯¹æ¯”çš„ç›®æ ‡</h5><p>æ–°çš„DOMæ ‘ä¸­æœ‰èŠ‚ç‚¹è¢«åˆ é™¤</p>
<p>æ–°çš„DOMæ ‘ä¸­æœ‰èŠ‚ç‚¹æ·»åŠ </p>
<ul>
<li>åˆ›å»ºæ–°åŠ å…¥çš„èŠ‚ç‚¹</li>
<li>å¸è½½å¤šä½™çš„æ—§èŠ‚ç‚¹</li>
</ul>
<h2 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h2><h3 id="ä¸¥æ ¼æ¨¡å¼"><a href="#ä¸¥æ ¼æ¨¡å¼" class="headerlink" title="ä¸¥æ ¼æ¨¡å¼"></a>ä¸¥æ ¼æ¨¡å¼</h3><p>StrictMode(<code>React.StrictMode</code>)ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œè¯¥ç»„ä»¶ä¸è¿›è¡ŒUIæ¸²æŸ“ï¼ˆ<code>React.Fragment &lt;&gt; &lt;/&gt;</code>ï¼‰ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼Œåœ¨æ¸²æŸ“å†…éƒ¨ç»„ä»¶æ—¶ï¼Œå‘ç°ä¸åˆé€‚çš„ä»£ç ã€‚</p>
<ul>
<li>è¯†åˆ«ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸ</li>
<li>å…³äºä½¿ç”¨è¿‡æ—¶å­—ç¬¦ä¸² ref API çš„è­¦å‘Š</li>
<li>å…³äºä½¿ç”¨åºŸå¼ƒçš„ findDOMNode æ–¹æ³•çš„è­¦å‘Š</li>
<li>æ£€æµ‹æ„å¤–çš„å‰¯ä½œç”¨<ul>
<li>Reactè¦æ±‚ï¼Œå‰¯ä½œç”¨ä»£ç ä»…å‡ºç°åœ¨ä»¥ä¸‹ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­</li>
<li><ol>
<li>ComponentDidMount</li>
</ol>
</li>
<li><ol start="2">
<li>ComponentDidUpdate</li>
</ol>
</li>
<li><ol start="3">
<li>ComponentWillUnMount</li>
</ol>
</li>
</ul>
</li>
</ul>
<p>å‰¯ä½œç”¨ï¼šä¸€ä¸ªå‡½æ•°ä¸­ï¼Œåšäº†ä¸€äº›ä¼šå½±å“å‡½æ•°å¤–éƒ¨æ•°æ®çš„äº‹æƒ…ï¼Œä¾‹å¦‚ï¼š</p>
<ol>
<li>å¼‚æ­¥å¤„ç†</li>
<li>æ”¹å˜å‚æ•°å€¼</li>
<li>setState</li>
<li>æœ¬åœ°å­˜å‚¨</li>
<li>æ”¹å˜å‡½æ•°å¤–éƒ¨çš„å˜é‡</li>
</ol>
<p>ç›¸åçš„ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°æ²¡æœ‰å‰¯ä½œç”¨ï¼Œåˆ™å¯ä»¥è®¤ä¸ºè¯¥å‡½æ•°æ˜¯ä¸€ä¸ªçº¯å‡½æ•°</p>
<p>åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè™½ç„¶ä¸èƒ½ç›‘æ§åˆ°å…·ä½“çš„å‰¯ä½œç”¨ä»£ç ï¼Œä½†å®ƒä¼šå°†ä¸èƒ½å…·æœ‰å‰¯ä½œç”¨çš„å‡½æ•°è°ƒç”¨ä¸¤éï¼Œä»¥ä¾¿å‘ç°é—®é¢˜ã€‚ï¼ˆè¿™ç§æƒ…å†µï¼Œä»…åœ¨å¼€å‘æ¨¡å¼ä¸‹æœ‰æ•ˆï¼‰</p>
<ul>
<li>æ£€æµ‹è¿‡æ—¶çš„ context API</li>
</ul>
<h3 id="Profiler"><a href="#Profiler" class="headerlink" title="Profiler"></a>Profiler</h3><p>æ€§èƒ½åˆ†æå·¥å…·</p>
<p>åˆ†ææŸä¸€æ¬¡æˆ–å¤šæ¬¡æäº¤ï¼ˆæ›´æ–°ï¼‰ï¼Œæ¶‰åŠåˆ°çš„ç»„ä»¶çš„æ¸²æŸ“æ—¶é—´</p>
<p>ç«ç„°å›¾ï¼šå¾—åˆ°æŸä¸€æ¬¡æäº¤ï¼Œæ¯ä¸ªç»„ä»¶æ€»çš„æ¸²æŸ“æ—¶é—´ä»¥åŠè‡ªèº«çš„æ¸²æŸ“æ—¶é—´</p>
<p>æ’åºå›¾ï¼šå¾—åˆ°æŸä¸€æ¬¡æäº¤ï¼Œæ¯ä¸ªç»„ä»¶è‡ªèº«æ¸²æŸ“æ—¶é—´çš„æ’åº</p>
<p>ç»„ä»¶å›¾ï¼šæŸä¸€ä¸ªç»„ä»¶ï¼Œåœ¨å¤šæ¬¡æäº¤ä¸­ï¼Œè‡ªèº«æ¸²æŸ“èŠ±è´¹çš„æ—¶é—´</p>
<h2 id="HOOK"><a href="#HOOK" class="headerlink" title="HOOK"></a>HOOK</h2><p>HOOKæ˜¯React16.8.0ä¹‹åå‡ºç°</p>
<p>ç»„ä»¶ï¼šæ— çŠ¶æ€ç»„ä»¶ï¼ˆå‡½æ•°ç»„ä»¶ï¼‰ã€ç±»ç»„ä»¶</p>
<p>ç±»ç»„ä»¶ä¸­çš„éº»çƒ¦ï¼š</p>
<ol>
<li><p>thisæŒ‡å‘é—®é¢˜</p>
</li>
<li><p>ç¹ççš„ç”Ÿå‘½å‘¨æœŸ</p>
</li>
<li><p>å…¶ä»–é—®é¢˜</p>
</li>
</ol>
<p>HOOKä¸“é—¨ç”¨äºå¢å¼ºå‡½æ•°ç»„ä»¶çš„åŠŸèƒ½ï¼ˆHOOKåœ¨ç±»ç»„ä»¶ä¸­æ˜¯ä¸èƒ½ä½¿ç”¨çš„ï¼‰ï¼Œä½¿ä¹‹ç†è®ºä¸Šå¯ä»¥æˆä¸ºç±»ç»„ä»¶çš„æ›¿ä»£å“</p>
<p>å®˜æ–¹å¼ºè°ƒï¼šæ²¡æœ‰å¿…è¦æ›´æ”¹å·²ç»å®Œæˆçš„ç±»ç»„ä»¶ï¼Œå®˜æ–¹ç›®å‰æ²¡æœ‰è®¡åˆ’å–æ¶ˆç±»ç»„ä»¶ï¼Œåªæ˜¯é¼“åŠ±ä½¿ç”¨å‡½æ•°ç»„ä»¶</p>
<p>HOOKï¼ˆé’©å­ï¼‰æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°(å‘½åä¸Šæ€»æ˜¯ä»¥useå¼€å¤´)ï¼Œè¯¥å‡½æ•°å¯ä»¥æŒ‚è½½ä»»ä½•åŠŸèƒ½</p>
<p>HOOKç§ç±»ï¼š</p>
<ol>
<li>useState</li>
<li>useEffect</li>
<li>å…¶ä»–â€¦</li>
</ol>
<h3 id="State-Hook"><a href="#State-Hook" class="headerlink" title="State Hook"></a>State Hook</h3><p>State Hookæ˜¯ä¸€ä¸ªåœ¨å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨çš„å‡½æ•°ï¼ˆuseStateï¼‰ï¼Œç”¨äºåœ¨å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨çŠ¶æ€</p>
<p>useState</p>
<ul>
<li>å‡½æ•°æœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°çš„å€¼è¡¨ç¤ºçŠ¶æ€çš„é»˜è®¤å€¼</li>
<li>å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„ä¸€å®šåŒ…å«ä¸¤é¡¹<ul>
<li>ç¬¬ä¸€é¡¹ï¼šå½“å‰çŠ¶æ€çš„å€¼</li>
<li>ç¬¬äºŒé¡¹ï¼šæ”¹å˜çŠ¶æ€çš„å‡½æ•°</li>
</ul>
</li>
</ul>
<p>ä¸€ä¸ªå‡½æ•°ç»„ä»¶ä¸­å¯ä»¥æœ‰å¤šä¸ªçŠ¶æ€ï¼Œè¿™ç§åšæ³•éå¸¸æœ‰åˆ©äºæ¨ªå‘åˆ‡åˆ†å…³æ³¨ç‚¹ã€‚</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> [visible, setVisible] = <span class="title function_">useState</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">doHandleAdd</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setCount</span>(++count);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">doHandleReduce</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setCount</span>(--count);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">dohandleVisible</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setVisible</span>(!visible);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">display:</span> <span class="attr">visible</span> ? &#x27;<span class="attr">block</span>&#x27; <span class="attr">:</span> &#x27;<span class="attr">none</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;doHandleReduce&#125;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;doHandleAdd&#125;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;dohandleVisible&#125;</span>&gt;</span>æ˜¾ç¤º/éšè—<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„çš„ç»†èŠ‚</strong></p>
<ol>
<li>useStateæœ€å¥½å†™åˆ°å‡½æ•°çš„èµ·å§‹ä½ç½®ï¼Œä¾¿äºé˜…è¯»</li>
<li>useStateä¸¥ç¦å‡ºç°åœ¨ä»£ç å—ï¼ˆåˆ¤æ–­ã€å¾ªç¯ï¼‰ä¸­</li>
<li>useStateè¿”å›çš„å‡½æ•°ï¼ˆæ•°ç»„çš„ç¬¬äºŒé¡¹ï¼‰ï¼Œå¼•ç”¨ä¸å˜ï¼ˆèŠ‚çº¦å†…å­˜ç©ºé—´ï¼‰</li>
<li>ä½¿ç”¨å‡½æ•°æ”¹å˜æ•°æ®ï¼Œè‹¥æ•°æ®å’Œä¹‹å‰çš„æ•°æ®å®Œå…¨ç›¸ç­‰ï¼ˆä½¿ç”¨Object.isæ¯”è¾ƒï¼‰ï¼Œä¸ä¼šå¯¼è‡´é‡æ–°æ¸²æŸ“ï¼Œä»¥è¾¾åˆ°ä¼˜åŒ–æ•ˆç‡çš„ç›®çš„ã€‚</li>
<li>ä½¿ç”¨å‡½æ•°æ”¹å˜æ•°æ®ï¼Œä¼ å…¥çš„å€¼ä¸ä¼šå’ŒåŸæ¥çš„æ•°æ®è¿›è¡Œåˆå¹¶ï¼Œè€Œæ˜¯ç›´æ¥æ›¿æ¢ã€‚</li>
<li>å¦‚æœè¦å®ç°å¼ºåˆ¶åˆ·æ–°ç»„ä»¶<ol>
<li>ç±»ç»„ä»¶ï¼šä½¿ç”¨forceUpdateå‡½æ•°</li>
<li>å‡½æ•°ç»„ä»¶ï¼šä½¿ç”¨ä¸€ä¸ªç©ºå¯¹è±¡çš„useState</li>
</ol>
</li>
<li><strong>å¦‚æœæŸäº›çŠ¶æ€ä¹‹é—´æ²¡æœ‰å¿…ç„¶çš„è”ç³»ï¼Œåº”è¯¥åˆ†åŒ–ä¸ºä¸åŒçš„çŠ¶æ€ï¼Œè€Œä¸è¦åˆå¹¶æˆä¸€ä¸ªå¯¹è±¡</strong></li>
<li>å’Œç±»ç»„ä»¶çš„çŠ¶æ€ä¸€æ ·ï¼Œå‡½æ•°ç»„ä»¶ä¸­æ”¹å˜çŠ¶æ€å¯èƒ½æ˜¯å¼‚æ­¥çš„ï¼ˆåœ¨DOMäº‹ä»¶ä¸­ï¼‰ï¼Œå¤šä¸ªçŠ¶æ€å˜åŒ–ä¼šåˆå¹¶ä»¥æé«˜æ•ˆç‡ï¼Œæ­¤æ—¶ï¼Œä¸èƒ½ä¿¡ä»»ä¹‹å‰çš„çŠ¶æ€ï¼Œè€Œåº”è¯¥ä½¿ç”¨å›è°ƒå‡½æ•°çš„æ–¹å¼æ”¹å˜çŠ¶æ€ã€‚å¦‚æœçŠ¶æ€å˜åŒ–è¦ä½¿ç”¨åˆ°ä¹‹å‰çš„çŠ¶æ€ï¼Œå°½é‡ä¼ é€’å‡½æ•°ã€‚</li>
</ol>
<h3 id="Effect-Hook"><a href="#Effect-Hook" class="headerlink" title="Effect Hook"></a>Effect Hook</h3><p>Effect Hookï¼šç”¨äºåœ¨å‡½æ•°ç»„ä»¶ä¸­å¤„ç†å‰¯ä½œç”¨</p>
<p>å‰¯ä½œç”¨ï¼š</p>
<ol>
<li>ajaxè¯·æ±‚</li>
<li>è®¡æ—¶å™¨</li>
<li>å…¶ä»–å¼‚æ­¥æ“ä½œ</li>
<li>æ›´æ”¹çœŸå®DOMå¯¹è±¡</li>
<li>æœ¬åœ°å­˜å‚¨</li>
<li>å…¶ä»–ä¼šå¯¹å¤–éƒ¨äº§ç”Ÿå½±å“çš„æ“ä½œ</li>
</ol>
<p>å‡½æ•°ï¼š<code>useEffect</code>ï¼Œè¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæ¥æ”¶çš„å‡½æ•°å°±æ˜¯éœ€è¦è¿›è¡Œå‰¯ä½œç”¨æ“ä½œçš„å‡½æ•°</p>
<p><strong>ä¸¾ä¸ªä¾‹å­ï¼š</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">doHandleAdd</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setCount</span>(++count);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿™æ˜¯ä¸€ä¸ªå‰¯ä½œç”¨æ“ä½œï¼Œè™½ç„¶èƒ½å®ç°æ•ˆæœï¼Œä½†æ˜¯ä¸åº”è¯¥å‡ºç°åœ¨å‡½æ•°ç»„ä»¶å†…ï¼Œç»„ä»¶åº”å°½å¯èƒ½ä¿æŒçº¯å‡€</span></span><br><span class="line">  <span class="comment">// document.title = `è®¡æ•°å™¨æ˜¯$&#123;count&#125;`;</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">`è®¡æ•°å™¨æ˜¯<span class="subst">$&#123;count&#125;</span>`</span>;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;doHandleAdd&#125;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç»†èŠ‚</strong></p>
<ol>
<li><p>å‰¯ä½œç”¨å‡½æ•°çš„è¿è¡Œæ—¶é—´ç‚¹ï¼Œæ˜¯åœ¨é¡µé¢å®Œæˆ<strong>çœŸå®çš„UIæ¸²æŸ“ä¹‹å</strong>ã€‚å› æ­¤å®ƒçš„<strong>æ‰§è¡Œæ˜¯å¼‚æ­¥çš„</strong>ï¼Œå¹¶ä¸”<strong>ä¸ä¼šé˜»å¡æµè§ˆå™¨</strong></p>
<ol>
<li>ä¸ç±»ç»„ä»¶ä¸­componentDidMountå’ŒcomponentDidUpdateçš„åŒºåˆ«</li>
<li>componentDidMountå’ŒcomponentDidUpdateï¼Œæ›´æ”¹äº†çœŸå®DOMï¼Œä½†æ˜¯ç”¨æˆ·è¿˜æ²¡æœ‰çœ‹åˆ°UIæ›´æ–°ï¼ŒåŒæ­¥çš„ã€‚</li>
<li>useEffectä¸­çš„å‰¯ä½œç”¨å‡½æ•°ï¼Œæ›´æ”¹äº†çœŸå®DOMï¼Œå¹¶ä¸”ç”¨æˆ·å·²ç»çœ‹åˆ°äº†UIæ›´æ–°ï¼Œå¼‚æ­¥çš„ã€‚</li>
</ol>
</li>
<li><p>æ¯ä¸ªå‡½æ•°ç»„ä»¶ä¸­ï¼Œå¯ä»¥å¤šæ¬¡ä½¿ç”¨useEffectï¼Œä½†ä¸è¦æ”¾å…¥åˆ¤æ–­æˆ–å¾ªç¯ç­‰ä»£ç å—ä¸­ã€‚</p>
</li>
<li><p>useEffectä¸­çš„å‰¯ä½œç”¨å‡½æ•°ï¼Œå¯ä»¥æœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å«åšæ¸…ç†å‡½æ•°</p>
<ol>
<li>è¯¥å‡½æ•°è¿è¡Œæ—¶é—´ç‚¹ï¼Œåœ¨æ¯æ¬¡è¿è¡Œå‰¯ä½œç”¨å‡½æ•°ä¹‹å‰</li>
<li>é¦–æ¬¡æ¸²æŸ“ç»„ä»¶ä¸ä¼šè¿è¡Œ</li>
<li>ç»„ä»¶è¢«é”€æ¯æ—¶ä¸€å®šä¼šè¿è¡Œ</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å‰¯ä½œç”¨å‡½æ•°&#x27;</span>);</span><br><span class="line">    <span class="title function_">stop</span>(); <span class="comment">// æ¸…ç†å®šæ—¶å™¨å‡½æ•°</span></span><br><span class="line">    <span class="comment">// æ¸²æŸ“å®Œæˆå</span></span><br><span class="line">    <span class="keyword">const</span> div = ref.<span class="property">current</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(div);</span><br><span class="line">    <span class="keyword">let</span> curTimes = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">const</span> disX = props.<span class="property">left</span> / <span class="number">100</span>; <span class="comment">// æ¨ªåæ ‡æ¯æ¬¡ç§»åŠ¨çš„è·ç¦»</span></span><br><span class="line">    <span class="keyword">const</span> disY = props.<span class="property">top</span> / <span class="number">100</span>; <span class="comment">// çºµåæ ‡æ¯æ¬¡ç§»åŠ¨çš„è·ç¦»</span></span><br><span class="line">    timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      curTimes++;</span><br><span class="line">      <span class="keyword">const</span> newLeft = curTimes * disX;</span><br><span class="line">      <span class="keyword">const</span> newTop = curTimes * disY;</span><br><span class="line">      div.<span class="property">style</span>.<span class="property">left</span> = newLeft + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">      div.<span class="property">style</span>.<span class="property">top</span> = newTop + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">      <span class="keyword">if</span> (curTimes === <span class="number">1000</span>) &#123;</span><br><span class="line">        <span class="title function_">stop</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;return&#x27;</span>);</span><br><span class="line">      <span class="title function_">stop</span>(); <span class="comment">// æ¸…ç†å®šæ—¶å™¨å‡½æ•°</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>useEffectå‡½æ•°ï¼Œå¯ä»¥ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°</p>
<ol>
<li>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„</li>
<li>æ•°ç»„ä¸­è®°å½•è¯¥å‰¯ä½œç”¨çš„ä¾èµ–æ•°æ®</li>
<li>å½“ç»„ä»¶é‡æ–°æ¸²æŸ“åï¼Œåªæœ‰ä¾èµ–æ•°æ®ä¸ä¸Šä¸€æ¬¡ä¸ä¸€æ ·çš„æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œå‰¯ä½œç”¨</li>
<li>æ‰€ä»¥ï¼Œå½“ä¼ é€’äº†ä¾èµ–æ•°æ®ä¹‹åï¼Œå¦‚æœæ•°æ®æ²¡æœ‰å‘ç”Ÿå˜åŒ–<ol>
<li>å‰¯ä½œç”¨å‡½æ•°ä»…åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“åè¿è¡Œ</li>
<li>æ¸…ç†å‡½æ•°ä»…åœ¨å¸è½½ç»„ä»¶åè¿è¡Œ</li>
</ol>
</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸ªä¾‹å­æ˜¯è¾“å…¥ä¸¤ä¸ªåæ ‡ï¼Œç‚¹å‡»ç¡®å®šåå…ƒç´ ç§»åŠ¨ï¼Œå½“å¤šæ¬¡ç‚¹å‡»ç¡®å®šæ—¶åæ ‡ä¸ä¸€è‡´æ‰é‡æ–°ç§»åŠ¨ï¼Œè¿™é‡Œå°±é€šè¿‡ç¬¬äºŒä¸ªå‚æ•°çš„ä¾èµ–é¡¹å†³å®šæ˜¯å¦æ‰§è¡Œå‰¯ä½œç”¨å‡½æ•°</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å‰¯ä½œç”¨å‡½æ•°&#x27;</span>);</span><br><span class="line">    <span class="title function_">stop</span>();</span><br><span class="line">    <span class="comment">// æ¸²æŸ“å®Œæˆå</span></span><br><span class="line">    <span class="keyword">const</span> div = ref.<span class="property">current</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(div);</span><br><span class="line">    <span class="keyword">let</span> curTimes = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">const</span> disX = props.<span class="property">left</span> / <span class="number">1000</span>; <span class="comment">// æ¨ªåæ ‡æ¯æ¬¡ç§»åŠ¨çš„è·ç¦»</span></span><br><span class="line">    <span class="keyword">const</span> disY = props.<span class="property">top</span> / <span class="number">1000</span>; <span class="comment">// çºµåæ ‡æ¯æ¬¡ç§»åŠ¨çš„è·ç¦»</span></span><br><span class="line">    timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      curTimes++;</span><br><span class="line">      <span class="keyword">const</span> newLeft = curTimes * disX;</span><br><span class="line">      <span class="keyword">const</span> newTop = curTimes * disY;</span><br><span class="line">      div.<span class="property">style</span>.<span class="property">left</span> = newLeft + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">      div.<span class="property">style</span>.<span class="property">top</span> = newTop + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">      <span class="keyword">if</span> (curTimes === <span class="number">1000</span>) &#123;</span><br><span class="line">        <span class="title function_">stop</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;return&#x27;</span>);</span><br><span class="line">      <span class="title function_">stop</span>();</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, [props.<span class="property">left</span>, props.<span class="property">top</span>]);</span><br></pre></td></tr></table></figure>
</li>
<li><p>å‰¯ä½œç”¨å‡½æ•°ä¸­ï¼Œå¦‚æœä½¿ç”¨äº†å‡½æ•°ä¸Šä¸‹æ–‡ä¸­çš„å˜é‡ï¼Œåˆ™ç”±äºé—­åŒ…çš„å½±å“ï¼Œä¼šå¯¼è‡´å‰¯ä½œç”¨å‡½æ•°ä¸­å˜é‡ä¸ä¼šå®æ—¶å˜åŒ–ã€‚</p>
</li>
<li><p>å‰¯ä½œç”¨å‡½æ•°åœ¨æ¯æ¬¡æ³¨å†Œæ—¶ï¼Œä¼šè¦†ç›–æ‰ä¹‹å‰çš„å‰¯ä½œç”¨å‡½æ•°ï¼Œå› æ­¤ï¼Œå°½é‡ä¿æŒå‰¯ä½œç”¨å‡½æ•°ç¨³å®šï¼Œå¦åˆ™æ§åˆ¶èµ·æ¥ä¼šæ¯”è¾ƒå¤æ‚ã€‚</p>
</li>
</ol>
<h3 id="è‡ªå®šä¹‰Hook"><a href="#è‡ªå®šä¹‰Hook" class="headerlink" title="è‡ªå®šä¹‰Hook"></a>è‡ªå®šä¹‰Hook</h3><p>State Hookï¼š useState<br>Effect Hookï¼šuseEffect</p>
<p>è‡ªå®šä¹‰Hookï¼šå°†ä¸€äº›å¸¸ç”¨çš„ã€è·¨è¶Šå¤šä¸ªç»„ä»¶çš„HookåŠŸèƒ½ï¼ŒæŠ½ç¦»å‡ºå»å½¢æˆä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å°±æ˜¯è‡ªå®šä¹‰Hookï¼Œè‡ªå®šä¹‰Hookï¼Œç”±äºå…¶å†…éƒ¨éœ€è¦ä½¿ç”¨HookåŠŸèƒ½ï¼Œæ‰€ä»¥å®ƒæœ¬èº«ä¹Ÿéœ€è¦æŒ‰ç…§Hookçš„è§„åˆ™å®ç°ï¼š</p>
<ol>
<li>å‡½æ•°åå¿…é¡»ä»¥useå¼€å¤´</li>
<li>è°ƒç”¨è‡ªå®šä¹‰Hookå‡½æ•°æ—¶ï¼Œåº”è¯¥æ”¾åˆ°é¡¶å±‚</li>
</ol>
<p>ä¾‹å¦‚ï¼š</p>
<ol>
<li>å¾ˆå¤šç»„ä»¶éƒ½éœ€è¦åœ¨ç¬¬ä¸€æ¬¡åŠ è½½å®Œæˆåï¼Œè·å–æ‰€æœ‰å­¦ç”Ÿæ•°æ®</li>
<li>å¾ˆå¤šç»„ä»¶éƒ½éœ€è¦åœ¨ç¬¬ä¸€æ¬¡åŠ è½½å®Œæˆåï¼Œå¯åŠ¨ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œç„¶ååœ¨ç»„ä»¶é”€æ¯æ—¶å¸è½½</li>
</ol>
<blockquote>
<p>ä½¿ç”¨Hookçš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰ä¸¥æ ¼æŒ‰ç…§Hookçš„è§„åˆ™è¿›è¡Œï¼Œeslintçš„ä¸€ä¸ªæ’ä»¶ï¼ˆeslint-plugin-react-hooksï¼‰ä¼šæŠ¥å‡ºè­¦å‘Š</p>
</blockquote>
<h3 id="Context-Hook"><a href="#Context-Hook" class="headerlink" title="Context Hook"></a>Context Hook</h3><p>ç”¨äºè·å–ä¸Šä¸‹æ–‡æ•°æ®ï¼Œä½¿ç”¨<code>hook</code>å†™æ³•å¦‚ä¸‹</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ctx = <span class="title class_">React</span>.<span class="title function_">createContext</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Test</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> value = <span class="title function_">useContext</span>(ctx);</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>è¿™é‡Œæ˜¯Testï¼Œä¸Šä¸‹æ–‡çš„å€¼æ˜¯ï¼š&#123;value&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ctx.Provider</span> <span class="attr">value</span>=<span class="string">&#x27;abc&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Test</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ctx.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœç”¨ä¹‹å‰çš„å†™æ³•å¯èƒ½éœ€è¦ä½¿ç”¨<code>ctx.Consumer</code>ï¼Œå¦‚ä¸‹</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ctx = <span class="title class_">React</span>.<span class="title function_">createContext</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Test</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">ctx.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;(value) =&gt; <span class="tag">&lt;<span class="name">h1</span>&gt;</span>è¿™é‡Œæ˜¯Testï¼Œä¸Šä¸‹æ–‡çš„å€¼æ˜¯ï¼š&#123;value&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ctx.Consumer</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ctx.Provider</span> <span class="attr">value</span>=<span class="string">&#x27;abc&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Test</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ctx.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Callback-Hook"><a href="#Callback-Hook" class="headerlink" title="Callback Hook"></a>Callback Hook</h3><h4 id="ä½¿ç”¨Callback-Hookå‰å› "><a href="#ä½¿ç”¨Callback-Hookå‰å› " class="headerlink" title="ä½¿ç”¨Callback Hookå‰å› "></a>ä½¿ç”¨Callback Hookå‰å› </h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çº¯ç»„ä»¶è¿›è¡Œæµ…æ¯”è¾ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Test Render&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Testç±»ç»„ä»¶<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;this.props.text&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.props.onClick&#125;</span>&gt;</span>æ”¹å˜æ–‡æœ¬<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Parent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;parent render&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [txt, setTxt] = <span class="title function_">useState</span>(<span class="number">123</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [n, setN] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å³ä½¿Testç»„ä»¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯inputå‘ç”Ÿå˜åŒ–åå¯¼è‡´Parentå‡½æ•°é‡æ–°è¿è¡Œï¼Œ</span></span><br><span class="line"><span class="comment">   * å¯¼è‡´å‡½æ•°åœ°å€æ¯æ¬¡æ¸²æŸ“éƒ½å‘ç”Ÿäº†å˜åŒ–ï¼Œä»è€Œå¯¼è‡´äº†è‡ªç»„ä»¶è·Ÿç€é‡æ–°æ¸²æŸ“ï¼Œè‹¥å­ç»„ä»¶</span></span><br><span class="line"><span class="comment">   * æ˜¯ç»è¿‡ä¼˜åŒ–çš„ç»„ä»¶ï¼Œåˆ™å¯èƒ½å¯¼è‡´ä¼˜åŒ–å¤±æ•ˆ</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Test</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">text</span>=<span class="string">&#123;txt&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          setTxt(123);</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">type</span>=<span class="string">&#x27;number&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">value</span>=<span class="string">&#123;n&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          setN(parseInt(e.target.value));</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      /&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Parent</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><p>å‡½æ•°åï¼šuseCallback</p>
<p>ç”¨äºå¾—åˆ°ä¸€ä¸ªå›ºå®šå¼•ç”¨å€¼çš„å‡½æ•°ï¼Œé€šå¸¸ç”¨å®ƒè¿›è¡Œæ€§èƒ½ä¼˜åŒ–</p>
<p>useCallback:</p>
<p>è¯¥å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼š</p>
<ol>
<li>å‡½æ•°ï¼ŒuseCallbackä¼šå›ºå®šè¯¥å‡½æ•°çš„å¼•ç”¨ï¼Œåªè¦ä¾èµ–é¡¹æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œåˆ™å§‹ç»ˆè¿”å›ä¹‹å‰å‡½æ•°çš„åœ°å€</li>
<li>æ•°ç»„ï¼Œè®°å½•ä¾èµ–é¡¹</li>
</ol>
<p>è¯¥å‡½æ•°è¿”å›ï¼šå¼•ç”¨ç›¸å¯¹å›ºå®šçš„å‡½æ•°åœ°å€</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useCallback &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çº¯ç»„ä»¶è¿›è¡Œæµ…æ¯”è¾ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Test Render&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Testç±»ç»„ä»¶<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;this.props.text&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.props.onClick&#125;</span>&gt;</span>æ”¹å˜æ–‡æœ¬<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Parent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;parent render&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [txt, setTxt] = <span class="title function_">useState</span>(<span class="number">123</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [n, setN] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å›ºå®šå‡½æ•°å¼•ç”¨åœ°å€ï¼Œåªè¦ä¾èµ–é¡¹æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå°±ä½¿ç”¨ä»¥å‰çš„åœ°å€</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">const</span> handleClick = <span class="title function_">useCallback</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setTxt</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>());</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Test</span> <span class="attr">text</span>=<span class="string">&#123;txt&#125;</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">type</span>=<span class="string">&#x27;number&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">value</span>=<span class="string">&#123;n&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          setN(parseInt(e.target.value));</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      /&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Parent</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Memo-Hook"><a href="#Memo-Hook" class="headerlink" title="Memo Hook"></a>Memo Hook</h3><p>ç”¨äºä¿æŒä¸€äº›æ¯”è¾ƒç¨³å®šçš„æ•°æ®ï¼Œé€šå¸¸ç”¨äºæ€§èƒ½ä¼˜åŒ–</p>
<p><strong>å¦‚æœReactå…ƒç´ æœ¬èº«çš„å¼•ç”¨æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä¸€å®šä¸ä¼šé‡æ–°æ¸²æŸ“</strong></p>
<p>ä¸Šé¢è¯´åˆ°ä½¿ç”¨useCallbackï¼Œè¿™é‡Œå°†ä¸¤ä¸ªæ–¹æ³•åšå¯¹æ¯”ï¼Œä»¥ä¸‹æ˜¯ä½¿ç”¨useMemoçš„ç”¨æ³•</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çº¯ç»„ä»¶è¿›è¡Œæµ…æ¯”è¾ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Test Render&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Testç±»ç»„ä»¶<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;this.props.text&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.props.onClick&#125;</span>&gt;</span>æ”¹å˜æ–‡æœ¬<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Parent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;parent render&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [txt, setTxt] = <span class="title function_">useState</span>(<span class="number">123</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [n, setN] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å›ºå®šå‡½æ•°å¼•ç”¨åœ°å€ï¼Œåªè¦ä¾èµ–é¡¹æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå°±ä½¿ç”¨ä»¥å‰çš„åœ°å€</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">const</span> handleClick = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setTxt</span>(txt + <span class="number">1</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, [txt]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Test</span> <span class="attr">text</span>=<span class="string">&#123;txt&#125;</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">type</span>=<span class="string">&#x27;number&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">value</span>=<span class="string">&#123;n&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          setN(parseInt(e.target.value));</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      /&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Parent</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åŒºåˆ«äºuseCallbackï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setTxt</span>(txt + <span class="number">1</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, [txt]);</span><br></pre></td></tr></table></figure>

<p>useCallbackè¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°åœ°å€ï¼ŒuseMemoè¿”å›çš„æ˜¯ä¸€ä¸ªè°ƒç”¨çš„å‡½æ•°å†…å®¹,</p>
<p>ä¾‹å¦‚ï¼Œè¦æ¸²æŸ“ä¸€ä¸ª10000ä¸ªåˆ—è¡¨ï¼ŒæŸä¸ªåœ°æ–¹å‘ç”Ÿäº†å˜åŒ–ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨useMemoï¼Œå¦‚æœä¾èµ–é¡¹æ²¡æœ‰å˜åŒ–åˆ™ä¸ä¼šé‡æ–°æ¸²æŸ“ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Item</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Item render&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;props.value&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [range] = <span class="title function_">useState</span>(&#123; <span class="attr">min</span>: <span class="number">1</span>, <span class="attr">max</span>: <span class="number">1000</span> &#125;);</span><br><span class="line">  <span class="keyword">const</span> [n, setN] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> list = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> list = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = range.<span class="property">min</span>; i &lt;= range.<span class="property">max</span>; i++) &#123;</span><br><span class="line">      list.<span class="title function_">push</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Item</span> <span class="attr">key</span>=<span class="string">&#123;i&#125;</span> <span class="attr">value</span>=<span class="string">&#123;i&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Item</span>&gt;</span></span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">  &#125;, [range.<span class="property">min</span>, range.<span class="property">max</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">type</span>=<span class="string">&#x27;number&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">value</span>=<span class="string">&#123;n&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          setN(parseInt(e.target.value));</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;list&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span>;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Ref-Hook"><a href="#Ref-Hook" class="headerlink" title="Ref Hook"></a>Ref Hook</h3><p>useRefå‡½æ•°ï¼š</p>
<ol>
<li>ä¸€ä¸ªå‚æ•°ï¼šé»˜è®¤å€¼</li>
<li>è¿”å›ä¸€ä¸ªå›ºå®šçš„å¯¹è±¡ï¼Œ<code>&#123;current: å€¼&#125;</code></li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useRef, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> inpRef = <span class="title function_">useRef</span>(); <span class="comment">// é€šè¿‡useRefè·å–å…ƒç´ å±æ€§å€¼ç­‰</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [n, setN] = <span class="title function_">useState</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> nRef = <span class="title function_">useRef</span>(n); <span class="comment">// &#123;current: 10&#125; é€šè¿‡useRefè®¾ç½®ä¸€ä¸ªå›ºå®šå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      nRef.<span class="property">current</span>--;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">setN</span>(nRef.<span class="property">current</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (nRef.<span class="property">current</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inpRef&#125;</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          console.log(&#x27;Inputçš„å€¼&#x27;, inpRef.current.value);</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        å¾—åˆ°inputçš„å€¼</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;n&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¦‚æœæˆ‘ä»¬éœ€è¦ä¸€ä¸ªçŠ¶æ€ï¼Œè€Œä¸”è¿™ä¸ªçŠ¶æ€çš„æ”¹å˜ä¸èƒ½è§¦å‘ç»„ä»¶çš„renderï¼Œä¾‹å¦‚ï¼šdom, æœ¬åœ°å­˜å‚¨ç­‰ç­‰ï¼Œé‚£æˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨refå¯¹è±¡å»å‚¨å­˜å®ƒ</p>
<h3 id="ImperativeHandle-Hook"><a href="#ImperativeHandle-Hook" class="headerlink" title="ImperativeHandle Hook"></a>ImperativeHandle Hook</h3><p>å‡½æ•°ï¼šuseImperativeHandleHook</p>
<p>æ¯”å¦‚è¦é€šè¿‡refä½¿ç”¨å­å‡½æ•°ç»„ä»¶ä¸­çš„æŸä¸ªæ–¹æ³•ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡useImperativeHandleå’Œrefï¼Œå°†æ–¹æ³•åœ¨é¡¶å±‚é€šè¿‡ref.currentè·å–å¹¶æ‰§è¡Œï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useImperativeHandle, useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Test</span>(<span class="params">props, ref</span>) &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * useImperativeHandleç¬¬äºŒä¸ªå‚æ•°æ˜¯ç»™ref.currentå‚æ•°èµ‹ä¸ªå€¼</span></span><br><span class="line"><span class="comment">   * ç›¸å½“äºç»™</span></span><br><span class="line"><span class="comment">   * ref.current = &#123;</span></span><br><span class="line"><span class="comment">   *  method: method() &#123;</span></span><br><span class="line"><span class="comment">   *      console.log(&#x27;Test method called&#x27;);</span></span><br><span class="line"><span class="comment">   *  &#125;</span></span><br><span class="line"><span class="comment">   * &#125;</span></span><br><span class="line"><span class="comment">   * å¦‚æœä¸ç»™ä¾èµ–é¡¹ï¼Œåˆ™æ¯æ¬¡è¿è¡Œå‡½æ•°ç»„ä»¶éƒ½ä¼šè°ƒç”¨è¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">   * å¦‚æœä½¿ç”¨äº†ä¾èµ–é¡¹ï¼Œåˆ™ç¬¬ä¸€æ¬¡è°ƒç”¨åï¼Œä¼šè¿›è¡Œç¼“å­˜ï¼Œåªæœ‰ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šé‡æ–°è°ƒç”¨ï¼Œ</span></span><br><span class="line"><span class="comment">   * å¦‚ä¸‹é¢ï¼Œå¢åŠ ä¾èµ–é¡¹[]åâ€œ......xâ€åªä¼šæ‰“å°ä¸€æ¬¡</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">useImperativeHandle</span>(</span><br><span class="line">    ref,</span><br><span class="line">    <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;......x&#x27;</span>);</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="title function_">method</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Test method called&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    []</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Test Component<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ç»„ä»¶ä¸Šçš„reféœ€è¦åšè½¬å‘</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TestWrapper</span> = <span class="title class_">React</span>.<span class="title function_">forwardRef</span>(<span class="title class_">Test</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> testRef = <span class="title function_">useRef</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">TestWrapper</span> <span class="attr">ref</span>=<span class="string">&#123;testRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          testRef.current.method();</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        æ‰§è¡ŒTestå‡½æ•°ç»„ä»¶ä¸­çš„methodæ–¹æ³•</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="LayoutEffect-Hook"><a href="#LayoutEffect-Hook" class="headerlink" title="LayoutEffect Hook"></a>LayoutEffect Hook</h3><p>useEffectï¼šæµè§ˆå™¨æ¸²æŸ“å®Œæˆåï¼Œç”¨æˆ·çœ‹åˆ°æ–°çš„æ¸²æŸ“ç»“æœä¹‹å</p>
<ul>
<li>å¯èƒ½å‡ºç°ï¼šæŸä¸ªdomæ“ä½œå·²ç»å®Œæˆäº†æ¸²æŸ“ï¼Œå› ä¸ºuseEffectä¸­çš„å‰¯ä½œç”¨æ“ä½œæ˜¯åœ¨æ¸²æŸ“å®Œæˆåæ‰§è¡Œï¼Œå¦‚æœåœ¨è¿™é‡Œä½¿ç”¨äº†æ–°çš„domæ“ä½œï¼Œå°±ä¼šå¯¼è‡´ç•Œé¢å¯èƒ½å‡ºç°å¿«é€Ÿçš„é—ªçƒæ•ˆæœ</li>
</ul>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [n, setN] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> h1Ref = <span class="title function_">useRef</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    h1Ref.<span class="property">current</span>.<span class="property">innerText</span> = <span class="title class_">Math</span>.<span class="title function_">random</span>().<span class="title function_">toFixed</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;random&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span> <span class="attr">ref</span>=<span class="string">&#123;h1Ref&#125;</span>&gt;</span>&#123;n&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          setN(n + 1);</span></span><br><span class="line"><span class="language-xml">          console.log(&#x27;+1&#x27;, n);</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        +1</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>useLayoutEffectï¼šå®Œæˆäº†DOMæ”¹åŠ¨ï¼Œä½†è¿˜æ²¡æœ‰å‘ˆç°ç»™ç”¨æˆ·ï¼Œè¿™ä¸ªhookä½¿ç”¨æ–¹æ³•å’ŒuseEffectä¸€æ ·ï¼Œåªæ˜¯æ‰§è¡Œæ—¶é—´åœ¨æ¸²æŸ“å‘ç”Ÿå‰ã€‚</p>
<p><strong>ç»“è®º</strong>ï¼šåº”è¯¥å°½é‡ä½¿ç”¨useEffectï¼Œå› ä¸ºå®ƒä¸ä¼šå¯¼è‡´æ¸²æŸ“é˜»å¡ï¼Œå¦‚æœå‡ºç°äº†é—®é¢˜ï¼Œå†è€ƒè™‘ä½¿ç”¨useLayoutEffectHook</p>
<h3 id="DebugValue-Hook"><a href="#DebugValue-Hook" class="headerlink" title="DebugValue Hook"></a>DebugValue Hook</h3><p>useDebugValueï¼šç”¨äºå°†è‡ªå®šä¹‰Hookçš„å…³è”æ•°æ®æ˜¾ç¤ºåˆ°è°ƒè¯•æ </p>
<p>å¦‚æœåˆ›å»ºçš„è‡ªå®šä¹‰Hooké€šç”¨æ€§æ¯”è¾ƒé«˜ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨useDebugValueæ–¹ä¾¿è°ƒè¯•</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState,   , useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useStudent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [students] = <span class="title function_">useState</span>([&#123; <span class="number">1</span>: <span class="string">&#x27;yeager&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;mikasa&#x27;</span> &#125;]);</span><br><span class="line">  <span class="title function_">useDebugValue</span>(<span class="string">&#x27;å­¦ç”Ÿé›†åˆ&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> students;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="title function_">useState</span>(<span class="string">&#x27;yeager&#x27;</span>);</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;useEffect&#x27;</span>);</span><br><span class="line">  &#125;, []);</span><br><span class="line">  <span class="title function_">useStudent</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>React Container<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="ReactåŠ¨ç”»"><a href="#ReactåŠ¨ç”»" class="headerlink" title="ReactåŠ¨ç”»"></a>ReactåŠ¨ç”»</h2><p>ReactåŠ¨ç”»åº“ï¼šreact-transition-group</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add react-transition-group</span><br></pre></td></tr></table></figure>

<h3 id="Transition"><a href="#Transition" class="headerlink" title="Transition"></a>Transition</h3><p><a target="_blank" rel="noopener" href="https://reactcommunity.org/react-transition-group/transition">https://reactcommunity.org/react-transition-group/transition</a></p>
<p>æ–‡æ¡£ä¸­æœ‰å„ä¸ªå˜åŒ–é˜¶æ®µçš„å›è°ƒå‡½æ•°çš„è°ƒç”¨æ–¹æ³•</p>
<h3 id="CSSTransition"><a href="#CSSTransition" class="headerlink" title="CSSTransition"></a>CSSTransition</h3><p><a target="_blank" rel="noopener" href="https://reactcommunity.org/react-transition-group/css-transition">https://reactcommunity.org/react-transition-group/css-transition</a></p>
<p>å½“è¿›å…¥æ—¶ï¼Œå‘ç”Ÿï¼š</p>
<ol>
<li>ä¸ºCSSTransitionå†…éƒ¨çš„DOMæ ¹å…ƒç´ ï¼ˆåç»­ç»Ÿä¸€ç§°ä¹‹ä¸ºDOMå…ƒç´ ï¼‰æ·»åŠ æ ·å¼enter</li>
<li>åœ¨ä¸€ä¸‹å¸§(enteræ ·å¼å·²ç»å®Œå…¨åº”ç”¨åˆ°äº†å…ƒç´ )ï¼Œç«‹å³ä¸ºè¯¥å…ƒç´ æ·»åŠ æ ·å¼enter-active</li>
<li>å½“timeoutç»“æŸåï¼Œå»æ‰ä¹‹å‰çš„æ ·å¼ï¼Œæ·»åŠ æ ·å¼enter-done</li>
</ol>
<p>å½“é€€å‡ºæ—¶ï¼Œå‘ç”Ÿï¼š</p>
<ol>
<li>ä¸ºCSSTransitionå†…éƒ¨çš„DOMæ ¹å…ƒç´ ï¼ˆåç»­ç»Ÿä¸€ç§°ä¹‹ä¸ºDOMå…ƒç´ ï¼‰æ·»åŠ æ ·å¼exit</li>
<li>åœ¨ä¸€ä¸‹å¸§(exitæ ·å¼å·²ç»å®Œå…¨åº”ç”¨åˆ°äº†å…ƒç´ )ï¼Œç«‹å³ä¸ºè¯¥å…ƒç´ æ·»åŠ æ ·å¼exit-active</li>
<li>å½“timeoutç»“æŸåï¼Œå»æ‰ä¹‹å‰çš„æ ·å¼ï¼Œæ·»åŠ æ ·å¼exit-done</li>
</ol>
<p>è®¾ç½®classNameså±æ€§ï¼Œå¯ä»¥æŒ‡å®šç±»æ ·å¼çš„åç§°</p>
<ol>
<li><p>å­—ç¬¦ä¸²ï¼šä¸ºç±»æ ·å¼æ·»åŠ å‰ç¼€</p>
<ol>
<li><pre><code class="js">classNames=&#123;&#123;
       appear: 'my-appear',
       appearActive: 'my-active-appear',
       appearDone: 'my-done-appear',
       enter: 'my-enter',
       enterActive: 'my-active-enter',
       enterDone: 'my-done-enter',
       exit: 'my-exit',
       exitActive: 'my-active-exit',
       exitDone: 'my-done-exit',
      &#125;&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. å¯¹è±¡ï¼šä¸ºæ¯ä¸ªç±»æ ·å¼æŒ‡å®šå…·ä½“çš„åç§°ï¼ˆéå‰ç¼€ï¼‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å…³äºé¦–æ¬¡æ¸²æŸ“æ—¶çš„ç±»æ ·å¼ï¼Œappearã€apear-activeã€apear-doneï¼Œå®ƒå’Œenterçš„å”¯ä¸€åŒºåˆ«åœ¨äºå®Œæˆæ—¶ï¼Œä¼šåŒæ—¶åŠ å…¥apear-doneå’Œenter-done</span><br><span class="line"></span><br><span class="line">è¿˜å¯ä»¥ä¸Animate.cssè”ç”¨</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ol>
</li>
</ol>
<p>yarn add animate.css</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```jsx</span><br><span class="line">import React, &#123; useState &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123; CSSTransition &#125; from &#x27;react-transition-group&#x27;;</span><br><span class="line">import &#x27;./App3.css&#x27;;</span><br><span class="line">import &#x27;animate.css&#x27;;</span><br><span class="line"></span><br><span class="line">function MyTransition(&#123; visible, children &#125;) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;CSSTransition</span><br><span class="line">      appear</span><br><span class="line">      mountOnEnter</span><br><span class="line">      in=&#123;visible&#125;</span><br><span class="line">      timeout=&#123;1000&#125;</span><br><span class="line">      classNames=&#123;&#123;</span><br><span class="line">        exitActive: &#x27;animate__bounceOutLeft&#x27;,</span><br><span class="line">        exitDone: &#x27;exit-done&#x27;,</span><br><span class="line">        enterActive: &#x27;animate__bounceInRight&#x27;,</span><br><span class="line">        appearActive: &#x27;animate__bounceInRight&#x27;</span><br><span class="line">      &#125;&#125;</span><br><span class="line">    &gt;</span><br><span class="line">      &#123;children&#125;</span><br><span class="line">    &lt;/CSSTransition&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Comp1() &#123;</span><br><span class="line">  return &lt;h1 className=&#x27;title animate__animated fast&#x27;&gt;ç»„ä»¶1&lt;/h1&gt;;</span><br><span class="line">&#125;</span><br><span class="line">function Comp2() &#123;</span><br><span class="line">  return &lt;h1 className=&#x27;title animate__animated fast&#x27;&gt;ç»„ä»¶2&lt;/h1&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default function App() &#123;</span><br><span class="line">  const [showComp1, setShowComp1] = useState(true);</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&#x27;container&#x27;&gt;</span><br><span class="line">      &lt;div className=&#x27;comp-container&#x27;&gt;</span><br><span class="line">        &lt;MyTransition visible=&#123;showComp1&#125;&gt;</span><br><span class="line">          &lt;Comp1 /&gt;</span><br><span class="line">        &lt;/MyTransition&gt;</span><br><span class="line">        &lt;MyTransition visible=&#123;!showComp1&#125;&gt;</span><br><span class="line">          &lt;Comp2 /&gt;</span><br><span class="line">        &lt;/MyTransition&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;button</span><br><span class="line">        onClick=&#123;() =&gt; &#123;</span><br><span class="line">          setShowComp1(!showComp1);</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      &gt;</span><br><span class="line">        åˆ‡æ¢æ˜¾ç¤ºçŠ¶æ€</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="SwitchTransition"><a href="#SwitchTransition" class="headerlink" title="SwitchTransition"></a>SwitchTransition</h3><p><a target="_blank" rel="noopener" href="https://reactcommunity.org/react-transition-group/switch-transition">https://reactcommunity.org/react-transition-group/switch-transition</a></p>
<p>ç”¨äºæœ‰ç§©åºåœ°åˆ‡æ¢å†…éƒ¨ç»„ä»¶</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼šout-in</p>
<ol>
<li>å½“keyå€¼æ”¹å˜æ—¶ï¼Œä¼šå°†ä¹‹å‰çš„DOMæ ¹å…ƒç´ æ·»åŠ é€€å‡ºæ ·å¼ï¼ˆexit,exit-active)</li>
<li>é€€å‡ºå®Œæˆåï¼Œå°†è¯¥DOMå…ƒç´ ç§»é™¤</li>
<li>é‡æ–°æ¸²æŸ“å†…éƒ¨DOMå…ƒç´ </li>
<li>ä¸ºæ–°æ¸²æŸ“çš„DOMæ ¹å…ƒç´ æ·»åŠ è¿›å…¥æ ·å¼(enter, enter-active, enter-done)</li>
</ol>
<p>in-out:</p>
<ol>
<li>é‡æ–°æ¸²æŸ“å†…éƒ¨DOMå…ƒç´ ï¼Œä¿ç•™ä¹‹å‰çš„å…ƒç´ </li>
<li>ä¸ºæ–°æ¸²æŸ“çš„DOMæ ¹å…ƒç´ æ·»åŠ è¿›å…¥æ ·å¼(enter, enter-active, enter-done)</li>
<li>å°†ä¹‹å‰çš„DOMæ ¹å…ƒç´ æ·»åŠ é€€å‡ºæ ·å¼ï¼ˆexit,exit-active)</li>
<li>é€€å‡ºå®Œæˆåï¼Œå°†è¯¥DOMå…ƒç´ ç§»é™¤</li>
</ol>
<blockquote>
<p>è¯¥åº“å¯»æ‰¾domå…ƒç´ çš„æ–¹å¼ï¼Œæ˜¯ä½¿ç”¨å·²ç»è¿‡æ—¶çš„APIï¼šfindDomNodeï¼Œè¯¥æ–¹æ³•å¯ä»¥æ‰¾åˆ°æŸä¸ªç»„ä»¶ä¸‹çš„DOMæ ¹å…ƒç´ </p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">SwitchTransition</span>, <span class="title class_">CSSTransition</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-transition-group&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./App.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [show1, setShow1] = <span class="title function_">useState</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">SwitchTransition</span> <span class="attr">mode</span>=<span class="string">&#x27;in-out&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">CSSTransition</span> <span class="attr">timeout</span>=<span class="string">&#123;1000&#125;</span> <span class="attr">key</span>=<span class="string">&#123;show1&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;show1 ? &#x27;title1&#x27; : &#x27;title2&#x27;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">CSSTransition</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">SwitchTransition</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          setShow1(!show1);</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        åˆ‡æ¢</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¼•å…¥animate.csså¯ä»¥ç±»ä¼¼å¦‚ä¸‹ä½¿ç”¨</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">SwitchTransition</span>, <span class="title class_">CSSTransition</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-transition-group&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./AppAnimate.css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;animate.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [show1, setShow1] = <span class="title function_">useState</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;container&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">SwitchTransition</span> <span class="attr">mode</span>=<span class="string">&#x27;out-in&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">CSSTransition</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">appear</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">timeout</span>=<span class="string">&#123;1000&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">key</span>=<span class="string">&#123;show1&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">classNames</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">exit:</span> &#x27;<span class="attr">animate__slideOutLeft</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">enter:</span> &#x27;<span class="attr">animate__slideInRight</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">appearActive:</span> &#x27;<span class="attr">animate__slideInRight</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h1</span> <span class="attr">className</span>=<span class="string">&#x27;animate__animated fast&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;show1 ? &#x27;title1&#x27; : &#x27;title2&#x27;&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">CSSTransition</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">SwitchTransition</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          setShow1(!show1);</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        åˆ‡æ¢</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="TransitionGroup"><a href="#TransitionGroup" class="headerlink" title="TransitionGroup"></a>TransitionGroup</h3><p>è¯¥ç»„ä»¶çš„childrenï¼Œæ¥æ”¶å¤šä¸ªTransitionæˆ–CSSTransitionç»„ä»¶ï¼Œè¯¥ç»„ä»¶ç”¨äºæ ¹æ®è¿™äº›å­ç»„ä»¶çš„keyå€¼ï¼Œæ§åˆ¶ä»–ä»¬çš„è¿›å…¥å’Œé€€å‡ºçŠ¶æ€</p>
<p>appearåŒä¸Šé¢ç”¨æ³•ï¼Œå¯ä»¥è®¾ç½®é¦–æ¬¡æ¸²æŸ“æ—¶çš„åŠ¨ç”»ï¼›</p>
<p>componentå¯ä»¥è®¾ç½®åŒ…è£¹childrenæ—¶çš„å¤–å±‚å…ƒç´ ï¼›</p>
<p>classnameå¯ä»¥è®¾ç½®ä¸Šé¢çš„å¤–å±‚å…ƒç´ çš„ç±»åï¼›</p>
<p>å…·ä½“ä½¿ç”¨å¦‚ä¸‹ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; v4 <span class="keyword">as</span> uuidv4 &#125; <span class="keyword">from</span> <span class="string">&#x27;uuid&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">TransitionGroup</span>, <span class="title class_">CSSTransition</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-transition-group&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./App.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [tasksList, setTasksList] = <span class="title function_">useState</span>([</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="title function_">uuidv4</span>(), <span class="attr">name</span>: <span class="string">&#x27;ä»»åŠ¡1&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="title function_">uuidv4</span>(), <span class="attr">name</span>: <span class="string">&#x27;ä»»åŠ¡2&#x27;</span> &#125;</span><br><span class="line">  ]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">TransitionGroup</span> <span class="attr">appear</span> <span class="attr">component</span>=<span class="string">&#x27;ul&#x27;</span> <span class="attr">classname</span>=<span class="string">&#x27;abc&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;tasksList.map((item, index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">CSSTransition</span> <span class="attr">timeout</span>=<span class="string">&#123;3000&#125;</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;item.name&#125;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                  <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                    setTasksList(</span></span><br><span class="line"><span class="language-xml">                      tasksList.filter((it) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                        return it.id !== item.id;</span></span><br><span class="line"><span class="language-xml">                      &#125;)</span></span><br><span class="line"><span class="language-xml">                    );</span></span><br><span class="line"><span class="language-xml">                  &#125;&#125;</span></span><br><span class="line"><span class="language-xml">                &gt;</span></span><br><span class="line"><span class="language-xml">                  åˆ é™¤</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">CSSTransition</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          );</span></span><br><span class="line"><span class="language-xml">        &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">TransitionGroup</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          const name = window.prompt(&#x27;è¯·è¾“å…¥æ–°å¢ä»»åŠ¡åç§°&#x27;);</span></span><br><span class="line"><span class="language-xml">          setTasksList([...tasksList, &#123; id: uuidv4(), name &#125;]);</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        æ·»åŠ ä¸€ä¸ªä»»åŠ¡</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="å°è£…ä¸€ä¸ªæ·¡å…¥æ·¡å‡ºåŠ¨ç”»ç»„ä»¶"><a href="#å°è£…ä¸€ä¸ªæ·¡å…¥æ·¡å‡ºåŠ¨ç”»ç»„ä»¶" class="headerlink" title="å°è£…ä¸€ä¸ªæ·¡å…¥æ·¡å‡ºåŠ¨ç”»ç»„ä»¶"></a>å°è£…ä¸€ä¸ªæ·¡å…¥æ·¡å‡ºåŠ¨ç”»ç»„ä»¶</h3><p>è¯¦ç»†ä»£ç è§ï¼šâ€œè‡ªå®šä¹‰åŠ¨ç”»ç»„ä»¶â€åˆ†æ”¯</p>
<h2 id="React-Router-æ¦‚è¿°"><a href="#React-Router-æ¦‚è¿°" class="headerlink" title="React Router æ¦‚è¿°"></a>React Router æ¦‚è¿°</h2><p>Reactè·¯ç”±</p>
<h3 id="ç«™ç‚¹"><a href="#ç«™ç‚¹" class="headerlink" title="ç«™ç‚¹"></a>ç«™ç‚¹</h3><p>æ— è®ºæ˜¯ä½¿ç”¨Vueï¼Œè¿˜æ˜¯Reactï¼Œå¼€å‘çš„å•é¡µåº”ç”¨ç¨‹åºï¼Œå¯èƒ½åªæ˜¯è¯¥ç«™ç‚¹çš„ä¸€éƒ¨åˆ†ï¼ˆæŸä¸€ä¸ªåŠŸèƒ½å—ï¼‰</p>
<p>ä¸€ä¸ªå•é¡µåº”ç”¨é‡Œï¼Œå¯èƒ½ä¼šåˆ’åˆ†ä¸ºå¤šä¸ªé¡µé¢ï¼ˆå‡ ä¹å®Œå…¨ä¸åŒçš„é¡µé¢æ•ˆæœï¼‰ï¼ˆç»„ä»¶ï¼‰</p>
<p>å¦‚æœè¦åœ¨å•é¡µåº”ç”¨ä¸­å®Œæˆç»„ä»¶çš„åˆ‡æ¢ï¼Œéœ€è¦å®ç°ä¸‹é¢ä¸¤ä¸ªåŠŸèƒ½ï¼š</p>
<ol>
<li>æ ¹æ®ä¸åŒçš„é¡µé¢åœ°å€ï¼Œå±•ç¤ºä¸åŒçš„ç»„ä»¶ï¼ˆæ ¸å¿ƒï¼‰</li>
<li>å®Œæˆæ— åˆ·æ–°çš„åœ°å€åˆ‡æ¢</li>
</ol>
<p>æˆ‘ä»¬æŠŠå®ç°äº†ä»¥ä¸Šä¸¤ä¸ªåŠŸèƒ½çš„æ’ä»¶ï¼Œç§°ä¹‹ä¸ºè·¯ç”±</p>
<h3 id="React-Router"><a href="#React-Router" class="headerlink" title="React Router"></a>React Router</h3><ol>
<li>react-routerï¼šè·¯ç”±æ ¸å¿ƒåº“ï¼ŒåŒ…å«è¯¸å¤šå’Œè·¯ç”±åŠŸèƒ½ç›¸å…³çš„æ ¸å¿ƒä»£ç </li>
<li>react-router-domï¼šåˆ©ç”¨è·¯ç”±æ ¸å¿ƒåº“ï¼Œç»“åˆå®é™…çš„é¡µé¢ï¼Œå®ç°è·Ÿé¡µé¢è·¯ç”±å¯†åˆ‡ç›¸å…³çš„åŠŸèƒ½</li>
</ol>
<p>å¦‚æœæ˜¯åœ¨é¡µé¢ä¸­å®ç°è·¯ç”±ï¼Œéœ€è¦å®‰è£…react-router-domåº“</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add react-router-dom</span><br></pre></td></tr></table></figure>



<h2 id="è·¯ç”±ä¸¤ç§æ¨¡å¼"><a href="#è·¯ç”±ä¸¤ç§æ¨¡å¼" class="headerlink" title="è·¯ç”±ä¸¤ç§æ¨¡å¼"></a>è·¯ç”±ä¸¤ç§æ¨¡å¼</h2><p>è·¯ç”±ï¼šæ ¹æ®ä¸åŒçš„é¡µé¢åœ°å€ï¼Œå±•ç¤ºä¸åŒçš„ç»„ä»¶</p>
<p>urlåœ°å€ç»„æˆ</p>
<p>ä¾‹ï¼š<code>https://www.react.com:443/news/1-2-1.html?a=1&amp;b=2#abcdefg</code></p>
<ol>
<li>åè®®å(schema)ï¼šhttps</li>
<li>ä¸»æœºå(host)ï¼š<code>www.react.com</code><ol>
<li>ipåœ°å€</li>
<li>é¢„è®¾å€¼ï¼šlocalhost</li>
<li>åŸŸå</li>
<li>å±€åŸŸç½‘ä¸­ç”µè„‘åç§°</li>
</ol>
</li>
<li>ç«¯å£å·(port)ï¼š443<ol>
<li>å¦‚æœåè®®æ˜¯httpï¼Œç«¯å£å·æ˜¯80ï¼Œåˆ™å¯ä»¥çœç•¥ç«¯å£å·</li>
<li>å¦‚æœåè®®æ˜¯httpsï¼Œç«¯å£å·æ˜¯443ï¼Œåˆ™å¯ä»¥çœç•¥ç«¯å£å·</li>
</ol>
</li>
<li>è·¯å¾„(path)ï¼š&#x2F;news&#x2F;1-2-1.html</li>
<li>åœ°å€å‚æ•°(searchã€query)ï¼š?a&#x3D;1&amp;b&#x3D;2<ol>
<li>é™„å¸¦çš„æ•°æ®</li>
<li>æ ¼å¼ï¼šå±æ€§å&#x3D;å±æ€§å€¼&amp;å±æ€§å&#x3D;å±æ€§å€¼â€¦.</li>
</ol>
</li>
<li>å“ˆå¸Œ(hashã€é”šç‚¹)<ol>
<li>é™„å¸¦çš„æ•°æ®</li>
</ol>
</li>
</ol>
<h3 id="Hash-Router-å“ˆå¸Œè·¯ç”±"><a href="#Hash-Router-å“ˆå¸Œè·¯ç”±" class="headerlink" title="Hash Router å“ˆå¸Œè·¯ç”±"></a>Hash Router å“ˆå¸Œè·¯ç”±</h3><p>æ ¹æ®urlåœ°å€ä¸­çš„å“ˆå¸Œå€¼æ¥ç¡®å®šæ˜¾ç¤ºçš„ç»„ä»¶</p>
<blockquote>
<p>åŸå› ï¼šhashçš„å˜åŒ–ï¼Œä¸ä¼šå¯¼è‡´é¡µé¢åˆ·æ–°<br>è¿™ç§æ¨¡å¼çš„å…¼å®¹æ€§æœ€å¥½</p>
</blockquote>
<h3 id="Borswer-History-Router-æµè§ˆå™¨å†å²è®°å½•è·¯ç”±"><a href="#Borswer-History-Router-æµè§ˆå™¨å†å²è®°å½•è·¯ç”±" class="headerlink" title="Borswer History Router æµè§ˆå™¨å†å²è®°å½•è·¯ç”±"></a>Borswer History Router æµè§ˆå™¨å†å²è®°å½•è·¯ç”±</h3><p>HTML5å‡ºç°åï¼Œæ–°å¢äº†History Apiï¼Œä»æ­¤ä»¥åï¼Œæµè§ˆå™¨æ‹¥æœ‰äº†æ”¹å˜è·¯å¾„è€Œä¸åˆ·æ–°é¡µé¢çš„æ–¹å¼</p>
<p>Historyè¡¨ç¤ºæµè§ˆå™¨çš„å†å²è®°å½•ï¼Œå®ƒä½¿ç”¨æ ˆçš„æ–¹å¼å­˜å‚¨ã€‚</p>
<ol>
<li>history.lengthï¼šè·å–æ ˆä¸­æ•°æ®é‡</li>
<li>history.pushStateï¼šå‘å½“å‰å†å²è®°å½•æ ˆä¸­åŠ å…¥ä¸€æ¡æ–°çš„è®°å½•<ol>
<li>å‚æ•°1ï¼šé™„åŠ çš„æ•°æ®ï¼Œè‡ªå®šä¹‰çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯ä»»ä½•ç±»å‹</li>
<li>å‚æ•°2ï¼šé¡µé¢æ ‡é¢˜ï¼Œç›®å‰å¤§éƒ¨åˆ†æµè§ˆå™¨ä¸æ”¯æŒ</li>
<li>å‚æ•°3ï¼šæ–°çš„åœ°å€</li>
</ol>
</li>
<li>history.replaceStateï¼šå°†å½“å‰æŒ‡é’ˆæŒ‡å‘çš„å†å²è®°å½•ï¼Œæ›¿æ¢ä¸ºæŸä¸ªè®°å½•<ol>
<li>å‚æ•°1ï¼šé™„åŠ çš„æ•°æ®ï¼Œè‡ªå®šä¹‰çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯ä»»ä½•ç±»å‹</li>
<li>å‚æ•°2ï¼šé¡µé¢æ ‡é¢˜ï¼Œç›®å‰å¤§éƒ¨åˆ†æµè§ˆå™¨ä¸æ”¯æŒ</li>
<li>å‚æ•°3ï¼šæ–°çš„åœ°å€</li>
</ol>
</li>
</ol>
<p>æ ¹æ®é¡µé¢çš„è·¯å¾„å†³å®šæ¸²æŸ“å“ªä¸ªç»„ä»¶</p>
<h2 id="è·¯ç”±ç»„ä»¶"><a href="#è·¯ç”±ç»„ä»¶" class="headerlink" title="è·¯ç”±ç»„ä»¶"></a>è·¯ç”±ç»„ä»¶</h2><p>React-Router ä¸ºæˆ‘ä»¬æä¾›äº†ä¸¤ä¸ªé‡è¦ç»„ä»¶</p>
<h3 id="Routerç»„ä»¶"><a href="#Routerç»„ä»¶" class="headerlink" title="Routerç»„ä»¶"></a>Routerç»„ä»¶</h3><p>å®ƒæœ¬èº«ä¸åšä»»ä½•å±•ç¤ºï¼Œä»…æä¾›è·¯ç”±æ¨¡å¼é…ç½®ï¼Œå¦å¤–ï¼Œè¯¥ç»„ä»¶ä¼šäº§ç”Ÿä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œä¸Šä¸‹æ–‡ä¸­ä¼šæä¾›ä¸€äº›å®ç”¨çš„å¯¹è±¡å’Œæ–¹æ³•ï¼Œä¾›å…¶ä»–ç›¸å…³ç»„ä»¶ä½¿ç”¨</p>
<ol>
<li><p>HashRouterï¼šè¯¥ç»„ä»¶ï¼Œä½¿ç”¨hashæ¨¡å¼åŒ¹é…</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">HashRouter</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">HashRouter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>React Router<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">HashRouter</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>BrowserRouterï¼šè¯¥ç»„ä»¶ï¼Œä½¿ç”¨BrowserHistoryæ¨¡å¼åŒ¹é…</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span> <span class="keyword">as</span> <span class="title class_">Router</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>React Router<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼ŒRouterç»„ä»¶åªæœ‰ä¸€ä¸ªï¼Œå°†è¯¥ç»„ä»¶åŒ…è£¹æ•´ä¸ªé¡µé¢</p>
<h3 id="Routeç»„ä»¶"><a href="#Routeç»„ä»¶" class="headerlink" title="Routeç»„ä»¶"></a>Routeç»„ä»¶</h3><p>æ ¹æ®ä¸åŒçš„åœ°å€ï¼Œå±•ç¤ºä¸åŒçš„ç»„ä»¶</p>
<p>é‡è¦å±æ€§ï¼ˆReact Router v5.0.1ï¼Œv6æœ‰æ‰€æ”¹å˜ï¼‰ï¼š</p>
<ol>
<li>pathï¼ˆv5.0.1ï¼‰ï¼šåŒ¹é…çš„è·¯å¾„<ol>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œå¯ä»¥è®¾ç½®sensitiveå±æ€§ä¸ºtrueï¼Œæ¥åŒºåˆ†å¤§å°å†™</li>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒåªåŒ¹é…åˆå§‹ç›®å½•ï¼Œå¦‚æœè¦ç²¾ç¡®åŒ¹é…ï¼Œé…ç½®exactå±æ€§ä¸ºtrue</li>
<li>å¦‚æœä¸å†™pathï¼Œåˆ™ä¼šåŒ¹é…ä»»æ„è·¯å¾„</li>
</ol>
</li>
<li>componentï¼ˆv5.0.1ï¼Œv6ä¸ºComponentï¼‰ï¼šåŒ¹é…æˆåŠŸåè¦æ˜¾ç¤ºçš„ç»„ä»¶</li>
<li>childrenï¼š<ol>
<li>ä¼ é€’Reactå…ƒç´ ï¼Œæ— è®ºæ˜¯å¦åŒ¹é…ï¼Œä¸€å®šä¼šæ˜¾ç¤ºchildrenï¼Œå¹¶ä¸”ä¼šå¿½ç•¥componentå±æ€§</li>
<li>ä¼ é€’ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æœ‰å¤šä¸ªå‚æ•°ï¼Œè¿™äº›å‚æ•°æ¥è‡ªäºä¸Šä¸‹æ–‡ï¼Œè¯¥å‡½æ•°è¿”å›reactå…ƒç´ ï¼Œåˆ™ä¸€å®šä¼šæ˜¾ç¤ºè¿”å›çš„å…ƒç´ ï¼Œå¹¶ä¸”å¿½ç•¥componentå±æ€§</li>
</ol>
</li>
</ol>
<p>ï¼ˆv5.0.1ï¼‰Routeç»„ä»¶å¯ä»¥å†™åˆ°ä»»æ„çš„åœ°æ–¹ï¼Œåªè¦ä¿è¯å®ƒæ˜¯Routerç»„ä»¶çš„åä»£å…ƒç´ </p>
<p>ï¼ˆv6ï¼‰Routeç»„ä»¶éœ€è¦è¢«RoutesåŒ…è£¹</p>
<p>ï¼ˆv6ï¼‰ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span> <span class="keyword">as</span> <span class="title class_">Router</span>, <span class="title class_">Routes</span>, <span class="title class_">Route</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¿é—® /a æ˜¾ç¤ºè¿™ä¸ªç»„ä»¶</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç»„ä»¶A<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¿é—® /a/b æ˜¾ç¤ºè¿™ä¸ªç»„ä»¶</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">B</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç»„ä»¶B<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¿é—® /a/c æ˜¾ç¤ºè¿™ä¸ªç»„ä»¶</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">C</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç»„ä»¶C<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&#x27;/a&#x27;</span> <span class="attr">Component</span>=<span class="string">&#123;A&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&#x27;/a/b&#x27;</span> <span class="attr">Component</span>=<span class="string">&#123;B&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&#x27;/a/c&#x27;</span> <span class="attr">Component</span>=<span class="string">&#123;C&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Switchç»„ä»¶ï¼ˆReact-Router-v5-0-1ï¼Œv6å·²å»é™¤ï¼‰"><a href="#Switchç»„ä»¶ï¼ˆReact-Router-v5-0-1ï¼Œv6å·²å»é™¤ï¼‰" class="headerlink" title="Switchç»„ä»¶ï¼ˆReact Router v5.0.1ï¼Œv6å·²å»é™¤ï¼‰"></a>Switchç»„ä»¶ï¼ˆReact Router v5.0.1ï¼Œv6å·²å»é™¤ï¼‰</h3><p>å†™åˆ°Switchç»„ä»¶ä¸­çš„Routeç»„ä»¶ï¼Œå½“åŒ¹é…åˆ°ç¬¬ä¸€ä¸ªRouteåï¼Œä¼šç«‹å³åœæ­¢åŒ¹é…</p>
<p>ç”±äºSwitchç»„ä»¶ä¼šå¾ªç¯æ‰€æœ‰å­å…ƒç´ ï¼Œç„¶åè®©æ¯ä¸ªå­å…ƒç´ å»å®ŒæˆåŒ¹é…ï¼Œè‹¥åŒ¹é…åˆ°ï¼Œåˆ™æ¸²æŸ“å¯¹åº”çš„ç»„ä»¶ï¼Œç„¶ååœæ­¢å¾ªç¯ã€‚å› æ­¤ï¼Œä¸èƒ½åœ¨Switchçš„å­å…ƒç´ ä¸­ä½¿ç”¨é™¤Routeå¤–çš„å…¶ä»–ç»„ä»¶ã€‚</p>
<h2 id="è·¯ç”±ä¿¡æ¯"><a href="#è·¯ç”±ä¿¡æ¯" class="headerlink" title="è·¯ç”±ä¿¡æ¯"></a>è·¯ç”±ä¿¡æ¯</h2><p>Routerç»„ä»¶ä¼šåˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”ï¼Œå‘ä¸Šä¸‹æ–‡ä¸­æ³¨å…¥ä¸€äº›ä¿¡æ¯</p>
<p>è¯¥ä¸Šä¸‹æ–‡å¯¹å¼€å‘è€…æ˜¯éšè—çš„ï¼ŒRouteç»„ä»¶è‹¥åŒ¹é…åˆ°äº†åœ°å€ï¼Œåˆ™ä¼šå°†è¿™äº›ä¸Šä¸‹æ–‡ä¸­çš„ä¿¡æ¯ä½œä¸ºå±æ€§ä¼ å…¥å¯¹åº”çš„ç»„ä»¶</p>
<h3 id="history"><a href="#history" class="headerlink" title="history"></a>history</h3><p>å®ƒå¹¶ä¸æ˜¯window.historyå¯¹è±¡ï¼Œæˆ‘ä»¬åˆ©ç”¨è¯¥å¯¹è±¡æ— åˆ·æ–°è·³è½¬åœ°å€</p>
<p><strong>ä¸ºä»€ä¹ˆæ²¡æœ‰ç›´æ¥ä½¿ç”¨historyå¯¹è±¡</strong></p>
<ol>
<li>React-Routerä¸­æœ‰ä¸¤ç§æ¨¡å¼ï¼šHashã€Historyï¼Œå¦‚æœç›´æ¥ä½¿ç”¨window.historyï¼Œåªèƒ½æ”¯æŒä¸€ç§æ¨¡å¼</li>
<li>å½“ä½¿ç”¨windows.history.pushStateæ–¹æ³•æ—¶ï¼Œæ²¡æœ‰åŠæ³•æ”¶åˆ°ä»»ä½•é€šçŸ¥ï¼Œå°†å¯¼è‡´Reactæ— æ³•çŸ¥æ™“åœ°å€å‘ç”Ÿäº†å˜åŒ–ï¼Œç»“æœå¯¼è‡´æ— æ³•é‡æ–°æ¸²æŸ“ç»„ä»¶</li>
</ol>
<ul>
<li>pushï¼šå°†æŸä¸ªæ–°çš„åœ°å€å…¥æ ˆï¼ˆå†å²è®°å½•æ ˆï¼‰<ul>
<li>å‚æ•°1ï¼šæ–°çš„åœ°å€</li>
<li>å‚æ•°2ï¼šå¯é€‰ï¼Œé™„å¸¦çš„çŠ¶æ€æ•°æ®</li>
</ul>
</li>
<li>replaceï¼šå°†æŸä¸ªæ–°çš„åœ°å€æ›¿æ¢æ‰å½“å‰æ ˆä¸­çš„åœ°å€</li>
<li>go: ä¸window.historyä¸€è‡´</li>
<li>forward: ä¸window.historyä¸€è‡´</li>
<li>back: ä¸window.historyä¸€è‡´</li>
</ul>
<h3 id="location"><a href="#location" class="headerlink" title="location"></a>location</h3><p>ä¸history.locationå®Œå…¨ä¸€è‡´ï¼Œæ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ï¼Œä¸window.locationä¸åŒ</p>
<p>locationå¯¹è±¡ä¸­è®°å½•äº†å½“å‰åœ°å€çš„ç›¸å…³ä¿¡æ¯</p>
<p>æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“<code>query-string</code>ï¼Œç”¨äºè§£æåœ°å€æ ä¸­çš„æ•°æ®</p>
<h3 id="match"><a href="#match" class="headerlink" title="match"></a>match</h3><p>è¯¥å¯¹è±¡ä¸­ä¿å­˜äº†ï¼Œè·¯ç”±åŒ¹é…çš„ç›¸å…³ä¿¡æ¯</p>
<ul>
<li>isExactï¼šäº‹å®ä¸Šï¼Œå½“å‰çš„è·¯å¾„å’Œè·¯ç”±é…ç½®çš„è·¯å¾„æ˜¯å¦æ˜¯ç²¾ç¡®åŒ¹é…çš„</li>
<li>paramsï¼šè·å–è·¯å¾„è§„åˆ™ä¸­å¯¹åº”çš„æ•°æ®</li>
</ul>
<p>å®é™…ä¸Šï¼Œåœ¨ä¹¦å†™Routeç»„ä»¶çš„pathå±æ€§æ—¶ï¼Œå¯ä»¥ä¹¦å†™ä¸€ä¸ª<code>string pattern</code>ï¼ˆå­—ç¬¦ä¸²æ­£åˆ™ï¼‰</p>
<p>react-routerä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼šPath-to-RegExpï¼Œè¯¥åº“çš„ä½œç”¨æ˜¯ï¼Œå°†ä¸€ä¸ªå­—ç¬¦ä¸²æ­£åˆ™è½¬æ¢æˆä¸€ä¸ªçœŸæ­£çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚</p>
<p><strong>å‘æŸä¸ªé¡µé¢ä¼ é€’æ•°æ®çš„æ–¹å¼ï¼š</strong></p>
<ol>
<li>ä½¿ç”¨stateï¼šåœ¨pushé¡µé¢æ—¶ï¼ŒåŠ å…¥state</li>
<li><strong>åˆ©ç”¨searchï¼šæŠŠæ•°æ®å¡«å†™åˆ°åœ°å€æ ä¸­çš„ï¼Ÿå</strong></li>
<li>åˆ©ç”¨hashï¼šæŠŠæ•°æ®å¡«å†™åˆ°hashå</li>
<li><strong>paramsï¼šæŠŠæ•°æ®å¡«å†™åˆ°è·¯å¾„ä¸­</strong></li>
</ol>
<h3 id="éè·¯ç”±ç»„ä»¶è·å–è·¯ç”±ä¿¡æ¯"><a href="#éè·¯ç”±ç»„ä»¶è·å–è·¯ç”±ä¿¡æ¯" class="headerlink" title="éè·¯ç”±ç»„ä»¶è·å–è·¯ç”±ä¿¡æ¯"></a>éè·¯ç”±ç»„ä»¶è·å–è·¯ç”±ä¿¡æ¯</h3><p>æŸäº›ç»„ä»¶ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æ”¾åˆ°Routeä¸­ï¼Œè€Œæ˜¯åµŒå¥—åœ¨å…¶ä»–æ™®é€šç»„ä»¶ä¸­ï¼Œå› æ­¤ï¼Œå®ƒçš„propsä¸­æ²¡æœ‰è·¯ç”±ä¿¡æ¯ï¼Œå¦‚æœè¿™äº›ç»„ä»¶éœ€è¦è·å–åˆ°è·¯ç”±ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢ä¸¤ç§æ–¹å¼ï¼š</p>
<ol>
<li>å°†è·¯ç”±ä¿¡æ¯ä»çˆ¶ç»„ä»¶ä¸€å±‚ä¸€å±‚ä¼ é€’åˆ°å­ç»„ä»¶</li>
<li>ä½¿ç”¨react-routeræä¾›çš„é«˜é˜¶ç»„ä»¶withRouterï¼ŒåŒ…è£…è¦ä½¿ç”¨çš„ç»„ä»¶ï¼Œè¯¥é«˜é˜¶ç»„ä»¶ä¼šè¿”å›ä¸€ä¸ªæ–°ç»„ä»¶ï¼Œæ–°ç»„ä»¶å°†å‘æä¾›çš„ç»„ä»¶æ³¨å…¥è·¯ç”±ä¿¡æ¯ã€‚</li>
</ol>
<h2 id="Reduxæ ¸å¿ƒæ¦‚å¿µ"><a href="#Reduxæ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="Reduxæ ¸å¿ƒæ¦‚å¿µ"></a>Reduxæ ¸å¿ƒæ¦‚å¿µ</h2><p>action  reducer  store</p>
<h3 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h3><p>å®ƒæ˜¯ä¸€ä¸ªUIçš„è§£å†³æ–¹æ¡ˆï¼Œç”¨äºé™ä½UIï¼Œä»¥åŠUIå…³è”çš„æ•°æ®çš„å¤æ‚åº¦ã€‚</p>
<p><strong>ä¼ ç»Ÿçš„æœåŠ¡å™¨ç«¯çš„MVC</strong></p>
<p><img src="/2023/04/07/React%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2019-08-20-13-18-58.png"></p>
<p>ç¯å¢ƒï¼š</p>
<ol>
<li>æœåŠ¡ç«¯éœ€è¦å“åº”ä¸€ä¸ªå®Œæ•´çš„HTML</li>
<li>è¯¥HTMLä¸­åŒ…å«é¡µé¢éœ€è¦çš„æ•°æ®</li>
<li>æµè§ˆå™¨ä»…æ‰¿æ‹…æ¸²æŸ“é¡µé¢çš„ä½œç”¨</li>
</ol>
<p>ä»¥ä¸Šçš„è¿™ç§æ–¹å¼å«åš<strong>æœåŠ¡ç«¯æ¸²æŸ“</strong>ï¼Œå³æœåŠ¡å™¨ç«¯å°†å®Œæ•´çš„é¡µé¢ç»„è£…å¥½ä¹‹åï¼Œä¸€èµ·å‘é€ç»™å®¢æˆ·ç«¯ã€‚</p>
<p>æœåŠ¡å™¨ç«¯éœ€è¦å¤„ç†UIä¸­è¦ç”¨åˆ°çš„æ•°æ®ï¼Œå¹¶ä¸”è¦å°†æ•°æ®åµŒå…¥åˆ°é¡µé¢ä¸­ï¼Œæœ€ç»ˆç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„HTMLé¡µé¢å“åº”ã€‚</p>
<p>ä¸ºäº†é™ä½å¤„ç†è¿™ä¸ªè¿‡ç¨‹çš„å¤æ‚åº¦ï¼Œå‡ºç°äº†MVCæ¨¡å¼ã€‚</p>
<p><img src="/2023/04/07/React%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2019-08-20-13-29-14.png"></p>
<p><strong>Controller</strong>: å¤„ç†è¯·æ±‚ï¼Œç»„è£…è¿™æ¬¡è¯·æ±‚éœ€è¦çš„æ•°æ®<br><strong>Model</strong>ï¼šéœ€è¦ç”¨äºUIæ¸²æŸ“çš„æ•°æ®æ¨¡å‹<br><strong>View</strong>ï¼šè§†å›¾ï¼Œç”¨äºå°†æ¨¡å‹ç»„è£…åˆ°ç•Œé¢ä¸­</p>
<p><strong>å‰ç«¯MVCæ¨¡å¼çš„å›°éš¾</strong></p>
<p>Reactè§£å†³äº†   æ•°æ® -&gt; è§†å›¾   çš„é—®é¢˜</p>
<ol>
<li>å‰ç«¯çš„controllerè¦æ¯”æœåŠ¡å™¨å¤æ‚å¾ˆå¤šï¼Œå› ä¸ºå‰ç«¯ä¸­çš„controllerå¤„ç†çš„æ˜¯ç”¨æˆ·çš„æ“ä½œï¼Œè€Œç”¨æˆ·çš„æ“ä½œåœºæ™¯æ˜¯å¤æ‚çš„ã€‚</li>
<li>å¯¹äºé‚£äº›ç»„ä»¶åŒ–çš„æ¡†æ¶ï¼ˆæ¯”å¦‚vueã€reactï¼‰ï¼Œå®ƒä»¬ä½¿ç”¨çš„æ˜¯å•å‘æ•°æ®æµã€‚è‹¥éœ€è¦å…±äº«æ•°æ®ï¼Œåˆ™å¿…é¡»å°†æ•°æ®æå‡åˆ°é¡¶å±‚ç»„ä»¶ï¼Œç„¶åæ•°æ®å†ä¸€å±‚ä¸€å±‚ä¼ é€’ï¼Œæå…¶ç¹çã€‚ è™½ç„¶å¯ä»¥ä½¿ç”¨ä¸Šä¸‹æ–‡æ¥æä¾›å…±äº«æ•°æ®ï¼Œä½†å¯¹æ•°æ®çš„æ“ä½œéš¾ä»¥ç›‘æ§ï¼Œå®¹æ˜“å¯¼è‡´è°ƒè¯•é”™è¯¯çš„å›°éš¾ï¼Œä»¥åŠæ•°æ®è¿˜åŸçš„å›°éš¾ã€‚å¹¶ä¸”ï¼Œè‹¥å¼€å‘ä¸€ä¸ªå¤§ä¸­å‹é¡¹ç›®ï¼Œå…±äº«çš„æ•°æ®å¾ˆå¤šï¼Œä¼šå¯¼è‡´ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®å˜å¾—éå¸¸å¤æ‚ã€‚</li>
</ol>
<p>æ¯”å¦‚ï¼Œä¸Šä¸‹æ–‡ä¸­æœ‰å¦‚ä¸‹æ ¼å¼çš„æ•°æ®ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">value = &#123;</span><br><span class="line">    <span class="attr">users</span>:[&#123;&#125;,&#123;&#125;,&#123;&#125;],</span><br><span class="line">    <span class="attr">addUser</span>: <span class="keyword">function</span>(<span class="params">u</span>)&#123;&#125;,</span><br><span class="line">    <span class="attr">deleteUser</span>: <span class="keyword">function</span>(<span class="params">u</span>)&#123;&#125;,</span><br><span class="line">    <span class="attr">updateUser</span>: <span class="keyword">function</span>(<span class="params">u</span>)&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="å‰ç«¯éœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„æ•°æ®è§£å†³æ–¹æ¡ˆ"><a href="#å‰ç«¯éœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„æ•°æ®è§£å†³æ–¹æ¡ˆ" class="headerlink" title="å‰ç«¯éœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„æ•°æ®è§£å†³æ–¹æ¡ˆ"></a>å‰ç«¯éœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„æ•°æ®è§£å†³æ–¹æ¡ˆ</h3><p><strong>Flux</strong></p>
<p>Facebookæå‡ºçš„æ•°æ®è§£å†³æ–¹æ¡ˆï¼Œå®ƒçš„æœ€å¤§å†å²æ„ä¹‰ï¼Œåœ¨äºå®ƒå¼•å…¥äº†actionçš„æ¦‚å¿µ</p>
<p>actionæ˜¯ä¸€ä¸ªæ™®é€šçš„å¯¹è±¡ï¼Œç”¨äºæè¿°è¦å¹²ä»€ä¹ˆã€‚<strong>actionæ˜¯è§¦å‘æ•°æ®å˜åŒ–çš„å”¯ä¸€åŸå› </strong></p>
<p>storeè¡¨ç¤ºæ•°æ®ä»“åº“ï¼Œç”¨äºå­˜å‚¨å…±äº«æ•°æ®ã€‚è¿˜å¯ä»¥æ ¹æ®ä¸åŒçš„actionæ›´æ”¹ä»“åº“ä¸­çš„æ•°æ®</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> loginAction = &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;login&quot;</span>,</span><br><span class="line">    <span class="attr">payload</span>: &#123;</span><br><span class="line">        <span class="attr">loginId</span>:<span class="string">&quot;admin&quot;</span>,</span><br><span class="line">        <span class="attr">loginPwd</span>:<span class="string">&quot;123123&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> deleteAction = &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;delete&quot;</span>,</span><br><span class="line">    <span class="attr">payload</span>: <span class="number">1</span>  <span class="comment">// ç”¨æˆ·idä¸º1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Redux</strong></p>
<p>åœ¨FluxåŸºç¡€ä¸Šï¼Œå¼•å…¥äº†reducerçš„æ¦‚å¿µ</p>
<p>reducerï¼šå¤„ç†å™¨ï¼Œç”¨äºæ ¹æ®actionæ¥å¤„ç†æ•°æ®ï¼Œå¤„ç†åçš„æ•°æ®ä¼šè¢«ä»“åº“é‡æ–°ä¿å­˜ã€‚</p>
<p><img src="/2023/04/07/React%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2019-08-20-14-23-05.png"></p>
<h2 id="åœ¨Reacté¡¹ç›®ä¸­ç®€å•ä½¿ç”¨Reduxç®¡ç†æ•°æ®"><a href="#åœ¨Reacté¡¹ç›®ä¸­ç®€å•ä½¿ç”¨Reduxç®¡ç†æ•°æ®" class="headerlink" title="åœ¨Reacté¡¹ç›®ä¸­ç®€å•ä½¿ç”¨Reduxç®¡ç†æ•°æ®"></a>åœ¨Reacté¡¹ç›®ä¸­ç®€å•ä½¿ç”¨Reduxç®¡ç†æ•°æ®</h2><p>å®‰è£…Redux</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add redux</span><br></pre></td></tr></table></figure>

<h3 id="Reduxå†™æ³•"><a href="#Reduxå†™æ³•" class="headerlink" title="Reduxå†™æ³•"></a>Reduxå†™æ³•</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡è®¾ä»“åº“ä¸­ä»…å­˜æ”¾äº†ä¸€ä¸ªæ•°å­—ï¼Œè¯¥æ•°å­—å˜åŒ–å¯èƒ½æ˜¯åŠ ä¸€æˆ–å‡ä¸€</span></span><br><span class="line"><span class="comment">// çº¦å®šactionçš„æ ¼å¼ï¼š&#123;type:&quot;æ“ä½œç±»å‹&quot;, payload:é™„åŠ æ•°æ®&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * reduceræœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> state ä¹‹å‰ä»“åº“ä¸­çš„çŠ¶æ€ï¼ˆæ•°æ®ï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> action æè¿°è¦åšä»€ä¹ˆçš„å¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">  <span class="comment">// è¿”å›ä¸€ä¸ªæ–°çš„çŠ¶æ€</span></span><br><span class="line">  <span class="keyword">if</span> (action.<span class="property">type</span> === <span class="string">&#x27;increase&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> state + <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (action.<span class="property">type</span> === <span class="string">&#x27;decrease&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> state - <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> state; <span class="comment">// å¦‚æœæ˜¯ä¸€ä¸ªæ— æ•ˆçš„æ“ä½œç±»å‹ï¼Œæ•°æ®ä¸å˜</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> action = &#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;increase&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">dispatch</span>(action);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æœ€æ–°ç‰ˆæœ¬æ¨èä½¿ç”¨Redux Toolkit</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add @reduxjs/toolkit</span><br></pre></td></tr></table></figure>

<h3 id="Redux-Toolkitå†™æ³•"><a href="#Redux-Toolkitå†™æ³•" class="headerlink" title="Redux Toolkitå†™æ³•"></a>Redux Toolkitå†™æ³•</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSlice, configureStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> numHandleSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;numHandle&#x27;</span>,</span><br><span class="line">  <span class="attr">initialState</span>: &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="number">10</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="attr">increase</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">value</span> += <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">decrease</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">value</span> -= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; increase, decrease &#125; = numHandleSlice.<span class="property">actions</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: numHandleSlice.<span class="property">reducer</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(store.<span class="title function_">getState</span>()));</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">dispatch</span>(<span class="title function_">increase</span>());</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">dispatch</span>(<span class="title function_">decrease</span>());</span><br><span class="line"></span><br><span class="line">store.<span class="title function_">dispatch</span>(<span class="title function_">decrease</span>());</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Redux-Action"><a href="#Redux-Action" class="headerlink" title="Redux Action"></a>Redux Action</h2><blockquote>
<p>Actionæ˜¯ç”¨æ¥æè¿° â€œè¦åšä»€ä¹ˆäº‹æƒ…â€ çš„ä½œç”¨</p>
</blockquote>
<ol>
<li>actionæ˜¯ä¸€ä¸ªplain-objectï¼ˆå¹³é¢å¯¹è±¡ï¼‰<ol>
<li>å®ƒçš„__proto__æŒ‡å‘Object.prototype</li>
</ol>
</li>
<li>é€šå¸¸ï¼Œä½¿ç”¨payloadå±æ€§è¡¨ç¤ºé™„åŠ æ•°æ®ï¼ˆæ²¡æœ‰å¼ºåˆ¶è¦æ±‚ï¼‰</li>
<li>actionä¸­å¿…é¡»æœ‰typeå±æ€§ï¼Œè¯¥å±æ€§ç”¨äºæè¿°æ“ä½œçš„ç±»å‹<ol>
<li>ä½†æ˜¯ï¼Œæ²¡æœ‰å¯¹typeçš„ç±»å‹åšå‡ºè¦æ±‚</li>
</ol>
</li>
<li>åœ¨å¤§å‹é¡¹ç›®ï¼Œç”±äºæ“ä½œç±»å‹éå¸¸å¤šï¼Œä¸ºäº†é¿å…ç¡¬ç¼–ç ï¼ˆhard codeï¼‰ï¼Œä¼šå°†actionçš„ç±»å‹å­˜æ”¾åˆ°ä¸€ä¸ªæˆ–ä¸€äº›å•ç‹¬çš„æ–‡ä»¶ä¸­(æ ·æ¿ä»£ç )ã€‚</li>
<li>ä¸ºäº†æ–¹é¢ä¼ é€’actionï¼Œé€šå¸¸ä¼šä½¿ç”¨actionåˆ›å»ºå‡½æ•°(action creator)æ¥åˆ›å»ºaction<ol>
<li>actionåˆ›å»ºå‡½æ•°åº”ä¸ºæ— å‰¯ä½œç”¨çš„çº¯å‡½æ•°<ol>
<li>ä¸èƒ½ä»¥ä»»ä½•å½¢å¼æ”¹åŠ¨å‚æ•°</li>
<li>ä¸å¯ä»¥æœ‰å¼‚æ­¥</li>
<li>ä¸å¯ä»¥å¯¹å¤–éƒ¨ç¯å¢ƒä¸­çš„æ•°æ®é€ æˆå½±å“</li>
</ol>
</li>
</ol>
</li>
<li>ä¸ºäº†æ–¹ä¾¿åˆ©ç”¨actionåˆ›å»ºå‡½æ•°æ¥åˆ†å‘ï¼ˆè§¦å‘ï¼‰actionï¼Œreduxæä¾›äº†ä¸€ä¸ªå‡½æ•°<code>bindActionCreators</code>ï¼Œè¯¥å‡½æ•°ç”¨äºå¢å¼ºactionåˆ›å»ºå‡½æ•°çš„åŠŸèƒ½ï¼Œä½¿å®ƒä¸ä»…å¯ä»¥åˆ›å»ºactionï¼Œå¹¶ä¸”åˆ›å»ºåä¼šè‡ªåŠ¨å®Œæˆåˆ†å‘ã€‚</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; bindActionCreators &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ˜¯actionåˆ›å»ºå‡½æ•°åˆå¹¶çš„å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä»“åº“çš„dispatchå‡½æ•°</span></span><br><span class="line"><span class="comment"> * å¾—åˆ°ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œæ–°å¯¹è±¡ä¸­çš„å±æ€§åå’Œç¬¬ä¸€ä¸ªå‚æ•°çš„å±æ€§åä¸€è‡´</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> boundActions = <span class="title function_">bindActionCreators</span>(numberActions, store.<span class="property">dispatch</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨bindActionså¯ä»¥ç›´æ¥å¾—åˆ°actionå¹¶ä¸”ç›´æ¥å®Œæˆåˆ†å‘</span></span><br><span class="line">boundActions.<span class="title function_">getSetAction</span>(<span class="number">22</span>); <span class="comment">// ç›¸å½“äºstore.dispatch(numberActions.getSetAction(22));</span></span><br><span class="line">boundActions.<span class="title function_">getIncreaseAction</span>(); <span class="comment">// ç›¸å½“äºstore.dispatch(numberActions.getIncreaseAction());</span></span><br><span class="line">boundActions.<span class="title function_">getDecreaseAction</span>(); <span class="comment">// ç›¸å½“äºstore.dispatch(numberActions.getDecreaseAction());</span></span><br></pre></td></tr></table></figure>

<p><strong>è¯¦ç»†ä»£ç è§åˆ†æ”¯â€œactionçš„ä½¿ç”¨â€</strong></p>
<h2 id="Redux-Reducer"><a href="#Redux-Reducer" class="headerlink" title="Redux Reducer"></a>Redux Reducer</h2><blockquote>
<p>Reduceræ˜¯ç”¨äºæ”¹å˜æ•°æ®çš„å‡½æ•°</p>
</blockquote>
<ol>
<li><p>ä¸€ä¸ªæ•°æ®ä»“åº“ï¼Œæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªreducerï¼Œå¹¶ä¸”é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå·¥ç¨‹åªæœ‰ä¸€ä¸ªä»“åº“ï¼Œå› æ­¤ï¼Œä¸€ä¸ªç³»ç»Ÿï¼Œåªæœ‰ä¸€ä¸ªreducer</p>
</li>
<li><p>ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œé€šå¸¸ä¼šå°†reduceræ”¾åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚</p>
</li>
<li><p>reducerè¢«è°ƒç”¨çš„æ—¶æœº</p>
<ol>
<li>é€šè¿‡store.dispatchï¼Œåˆ†å‘äº†ä¸€ä¸ªactionï¼Œæ­¤æ—¶ï¼Œä¼šè°ƒç”¨reducer<ol>
<li>å½“åˆ›å»ºä¸€ä¸ªstoreçš„æ—¶å€™ï¼ˆconst store &#x3D; createStore(reducer, 10)çš„æ—¶å€™ï¼‰ï¼Œä¼šè°ƒç”¨ä¸€æ¬¡reducer</li>
<li>å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œç”¨reduceråˆå§‹åŒ–çŠ¶æ€</li>
<li>åˆ›å»ºä»“åº“æ—¶ï¼Œä¸ä¼ é€’ä»»ä½•é»˜è®¤çŠ¶æ€ï¼ˆconst store &#x3D; createStore(reducer)ï¼‰</li>
<li>å°†reducerçš„å‚æ•°stateè®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ï¼ˆfunction reducer(state &#x3D; 10, action) { â€¦ }ï¼‰</li>
</ol>
</li>
</ol>
</li>
<li><p>reducerå†…éƒ¨é€šå¸¸ä½¿ç”¨switchæ¥åˆ¤æ–­typeå€¼</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">state = <span class="number">10</span>, action</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;reducerè¿è¡Œäº†&#x27;</span>, state, action);</span><br><span class="line">  <span class="comment">// è¿”å›ä¸€ä¸ªæ–°çš„çŠ¶æ€</span></span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> actionTypes.<span class="property">INCREASE</span>:</span><br><span class="line">      <span class="keyword">return</span> state + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">case</span> actionTypes.<span class="property">DECREASE</span>:</span><br><span class="line">      <span class="keyword">return</span> state - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">case</span> actionTypes.<span class="property">SET</span>:</span><br><span class="line">      <span class="keyword">return</span> action.<span class="property">payload</span>;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state; <span class="comment">// å¦‚æœæ˜¯ä¸€ä¸ªæ— æ•ˆçš„æ“ä½œç±»å‹ï¼Œæ•°æ®ä¸å˜</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>reducerå¿…é¡»æ˜¯ä¸€ä¸ªæ²¡æœ‰å‰¯ä½œç”¨çš„çº¯å‡½æ•°</strong></p>
<ol>
<li>ä¸ºä»€ä¹ˆéœ€è¦çº¯å‡½æ•°<ol>
<li>çº¯å‡½æ•°æœ‰åˆ©äºæµ‹è¯•å’Œè°ƒå¼</li>
<li>æœ‰åˆ©äºè¿˜åŸæ•°æ®</li>
<li>æœ‰åˆ©äºå°†æ¥å’Œreactç»“åˆæ—¶çš„ä¼˜åŒ–</li>
</ol>
</li>
<li>å…·ä½“è¦æ±‚<ol>
<li>ä¸èƒ½æ”¹å˜å‚æ•°ï¼Œå› æ­¤è‹¥è¦è®©çŠ¶æ€å˜åŒ–ï¼Œå¿…é¡»å¾—åˆ°ä¸€ä¸ªæ–°çš„çŠ¶æ€</li>
<li>ä¸èƒ½æœ‰å¼‚æ­¥</li>
<li>ä¸èƒ½å¯¹å¤–éƒ¨ç¯å¢ƒé€ æˆå½±å“</li>
</ol>
</li>
</ol>
</li>
<li><p>ç”±äºåœ¨å¤§ä¸­å‹é¡¹ç›®ä¸­ï¼Œæ“ä½œæ¯”è¾ƒå¤æ‚ï¼Œæ•°æ®ç»“æ„ä¹Ÿæ¯”è¾ƒå¤æ‚ï¼Œå› æ­¤ï¼Œéœ€è¦å¯¹reducerè¿›è¡Œç»†åˆ†ã€‚</p>
<ol>
<li>reduxæä¾›äº†æ–¹æ³•ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´åŠ æ–¹ä¾¿çš„åˆå¹¶reducer</li>
<li><code>combineReducers</code>: åˆå¹¶reducerï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„reducerï¼Œè¯¥æ–°çš„reducerç®¡ç†ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªå±æ€§äº¤ç»™å¯¹åº”çš„reducerç®¡ç†ã€‚</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> loginUserReducer <span class="keyword">from</span> <span class="string">&#x27;./loginUser&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> usersReducer <span class="keyword">from</span> <span class="string">&#x27;./users&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">combineReducers</span>(&#123;</span><br><span class="line">  <span class="attr">loginUser</span>: loginUserReducer,</span><br><span class="line">  <span class="attr">users</span>: usersReducer</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>è¯¦ç»†ä»£ç è§åˆ†æ”¯â€Reducerâ€</strong></p>
<h2 id="Redux-Store"><a href="#Redux-Store" class="headerlink" title="Redux Store"></a>Redux Store</h2><p>Storeï¼šç”¨äºä¿å­˜æ•°æ®</p>
<p>é€šè¿‡createStoreæ–¹æ³•åˆ›å»ºçš„å¯¹è±¡ã€‚</p>
<p>è¯¥å¯¹è±¡çš„æˆå‘˜ï¼š</p>
<ul>
<li><p>dispatchï¼šåˆ†å‘ä¸€ä¸ªaction</p>
</li>
<li><p>getStateï¼šå¾—åˆ°ä»“åº“ä¸­å½“å‰çš„çŠ¶æ€</p>
</li>
<li><p>replaceReducerï¼šæ›¿æ¢æ‰å½“å‰çš„reducer</p>
</li>
<li><p>subscribeï¼šæ³¨å†Œä¸€ä¸ªç›‘å¬å™¨ï¼Œç›‘å¬å™¨æ˜¯ä¸€ä¸ªæ— å‚å‡½æ•°ï¼Œè¯¥åˆ†å‘ä¸€ä¸ªactionä¹‹åï¼ˆstore.dispatch()åï¼‰ï¼Œä¼šè¿è¡Œæ³¨å†Œçš„ç›‘å¬å™¨ã€‚è¯¥å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå–æ¶ˆç›‘å¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store.subscribe(() =&gt; console.log(store.getState()));</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="æ³¨æ„-1"><a href="#æ³¨æ„-1" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><h3 id="å›¾ç‰‡èµ„æºéœ€è¦å¯¼å…¥ä½¿ç”¨"><a href="#å›¾ç‰‡èµ„æºéœ€è¦å¯¼å…¥ä½¿ç”¨" class="headerlink" title="å›¾ç‰‡èµ„æºéœ€è¦å¯¼å…¥ä½¿ç”¨"></a>å›¾ç‰‡èµ„æºéœ€è¦å¯¼å…¥ä½¿ç”¨</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> src1 <span class="keyword">from</span> <span class="string">&quot;./assets/1.jpg&quot;</span>;</span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;src1&#125;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span>, container);</span><br></pre></td></tr></table></figure>




      </section>

      
      
        <nav class="article-nav">
          
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
    <div class="card-text">
      
        <a href="/2023/03/31/vite&vue3/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">Vite &amp; Vue3</h2>
        </a>
      
      <div class="card-text--row">Older</div>
    </div>
  </article>
</div>
          
        </nav>
      

      <section class="page-message-container layout-padding">
        


  
  

  
  


      </section>
    </div>
    <div class="widget-info">
      <section class="widget-author widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-body">
    
      <img src="/avatar.jpeg" class="soft-size--round soft-style--box" alt="airlatus">
    
    
      <h2>airlatus</h2>
    
    
      <p>å¯¹äºå¯æ§çš„äº‹æƒ…ä¿æŒè°¨æ…ï¼›å¯¹äºä¸å¯æ§çš„äº‹æƒ…ä¿æŒä¹è§‚</p>
    

    <div class="count-box">
      <div class="count-box--item">
        <svg class="icon icon-article" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M240.51564747 647.74217627h196.07203239c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806V165.10332731c0-33.18142087-30.16492806-60.32985613-60.32985612-60.32985611H245.04038668C225.43318342 104.7734712 210.35071939 119.85593522 210.35071939 139.46313845V617.57724821c0 16.59071043 13.57421762 30.16492806 30.16492808 30.16492806z m663.62841731-452.47392089v482.63884894c0 33.18142087-27.14843525 60.32985613-60.32985612 60.32985613H180.18579134c-33.18142087 0-60.32985613-27.14843525-60.32985612-60.32985613V195.26825538c-49.77213131 0-90.49478418 40.72265287-90.49478417 90.49478417v452.4739209c0 49.77213131 40.72265287 90.49478418 90.49478417 90.49478417h286.56681657c16.59071043 0 30.16492806 13.57421762 30.16492807 30.16492807s13.57421762 30.16492806 30.16492805 30.16492806h90.49478418c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806s13.57421762-30.16492806 30.16492807-30.16492807h286.56681657c49.77213131 0 90.49478418-40.72265287 90.49478417-90.49478417V285.76303955c0-49.77213131-40.72265287-90.49478418-90.49478417-90.49478417zM587.41232014 647.74217627h191.54729318c19.60720323 0 34.68966726-15.08246403 34.68966729-34.68966727V134.93839925c0-16.59071043-13.57421762-30.16492806-30.16492808-30.16492805H617.57724821c-30.16492806 0-60.32985613 27.14843525-60.32985612 60.32985611v452.4739209c0 16.59071043 13.57421762 30.16492806 30.16492805 30.16492806z" fill="currentColor"></path>
</svg>
        <span>11</span>
      </div>
      <div class="count-box--item">
        <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
        12
      </div>
      <div class="count-box--item">
        <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
        12
      </div>
    </div>
  </div>
</section>

      

      

      <section class="widget-categorys widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
    <span>CATEGORYS</span>
  </div>
  <div class="widget-body">
    <ul class="categorys-list">
      
        <li class="categorys-list-item">
          <a href="/categories/IoT%E5%B0%8F%E7%A8%8B%E5%BA%8F/">
            IoTå°ç¨‹åº (1)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/browser/">
            browser (1)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/javaScript/">
            javaScript (2)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/css/">
            css (1)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/blog/">
            blog (1)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/git/">
            git (1)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/Web/">
            Web (1)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/Vue/">
            Vue (1)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/Vue/Vue3/">
            Vue3 (1)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/Vue/Vue3/Vite/">
            Vite (1)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/React/">
            React (1)
          </a>
        </li>
      
        <li class="categorys-list-item">
          <a href="/categories/React/React-Hooks/">
            React Hooks (1)
          </a>
        </li>
      
    </ul>
  </div>
</section>

      <section class="widget-tags widget-item  layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
    <span>TAGS</span>
  </div>
  <div class="widget-body">
    <div class="tags-cloud">
      <a href="/tags/IoT%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 10px;" class="tags-cloud-0">IoTå°ç¨‹åº</a> <a href="/tags/React/" style="font-size: 10px;" class="tags-cloud-0">React</a> <a href="/tags/React-Hooks/" style="font-size: 10px;" class="tags-cloud-0">React Hooks</a> <a href="/tags/Vite/" style="font-size: 10px;" class="tags-cloud-0">Vite</a> <a href="/tags/Vue/" style="font-size: 10px;" class="tags-cloud-0">Vue</a> <a href="/tags/Vue3/" style="font-size: 10px;" class="tags-cloud-0">Vue3</a> <a href="/tags/Web/" style="font-size: 10px;" class="tags-cloud-0">Web</a> <a href="/tags/blog/" style="font-size: 10px;" class="tags-cloud-0">blog</a> <a href="/tags/browser/" style="font-size: 10px;" class="tags-cloud-0">browser</a> <a href="/tags/css/" style="font-size: 10px;" class="tags-cloud-0">css</a> <a href="/tags/git/" style="font-size: 10px;" class="tags-cloud-0">git</a> <a href="/tags/javaScript/" style="font-size: 20px;" class="tags-cloud-10">javaScript</a>
    </div>
  </div>
</section>
    </div>
  </article>
</div>

    <!-- footer container -->
<footer id="footer" class="footer">
  <div class="footer-container">
    
    <div class="social-icons">
      
        
      
        
      
        
      
        
          <a href="https://github.com/airLatus/" class="soft-size--primary soft-style--box" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-github" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M64.6 512c0 195.6 125.4 361.9 300.1 422.9 23.5 5.9 19.9-10.8 19.9-22.2v-77.6c-135.8 15.9-141.3-74-150.5-89-18.5-31.5-61.9-39.5-49-54.5 31-15.9 62.5 4 98.9 58 26.4 39.1 77.9 32.5 104.1 26 5.7-23.5 17.9-44.5 34.7-60.9-140.7-25.2-199.4-111.1-199.4-213.3 0-49.5 16.4-95.1 48.4-131.8-20.4-60.6 1.9-112.4 4.9-120.1 58.2-5.2 118.5 41.6 123.3 45.3 33.1-8.9 70.8-13.7 112.9-13.7 42.4 0 80.3 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.4-43.9 2.9 7.7 24.7 58.3 5.5 118.1 32.5 36.8 49 82.8 49 132.4 0 102.3-59 188.3-200.2 213.2 23.5 23.3 38.1 55.5 38.1 91.1v112.7c0.8 9 0 17.9 15.1 17.9C832.7 877 960.4 709.4 960.4 512.1c0-247.5-200.6-447.9-447.9-447.9C265 64.1 64.6 264.5 64.6 512z"></path>
</svg>
          </a>
        
      
        
      
    </div>
     
    <p>&copy; 2023 <a href="/" target="_blank">airlatus</a></p>

    

    <p>Powered by <a href="https://hexo.io" target="_blank" rel="noopener noreferrer">Hexo</a> Theme - <a href="https://github.com/miiiku/flex-block" target="_blank" rel="noopener noreferrer author">flex-block</a></p>

    <p>
      <a href="javascript:;" id="theme-light">ğŸŒ æµ…è‰²</a>
      <a href="javascript:;" id="theme-dark">ğŸŒ› æ·±è‰²</a>
      <a href="javascript:;" id="theme-auto">ğŸ¤–ï¸ è‡ªåŠ¨</a>
    </p>
  </div>
</footer>
  </div>

  <div class="back-to-top-fixed soft-size--round soft-style--box">
    <svg class="icon icon-back-to-top" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
      <path d="M725.333333 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8l-213.333333-213.333333c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l213.333333 213.333333c17.066667 17.066667 17.066667 42.666667 0 59.733333C746.666667 422.4 738.133333 426.666667 725.333333 426.666667z"></path>
      <path d="M298.666667 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l213.333333-213.333333c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-213.333333 213.333333C320 422.4 311.466667 426.666667 298.666667 426.666667z"></path>
      <path d="M512 896c-25.6 0-42.666667-17.066667-42.666667-42.666667L469.333333 170.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667l0 682.666667C554.666667 878.933333 537.6 896 512 896z"></path>
    </svg>
  </div>

  
  <!-- aplayer -->


<!-- dplayer -->




  


  


  




<script src="/js/script.js"></script>


  
  <!-- å°¾éƒ¨ç”¨æˆ·è‡ªå®šä¹‰ç›¸å…³å†…å®¹ -->
</body>
</html>
